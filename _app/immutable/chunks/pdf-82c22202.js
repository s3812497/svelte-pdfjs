var $e=Object.defineProperty;var Ye=(ot,f,J)=>f in ot?$e(ot,f,{enumerable:!0,configurable:!0,writable:!0,value:J}):ot[f]=J;var It=(ot,f,J)=>(Ye(ot,typeof f!="symbol"?f+"":f,J),J),ne=(ot,f,J)=>{if(!f.has(ot))throw TypeError("Cannot "+J)};var S=(ot,f,J)=>(ne(ot,f,"read from private field"),J?J.call(ot):f.get(ot)),it=(ot,f,J)=>{if(f.has(ot))throw TypeError("Cannot add the same private member more than once");f instanceof WeakSet?f.add(ot):f.set(ot,J)},_t=(ot,f,J,m)=>(ne(ot,f,"write to private field"),m?m.call(ot,J):f.set(ot,J),J),ie=(ot,f,J,m)=>({set _(x){_t(ot,f,x,J)},get _(){return S(ot,f,m)}}),ht=(ot,f,J)=>(ne(ot,f,"access private method"),J);function getAugmentedNamespace(ot){var f=ot.default;if(typeof f=="function"){var J=function m(){if(this instanceof m){var x=[null];x.push.apply(x,arguments);var X=Function.bind.apply(f,x);return new X}return f.apply(this,arguments)};J.prototype=f.prototype}else J={};return Object.defineProperty(J,"__esModule",{value:!0}),Object.keys(ot).forEach(function(m){var x=Object.getOwnPropertyDescriptor(ot,m);Object.defineProperty(J,m,x.get?x:{enumerable:!0,get:function(){return ot[m]}})}),J}function commonjsRequire(ot){throw new Error('Could not dynamically require "'+ot+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(f,J){module.exports=J()})(globalThis,()=>(()=>{var __webpack_modules__=[,(ot,f)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.VerbosityLevel=f.Util=f.UnknownErrorException=f.UnexpectedResponseException=f.UNSUPPORTED_FEATURES=f.TextRenderingMode=f.StreamType=f.RenderingIntentFlag=f.PermissionFlag=f.PasswordResponses=f.PasswordException=f.PageActionEventType=f.OPS=f.MissingPDFException=f.LINE_FACTOR=f.LINE_DESCENT_FACTOR=f.InvalidPDFException=f.ImageKind=f.IDENTITY_MATRIX=f.FormatError=f.FontType=f.FeatureTest=f.FONT_IDENTITY_MATRIX=f.DocumentActionEventType=f.CMapCompressionType=f.BaseException=f.AnnotationType=f.AnnotationStateModelType=f.AnnotationReviewState=f.AnnotationReplyType=f.AnnotationMode=f.AnnotationMarkedState=f.AnnotationFlag=f.AnnotationFieldFlag=f.AnnotationEditorType=f.AnnotationEditorPrefix=f.AnnotationEditorParamsType=f.AnnotationBorderStyleType=f.AnnotationActionEventType=f.AbortException=void 0,f.arrayByteLength=g,f.arraysToBytes=P,f.assert=I,f.bytesToString=i,f.createPromiseCapability=Ee,f.createValidAbsoluteUrl=a,f.escapeString=q,f.getModificationDate=qt,f.getVerbosityLevel=tt,f.info=nt,f.isArrayBuffer=kt,f.isArrayEqual=Ct,f.isAscii=ut,f.objectFromMap=Z,f.objectSize=U,f.setVerbosityLevel=$,f.shadow=b,f.string32=M,f.stringToBytes=u,f.stringToPDFString=yt,f.stringToUTF16BEString=St,f.stringToUTF8String=Tt,f.unreachable=bt,f.utf8StringToString=Ft,f.warn=ft;const J=[1,0,0,1,0,0];f.IDENTITY_MATRIX=J;const m=[.001,0,0,.001,0,0];f.FONT_IDENTITY_MATRIX=m;const x=1.35;f.LINE_FACTOR=x;const X=.35;f.LINE_DESCENT_FACTOR=X;const z={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};f.RenderingIntentFlag=z;const G={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};f.AnnotationMode=G;const j="pdfjs_internal_editor_";f.AnnotationEditorPrefix=j;const v={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};f.AnnotationEditorType=v;const y={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};f.AnnotationEditorParamsType=y;const F={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};f.PermissionFlag=F;const A={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};f.TextRenderingMode=A;const p={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};f.ImageKind=p;const c={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};f.AnnotationType=c;const h={MARKED:"Marked",REVIEW:"Review"};f.AnnotationStateModelType=h;const n={MARKED:"Marked",UNMARKED:"Unmarked"};f.AnnotationMarkedState=n;const e={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};f.AnnotationReviewState=e;const o={GROUP:"Group",REPLY:"R"};f.AnnotationReplyType=o;const r={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};f.AnnotationFlag=r;const l={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};f.AnnotationFieldFlag=l;const t={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};f.AnnotationBorderStyleType=t;const s={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};f.AnnotationActionEventType=s;const _={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};f.DocumentActionEventType=_;const C={O:"PageOpen",C:"PageClose"};f.PageActionEventType=C;const D={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};f.StreamType=D;const E={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};f.FontType=E;const T={ERRORS:0,WARNINGS:1,INFOS:5};f.VerbosityLevel=T;const Q={NONE:0,BINARY:1};f.CMapCompressionType=Q;const ct={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};f.OPS=ct;const rt={forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};f.UNSUPPORTED_FEATURES=rt;const V={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};f.PasswordResponses=V;let W=T.WARNINGS;function $(R){Number.isInteger(R)&&(W=R)}function tt(){return W}function nt(R){W>=T.INFOS&&console.log(`Info: ${R}`)}function ft(R){W>=T.WARNINGS&&console.log(`Warning: ${R}`)}function bt(R){throw new Error(R)}function I(R,k){R||bt(k)}function d(R){if(!R)return!1;switch(R.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function a(R,k=null,O=null){if(!R)return null;try{if(O&&typeof R=="string"){if(O.addDefaultProtocol&&R.startsWith("www.")){const At=R.match(/\./g);At&&At.length>=2&&(R=`http://${R}`)}if(O.tryConvertEncoding)try{R=Tt(R)}catch{}}const dt=k?new URL(R,k):new URL(R);if(d(dt))return dt}catch{}return null}function b(R,k,O){return Object.defineProperty(R,k,{value:O,enumerable:!0,configurable:!0,writable:!1}),O}const w=function(){function k(O,dt){this.constructor===k&&bt("Cannot initialize BaseException."),this.message=O,this.name=dt}return k.prototype=new Error,k.constructor=k,k}();f.BaseException=w;class L extends w{constructor(k,O){super(k,"PasswordException"),this.code=O}}f.PasswordException=L;class N extends w{constructor(k,O){super(k,"UnknownErrorException"),this.details=O}}f.UnknownErrorException=N;class H extends w{constructor(k){super(k,"InvalidPDFException")}}f.InvalidPDFException=H;class Y extends w{constructor(k){super(k,"MissingPDFException")}}f.MissingPDFException=Y;class at extends w{constructor(k,O){super(k,"UnexpectedResponseException"),this.status=O}}f.UnexpectedResponseException=at;class K extends w{constructor(k){super(k,"FormatError")}}f.FormatError=K;class et extends w{constructor(k){super(k,"AbortException")}}f.AbortException=et;function i(R){(typeof R!="object"||R===null||R.length===void 0)&&bt("Invalid argument for bytesToString");const k=R.length,O=8192;if(k<O)return String.fromCharCode.apply(null,R);const dt=[];for(let At=0;At<k;At+=O){const Et=Math.min(At+O,k),vt=R.subarray(At,Et);dt.push(String.fromCharCode.apply(null,vt))}return dt.join("")}function u(R){typeof R!="string"&&bt("Invalid argument for stringToBytes");const k=R.length,O=new Uint8Array(k);for(let dt=0;dt<k;++dt)O[dt]=R.charCodeAt(dt)&255;return O}function g(R){if(R.length!==void 0)return R.length;if(R.byteLength!==void 0)return R.byteLength;bt("Invalid argument for arrayByteLength")}function P(R){const k=R.length;if(k===1&&R[0]instanceof Uint8Array)return R[0];let O=0;for(let Et=0;Et<k;Et++)O+=g(R[Et]);let dt=0;const At=new Uint8Array(O);for(let Et=0;Et<k;Et++){let vt=R[Et];vt instanceof Uint8Array||(typeof vt=="string"?vt=u(vt):vt=new Uint8Array(vt));const Pt=vt.byteLength;At.set(vt,dt),dt+=Pt}return At}function M(R){return String.fromCharCode(R>>24&255,R>>16&255,R>>8&255,R&255)}function U(R){return Object.keys(R).length}function Z(R){const k=Object.create(null);for(const[O,dt]of R)k[O]=dt;return k}function lt(){const R=new Uint8Array(4);return R[0]=1,new Uint32Array(R.buffer,0,1)[0]===1}function st(){try{return new Function(""),!0}catch{return!1}}class gt{static get isLittleEndian(){return b(this,"isLittleEndian",lt())}static get isEvalSupported(){return b(this,"isEvalSupported",st())}static get isOffscreenCanvasSupported(){return b(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}}f.FeatureTest=gt;const B=[...Array(256).keys()].map(R=>R.toString(16).padStart(2,"0"));class pt{static makeHexColor(k,O,dt){return`#${B[k]}${B[O]}${B[dt]}`}static scaleMinMax(k,O){let dt;k[0]?(k[0]<0&&(dt=O[0],O[0]=O[1],O[1]=dt),O[0]*=k[0],O[1]*=k[0],k[3]<0&&(dt=O[2],O[2]=O[3],O[3]=dt),O[2]*=k[3],O[3]*=k[3]):(dt=O[0],O[0]=O[2],O[2]=dt,dt=O[1],O[1]=O[3],O[3]=dt,k[1]<0&&(dt=O[2],O[2]=O[3],O[3]=dt),O[2]*=k[1],O[3]*=k[1],k[2]<0&&(dt=O[0],O[0]=O[1],O[1]=dt),O[0]*=k[2],O[1]*=k[2]),O[0]+=k[4],O[1]+=k[4],O[2]+=k[5],O[3]+=k[5]}static transform(k,O){return[k[0]*O[0]+k[2]*O[1],k[1]*O[0]+k[3]*O[1],k[0]*O[2]+k[2]*O[3],k[1]*O[2]+k[3]*O[3],k[0]*O[4]+k[2]*O[5]+k[4],k[1]*O[4]+k[3]*O[5]+k[5]]}static applyTransform(k,O){const dt=k[0]*O[0]+k[1]*O[2]+O[4],At=k[0]*O[1]+k[1]*O[3]+O[5];return[dt,At]}static applyInverseTransform(k,O){const dt=O[0]*O[3]-O[1]*O[2],At=(k[0]*O[3]-k[1]*O[2]+O[2]*O[5]-O[4]*O[3])/dt,Et=(-k[0]*O[1]+k[1]*O[0]+O[4]*O[1]-O[5]*O[0])/dt;return[At,Et]}static getAxialAlignedBoundingBox(k,O){const dt=pt.applyTransform(k,O),At=pt.applyTransform(k.slice(2,4),O),Et=pt.applyTransform([k[0],k[3]],O),vt=pt.applyTransform([k[2],k[1]],O);return[Math.min(dt[0],At[0],Et[0],vt[0]),Math.min(dt[1],At[1],Et[1],vt[1]),Math.max(dt[0],At[0],Et[0],vt[0]),Math.max(dt[1],At[1],Et[1],vt[1])]}static inverseTransform(k){const O=k[0]*k[3]-k[1]*k[2];return[k[3]/O,-k[1]/O,-k[2]/O,k[0]/O,(k[2]*k[5]-k[4]*k[3])/O,(k[4]*k[1]-k[5]*k[0])/O]}static singularValueDecompose2dScale(k){const O=[k[0],k[2],k[1],k[3]],dt=k[0]*O[0]+k[1]*O[2],At=k[0]*O[1]+k[1]*O[3],Et=k[2]*O[0]+k[3]*O[2],vt=k[2]*O[1]+k[3]*O[3],Pt=(dt+vt)/2,Rt=Math.sqrt((dt+vt)**2-4*(dt*vt-Et*At))/2,wt=Pt+Rt||1,Ot=Pt-Rt||1;return[Math.sqrt(wt),Math.sqrt(Ot)]}static normalizeRect(k){const O=k.slice(0);return k[0]>k[2]&&(O[0]=k[2],O[2]=k[0]),k[1]>k[3]&&(O[1]=k[3],O[3]=k[1]),O}static intersect(k,O){const dt=Math.max(Math.min(k[0],k[2]),Math.min(O[0],O[2])),At=Math.min(Math.max(k[0],k[2]),Math.max(O[0],O[2]));if(dt>At)return null;const Et=Math.max(Math.min(k[1],k[3]),Math.min(O[1],O[3])),vt=Math.min(Math.max(k[1],k[3]),Math.max(O[1],O[3]));return Et>vt?null:[dt,Et,At,vt]}static bezierBoundingBox(k,O,dt,At,Et,vt,Pt,Rt){const wt=[],Ot=[[],[]];let Dt,xt,Ut,Mt,jt,Bt,Lt,Ht;for(let Vt=0;Vt<2;++Vt){if(Vt===0?(xt=6*k-12*dt+6*Et,Dt=-3*k+9*dt-9*Et+3*Pt,Ut=3*dt-3*k):(xt=6*O-12*At+6*vt,Dt=-3*O+9*At-9*vt+3*Rt,Ut=3*At-3*O),Math.abs(Dt)<1e-12){if(Math.abs(xt)<1e-12)continue;Mt=-Ut/xt,0<Mt&&Mt<1&&wt.push(Mt);continue}Lt=xt*xt-4*Ut*Dt,Ht=Math.sqrt(Lt),!(Lt<0)&&(jt=(-xt+Ht)/(2*Dt),0<jt&&jt<1&&wt.push(jt),Bt=(-xt-Ht)/(2*Dt),0<Bt&&Bt<1&&wt.push(Bt))}let Gt=wt.length,Nt;const Xt=Gt;for(;Gt--;)Mt=wt[Gt],Nt=1-Mt,Ot[0][Gt]=Nt*Nt*Nt*k+3*Nt*Nt*Mt*dt+3*Nt*Mt*Mt*Et+Mt*Mt*Mt*Pt,Ot[1][Gt]=Nt*Nt*Nt*O+3*Nt*Nt*Mt*At+3*Nt*Mt*Mt*vt+Mt*Mt*Mt*Rt;return Ot[0][Xt]=k,Ot[1][Xt]=O,Ot[0][Xt+1]=Pt,Ot[1][Xt+1]=Rt,Ot[0].length=Ot[1].length=Xt+2,[Math.min(...Ot[0]),Math.min(...Ot[1]),Math.max(...Ot[0]),Math.max(...Ot[1])]}}f.Util=pt;const mt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function yt(R){if(R[0]>="ï"){let O;if(R[0]==="þ"&&R[1]==="ÿ"?O="utf-16be":R[0]==="ÿ"&&R[1]==="þ"?O="utf-16le":R[0]==="ï"&&R[1]==="»"&&R[2]==="¿"&&(O="utf-8"),O)try{const dt=new TextDecoder(O,{fatal:!0}),At=u(R);return dt.decode(At)}catch(dt){ft(`stringToPDFString: "${dt}".`)}}const k=[];for(let O=0,dt=R.length;O<dt;O++){const At=mt[R.charCodeAt(O)];k.push(At?String.fromCharCode(At):R.charAt(O))}return k.join("")}function q(R){return R.replace(/([()\\\n\r])/g,k=>k===`
`?"\\n":k==="\r"?"\\r":`\\${k}`)}function ut(R){return/^[\x00-\x7F]*$/.test(R)}function St(R){const k=["þÿ"];for(let O=0,dt=R.length;O<dt;O++){const At=R.charCodeAt(O);k.push(String.fromCharCode(At>>8&255),String.fromCharCode(At&255))}return k.join("")}function Tt(R){return decodeURIComponent(escape(R))}function Ft(R){return unescape(encodeURIComponent(R))}function kt(R){return typeof R=="object"&&R!==null&&R.byteLength!==void 0}function Ct(R,k){if(R.length!==k.length)return!1;for(let O=0,dt=R.length;O<dt;O++)if(R[O]!==k[O])return!1;return!0}function qt(R=new Date){return[R.getUTCFullYear().toString(),(R.getUTCMonth()+1).toString().padStart(2,"0"),R.getUTCDate().toString().padStart(2,"0"),R.getUTCHours().toString().padStart(2,"0"),R.getUTCMinutes().toString().padStart(2,"0"),R.getUTCSeconds().toString().padStart(2,"0")].join("")}function Ee(){const R=Object.create(null);let k=!1;return Object.defineProperty(R,"settled",{get(){return k}}),R.promise=new Promise(function(O,dt){R.resolve=function(At){k=!0,O(At)},R.reject=function(At){k=!0,dt(At)}}),R}},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var ot,J,m,x,X,z,G,j,v,y,F,re,p,c;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(10),_worker_options=__w_pdfjs_require__(14),_is_node=__w_pdfjs_require__(12),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_xfa_text=__w_pdfjs_require__(19);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:n,NodeCMapReaderFactory:e,NodeStandardFontDataFactory:o}=__w_pdfjs_require__(20);exports.DefaultCanvasFactory=DefaultCanvasFactory=n,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=e,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=o}let createPDFNetworkStream;function setPDFNetworkStreamFactory(n){createPDFNetworkStream=n}function getDocument(n){const e=new PDFDocumentLoadingTask;let o;if(typeof n=="string"||n instanceof URL)o={url:n};else if((0,_util.isArrayBuffer)(n))o={data:n};else if(n instanceof PDFDataRangeTransport)o={range:n};else{if(typeof n!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!n.url&&!n.data&&!n.range)throw new Error("Invalid parameter object: need either .data, .range or .url");o=n}const r=Object.create(null);let l=null,t=null;for(const _ in o){const C=o[_];switch(_){case"url":if(typeof window<"u")try{r[_]=new URL(C,window.location).href;continue}catch(D){(0,_util.warn)(`Cannot create valid URL: "${D}".`)}else if(typeof C=="string"||C instanceof URL){r[_]=C.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":l=C;continue;case"worker":t=C;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&C instanceof Buffer)r[_]=new Uint8Array(C);else{if(C instanceof Uint8Array)break;if(typeof C=="string")r[_]=(0,_util.stringToBytes)(C);else if(typeof C=="object"&&C!==null&&!isNaN(C.length))r[_]=new Uint8Array(C);else if((0,_util.isArrayBuffer)(C))r[_]=new Uint8Array(C);else throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}continue}r[_]=C}if(r.CMapReaderFactory=r.CMapReaderFactory||DefaultCMapReaderFactory,r.StandardFontDataFactory=r.StandardFontDataFactory||DefaultStandardFontDataFactory,r.ignoreErrors=r.stopAtErrors!==!0,r.fontExtraProperties=r.fontExtraProperties===!0,r.pdfBug=r.pdfBug===!0,r.enableXfa=r.enableXfa===!0,(!Number.isInteger(r.rangeChunkSize)||r.rangeChunkSize<1)&&(r.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),(typeof r.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(r.docBaseUrl))&&(r.docBaseUrl=null),(!Number.isInteger(r.maxImageSize)||r.maxImageSize<-1)&&(r.maxImageSize=-1),typeof r.cMapUrl!="string"&&(r.cMapUrl=null),typeof r.standardFontDataUrl!="string"&&(r.standardFontDataUrl=null),typeof r.useWorkerFetch!="boolean"&&(r.useWorkerFetch=r.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&r.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),typeof r.isEvalSupported!="boolean"&&(r.isEvalSupported=!0),typeof r.isOffscreenCanvasSupported!="boolean"&&(r.isOffscreenCanvasSupported=!_is_node.isNodeJS),typeof r.disableFontFace!="boolean"&&(r.disableFontFace=_is_node.isNodeJS),typeof r.useSystemFonts!="boolean"&&(r.useSystemFonts=!_is_node.isNodeJS&&!r.disableFontFace),(typeof r.ownerDocument!="object"||r.ownerDocument===null)&&(r.ownerDocument=globalThis.document),typeof r.disableRange!="boolean"&&(r.disableRange=!1),typeof r.disableStream!="boolean"&&(r.disableStream=!1),typeof r.disableAutoFetch!="boolean"&&(r.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(r.verbosity),!t){const _={verbosity:r.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};t=_.port?PDFWorker.fromPort(_):new PDFWorker(_),e._worker=t}const s=e.docId;return t.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");const _=_fetchDocument(t,r,l,s),C=new Promise(function(D){let E;l?E=new _transport_stream.PDFDataTransportStream({length:r.length,initialData:r.initialData,progressiveDone:r.progressiveDone,contentDispositionFilename:r.contentDispositionFilename,disableRange:r.disableRange,disableStream:r.disableStream},l):r.data||(E=createPDFNetworkStream({url:r.url,length:r.length,httpHeaders:r.httpHeaders,withCredentials:r.withCredentials,rangeChunkSize:r.rangeChunkSize,disableRange:r.disableRange,disableStream:r.disableStream})),D(E)});return Promise.all([_,C]).then(function([D,E]){if(e.destroyed)throw new Error("Loading aborted");const T=new _message_handler.MessageHandler(s,D,t.port),Q=new WorkerTransport(T,e,E,r);e._transport=Q,T.send("Ready",null)})}).catch(e._capability.reject),e}async function _fetchDocument(n,e,o,r){if(n.destroyed)throw new Error("Worker was destroyed");o&&(e.length=o.length,e.initialData=o.initialData,e.progressiveDone=o.progressiveDone,e.contentDispositionFilename=o.contentDispositionFilename);const l=await n.messageHandler.sendWithPromise("GetDocRequest",{docId:r,apiVersion:"3.0.279",data:e.data,password:e.password,disableAutoFetch:e.disableAutoFetch,rangeChunkSize:e.rangeChunkSize,length:e.length,docBaseUrl:e.docBaseUrl,enableXfa:e.enableXfa,evaluatorOptions:{maxImageSize:e.maxImageSize,disableFontFace:e.disableFontFace,ignoreErrors:e.ignoreErrors,isEvalSupported:e.isEvalSupported,isOffscreenCanvasSupported:e.isOffscreenCanvasSupported,fontExtraProperties:e.fontExtraProperties,useSystemFonts:e.useSystemFonts,cMapUrl:e.useWorkerFetch?e.cMapUrl:null,standardFontDataUrl:e.useWorkerFetch?e.standardFontDataUrl:null}});if(e.data&&(e.data=null),n.destroyed)throw new Error("Worker was destroyed");return l}const f=class{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${ie(f,ot)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){var e;this.destroyed=!0,await((e=this._transport)==null?void 0:e.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};let PDFDocumentLoadingTask=f;ot=new WeakMap,it(PDFDocumentLoadingTask,ot,0),exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(e,o,r=!1,l=null){this.length=e,this.initialData=o,this.progressiveDone=r,this.contentDispositionFilename=l,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,o){for(const r of this._rangeListeners)r(e,o)}onDataProgress(e,o){this._readyCapability.promise.then(()=>{for(const r of this._progressListeners)r(e,o)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const o of this._progressiveReadListeners)o(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,o){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(e,o){this._pdfInfo=e,this._transport=o}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(e,o,r,l,t=!1){this._pageIndex=e,this._pageInfo=o,this._ownerDocument=l,this._transport=r,this._stats=t?new _display_utils.StatTimer:null,this._pdfBug=t,this.commonObjs=r.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:o=this.rotate,offsetX:r=0,offsetY:l=0,dontFlip:t=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:e,rotation:o,offsetX:r,offsetY:l,dontFlip:t})}getAnnotations({intent:e="display"}={}){const o=this._transport.getRenderingIntent(e);let r=this._annotationPromises.get(o.cacheKey);return r||(r=this._transport.getAnnotations(this._pageIndex,o.renderingIntent),this._annotationPromises.set(o.cacheKey,r)),r}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:o,intent:r="display",annotationMode:l=_util.AnnotationMode.ENABLE,transform:t=null,canvasFactory:s=null,background:_=null,optionalContentConfigPromise:C=null,annotationCanvasMap:D=null,pageColors:E=null,printAnnotationStorage:T=null}){var nt,ft;(nt=this._stats)==null||nt.time("Overall");const Q=this._transport.getRenderingIntent(r,l,T);this.pendingCleanup=!1,C||(C=this._transport.getOptionalContentConfig());let ct=this._intentStates.get(Q.cacheKey);ct||(ct=Object.create(null),this._intentStates.set(Q.cacheKey,ct)),ct.streamReaderCancelTimeout&&(clearTimeout(ct.streamReaderCancelTimeout),ct.streamReaderCancelTimeout=null);const rt=s||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),V=!!(Q.renderingIntent&_util.RenderingIntentFlag.PRINT);ct.displayReadyCapability||(ct.displayReadyCapability=(0,_util.createPromiseCapability)(),ct.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(ft=this._stats)==null||ft.time("Page Request"),this._pumpOperatorList(Q));const W=bt=>{var I,d;ct.renderTasks.delete($),(this.cleanupAfterRender||V)&&(this.pendingCleanup=!0),this._tryCleanup(),bt?($.capability.reject(bt),this._abortOperatorList({intentState:ct,reason:bt instanceof Error?bt:new Error(bt)})):$.capability.resolve(),(I=this._stats)==null||I.timeEnd("Rendering"),(d=this._stats)==null||d.timeEnd("Overall")},$=new InternalRenderTask({callback:W,params:{canvasContext:e,viewport:o,transform:t,background:_},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:D,operatorList:ct.operatorList,pageIndex:this._pageIndex,canvasFactory:rt,useRequestAnimationFrame:!V,pdfBug:this._pdfBug,pageColors:E});(ct.renderTasks||(ct.renderTasks=new Set)).add($);const tt=$.task;return Promise.all([ct.displayReadyCapability.promise,C]).then(([bt,I])=>{var d;if(this.pendingCleanup){W();return}(d=this._stats)==null||d.time("Rendering"),$.initializeGraphics({transparency:bt,optionalContentConfig:I}),$.operatorListChanged()}).catch(W),tt}getOperatorList({intent:e="display",annotationMode:o=_util.AnnotationMode.ENABLE,printAnnotationStorage:r=null}={}){var C;function l(){s.operatorList.lastChunk&&(s.opListReadCapability.resolve(s.operatorList),s.renderTasks.delete(_))}const t=this._transport.getRenderingIntent(e,o,r,!0);let s=this._intentStates.get(t.cacheKey);s||(s=Object.create(null),this._intentStates.set(t.cacheKey,s));let _;return s.opListReadCapability||(_=Object.create(null),_.operatorListChanged=l,s.opListReadCapability=(0,_util.createPromiseCapability)(),(s.renderTasks||(s.renderTasks=new Set)).add(_),s.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(C=this._stats)==null||C.time("Page Request"),this._pumpOperatorList(t)),s.opListReadCapability.promise}streamTextContent({disableCombineTextItems:e=!1,includeMarkedContent:o=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:e!==!0,includeMarkedContent:o===!0},{highWaterMark:100,size(l){return l.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(r=>_xfa_text.XfaText.textContent(r));const o=this.streamTextContent(e);return new Promise(function(r,l){function t(){s.read().then(function({value:C,done:D}){if(D){r(_);return}Object.assign(_.styles,C.styles),_.items.push(...C.items),t()},l)}const s=o.getReader(),_={items:[],styles:Object.create(null)};t()})}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0;const e=[];for(const o of this._intentStates.values())if(this._abortOperatorList({intentState:o,reason:new Error("Page was destroyed."),force:!0}),!o.opListReadCapability)for(const r of o.renderTasks)e.push(r.completed),r.cancel();this.objs.clear();for(const o of this._bitmaps)o.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(e)}cleanup(e=!1){return this.pendingCleanup=!0,this._tryCleanup(e)}_tryCleanup(e=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:o,operatorList:r}of this._intentStates.values())if(o.size>0||!r.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,e&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const o of this._bitmaps)o.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(e,o){var l,t;const r=this._intentStates.get(o);!r||((l=this._stats)==null||l.timeEnd("Page Request"),(t=r.displayReadyCapability)==null||t.resolve(e))}_renderPageChunk(e,o){for(let r=0,l=e.length;r<l;r++)o.operatorList.fnArray.push(e.fnArray[r]),o.operatorList.argsArray.push(e.argsArray[r]);o.operatorList.lastChunk=e.lastChunk,o.operatorList.separateAnnots=e.separateAnnots;for(const r of o.renderTasks)r.operatorListChanged();e.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:e,cacheKey:o,annotationStorageMap:r}){const t=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:o,annotationStorage:r}).getReader(),s=this._intentStates.get(o);s.streamReader=t;const _=()=>{t.read().then(({value:C,done:D})=>{if(D){s.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(C,s),_())},C=>{if(s.streamReader=null,!this._transport.destroyed){if(s.operatorList){s.operatorList.lastChunk=!0;for(const D of s.renderTasks)D.operatorListChanged();this._tryCleanup()}if(s.displayReadyCapability)s.displayReadyCapability.reject(C);else if(s.opListReadCapability)s.opListReadCapability.reject(C);else throw C}})};_()}_abortOperatorList({intentState:e,reason:o,force:r=!1}){if(!!e.streamReader){if(!r){if(e.renderTasks.size>0)return;if(o instanceof _display_utils.RenderingCancelledException){e.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:e,reason:o,force:!0}),e.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(e.streamReader.cancel(new _util.AbortException(o.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[l,t]of this._intentStates)if(t===e){this._intentStates.delete(l);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){it(this,J,[]);it(this,m,Promise.resolve())}postMessage(e,o){const r={data:structuredClone(e,o)};S(this,m).then(()=>{for(const l of S(this,J))l.call(this,r)})}addEventListener(e,o){S(this,J).push(o)}removeEventListener(e,o){const r=S(this,J).indexOf(o);S(this,J).splice(r,1)}terminate(){S(this,J).length=0}}J=new WeakMap,m=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const n=(x=document==null?void 0:document.currentScript)==null?void 0:x.src;n&&(PDFWorkerUtil.fallbackWorkerSrc=n.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(n,e){let o;try{if(o=new URL(n),!o.origin||o.origin==="null")return!1}catch{return!1}const r=new URL(e,o);return o.origin===r.origin},PDFWorkerUtil.createCDNWrapper=function(n){const e=`importScripts("${n}");`;return URL.createObjectURL(new Blob([e]))}}const _PDFWorker=class{constructor({name:n=null,port:e=null,verbosity:o=(0,_util.getVerbosityLevel)()}={}){if(e&&S(_PDFWorker,X).has(e))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=n,this.destroyed=!1,this.verbosity=o,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,e){S(_PDFWorker,X).set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(n){this._port=n,this._messageHandler=new _message_handler.MessageHandler("main","worker",n),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:n}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,n)||(n=PDFWorkerUtil.createCDNWrapper(new URL(n,window.location).href));const e=new Worker(n),o=new _message_handler.MessageHandler("main","worker",e),r=()=>{e.removeEventListener("error",l),o.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},l=()=>{this._webWorker||r()};e.addEventListener("error",l),o.on("test",s=>{if(e.removeEventListener("error",l),this.destroyed){r();return}s?(this._messageHandler=o,this._port=e,this._webWorker=e,this._readyCapability.resolve(),o.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),o.destroy(),e.terminate())}),o.on("ready",s=>{if(e.removeEventListener("error",l),this.destroyed){r();return}try{t()}catch{this._setupFakeWorker()}});const t=()=>{const s=new Uint8Array;o.send("test",s,[s.buffer])};t();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(n=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new LoopbackPort;this._port=e;const o=`fake${PDFWorkerUtil.fakeWorkerId++}`,r=new _message_handler.MessageHandler(o+"_worker",o,e);n.setup(r,e);const l=new _message_handler.MessageHandler(o,o+"_worker",e);this._messageHandler=l,this._readyCapability.resolve(),l.send("configure",{verbosity:this.verbosity})}).catch(n=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${n.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),S(_PDFWorker,X).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(n){if(!(n!=null&&n.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return S(this,X).has(n.port)?S(this,X).get(n.port):new _PDFWorker(n)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var n;try{return((n=globalThis.pdfjsWorker)==null?void 0:n.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};let PDFWorker=_PDFWorker;X=new WeakMap,it(PDFWorker,X,new WeakMap),exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(e,o,r,l){it(this,z,null);it(this,G,new Map);it(this,j,new Map);it(this,v,null);this.messageHandler=e,this.loadingTask=o,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:l.ownerDocument,styleElement:l.styleElement}),this._params=l,l.useWorkerFetch||(this.CMapReaderFactory=new l.CMapReaderFactory({baseUrl:l.cMapUrl,isCompressed:l.cMapPacked}),this.StandardFontDataFactory=new l.StandardFontDataFactory({baseUrl:l.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=r,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return S(this,z)}getRenderingIntent(e,o=_util.AnnotationMode.ENABLE,r=null,l=!1){let t=_util.RenderingIntentFlag.DISPLAY,s=null;switch(e){case"any":t=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":t=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${e}`)}switch(o){case _util.AnnotationMode.DISABLE:t+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:t+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:t+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,s=(t&_util.RenderingIntentFlag.PRINT&&r instanceof _annotation_storage.PrintAnnotationStorage?r:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${o}`)}return l&&(t+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:t,cacheKey:`${t}_${_annotation_storage.AnnotationStorage.getHash(s)}`,annotationStorageMap:s}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const r of S(this,G).values())e.push(r._destroy());S(this,G).clear(),S(this,j).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const o=this.messageHandler.sendWithPromise("Terminate",null);return e.push(o),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),_t(this,v,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:o}=this;e.on("GetReader",(r,l)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=t=>{this._lastProgress={loaded:t.loaded,total:t.total}},l.onPull=()=>{this._fullReader.read().then(function({value:t,done:s}){if(s){l.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(t),"GetReader - expected an ArrayBuffer."),l.enqueue(new Uint8Array(t),1,[t])}).catch(t=>{l.error(t)})},l.onCancel=t=>{this._fullReader.cancel(t),l.ready.catch(s=>{if(!this.destroyed)throw s})}}),e.on("ReaderHeadersReady",r=>{const l=(0,_util.createPromiseCapability)(),t=this._fullReader;return t.headersReady.then(()=>{var s;(!t.isStreamingSupported||!t.isRangeSupported)&&(this._lastProgress&&((s=o.onProgress)==null||s.call(o,this._lastProgress)),t.onProgress=_=>{var C;(C=o.onProgress)==null||C.call(o,{loaded:_.loaded,total:_.total})}),l.resolve({isStreamingSupported:t.isStreamingSupported,isRangeSupported:t.isRangeSupported,contentLength:t.contentLength})},l.reject),l.promise}),e.on("GetRangeReader",(r,l)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const t=this._networkStream.getRangeReader(r.begin,r.end);if(!t){l.close();return}l.onPull=()=>{t.read().then(function({value:s,done:_}){if(_){l.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(s),"GetRangeReader - expected an ArrayBuffer."),l.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{l.error(s)})},l.onCancel=s=>{t.cancel(s),l.ready.catch(_=>{if(!this.destroyed)throw _})}}),e.on("GetDoc",({pdfInfo:r})=>{this._numPages=r.numPages,this._htmlForXfa=r.htmlForXfa,delete r.htmlForXfa,o._capability.resolve(new PDFDocumentProxy(r,this))}),e.on("DocException",function(r){let l;switch(r.name){case"PasswordException":l=new _util.PasswordException(r.message,r.code);break;case"InvalidPDFException":l=new _util.InvalidPDFException(r.message);break;case"MissingPDFException":l=new _util.MissingPDFException(r.message);break;case"UnexpectedResponseException":l=new _util.UnexpectedResponseException(r.message,r.status);break;case"UnknownErrorException":l=new _util.UnknownErrorException(r.message,r.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}o._capability.reject(l)}),e.on("PasswordRequest",r=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),o.onPassword){const l=t=>{t instanceof Error?this._passwordCapability.reject(t):this._passwordCapability.resolve({password:t})};try{o.onPassword(l,r.code)}catch(t){this._passwordCapability.reject(t)}}else this._passwordCapability.reject(new _util.PasswordException(r.message,r.code));return this._passwordCapability.promise}),e.on("DataLoaded",r=>{var l;(l=o.onProgress)==null||l.call(o,{loaded:r.length,total:r.length}),this.downloadInfoCapability.resolve(r)}),e.on("StartRenderPage",r=>{if(this.destroyed)return;S(this,G).get(r.pageIndex)._startRenderPage(r.transparency,r.cacheKey)}),e.on("commonobj",([r,l,t])=>{var s;if(!this.destroyed&&!this.commonObjs.has(r))switch(l){case"Font":const _=this._params;if("error"in t){const E=t.error;(0,_util.warn)(`Error during font loading: ${E}`),this.commonObjs.resolve(r,E);break}let C=null;_.pdfBug&&((s=globalThis.FontInspector)==null?void 0:s.enabled)&&(C={registerFont(E,T){globalThis.FontInspector.fontAdded(E,T)}});const D=new _font_loader.FontFaceObject(t,{isEvalSupported:_.isEvalSupported,disableFontFace:_.disableFontFace,ignoreErrors:_.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:C});this.fontLoader.bind(D).catch(E=>e.sendWithPromise("FontFallback",{id:r})).finally(()=>{!_.fontExtraProperties&&D.data&&(D.data=null),this.commonObjs.resolve(r,D)});break;case"FontPath":case"Image":this.commonObjs.resolve(r,t);break;default:throw new Error(`Got unknown common object type ${l}`)}}),e.on("obj",([r,l,t,s])=>{var C;if(this.destroyed)return;const _=S(this,G).get(l);if(!_.objs.has(r))switch(t){case"Image":_.objs.resolve(r,s);const D=8e6;if(s){let E;if(s.bitmap){const{bitmap:T,width:Q,height:ct}=s;E=Q*ct*4,_._bitmaps.add(T)}else E=((C=s.data)==null?void 0:C.length)||0;E>D&&(_.cleanupAfterRender=!0)}break;case"Pattern":_.objs.resolve(r,s);break;default:throw new Error(`Got unknown object type ${t}`)}}),e.on("DocProgress",r=>{var l;this.destroyed||(l=o.onProgress)==null||l.call(o,{loaded:r.loaded,total:r.total})}),e.on("DocStats",r=>{this.destroyed||_t(this,z,Object.freeze({streamTypes:Object.freeze(r.streamTypes),fontTypes:Object.freeze(r.fontTypes)}))}),e.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),e.on("FetchBuiltInCMap",r=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(r):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),e.on("FetchStandardFontData",r=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(r):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:e}){var o,r;this.destroyed||(r=(o=this.loadingTask).onUnsupportedFeature)==null||r.call(o,e)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var e;return this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((e=this._fullReader)==null?void 0:e.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const o=e-1,r=S(this,j).get(o);if(r)return r;const l=this.messageHandler.sendWithPromise("GetPage",{pageIndex:o}).then(t=>{if(this.destroyed)throw new Error("Transport destroyed");const s=new PDFPageProxy(o,t,this,this._params.ownerDocument,this._params.pdfBug);return S(this,G).set(o,s),s});return S(this,j).set(o,l),l}getPageIndex(e){return typeof e!="object"||e===null||!Number.isInteger(e.num)||e.num<0||!Number.isInteger(e.gen)||e.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen})}getAnnotations(e,o){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:o})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(e=>new _optional_content_config.OptionalContentConfig(e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return S(this,v)||_t(this,v,this.messageHandler.sendWithPromise("GetMetadata",null).then(e=>{var o,r;return{info:e[0],metadata:e[1]?new _metadata.Metadata(e[1]):null,contentDispositionFilename:((o=this._fullReader)==null?void 0:o.filename)??null,contentLength:((r=this._fullReader)==null?void 0:r.contentLength)??null}}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const o of S(this,G).values())if(!o.cleanup())throw new Error(`startCleanup: Page ${o.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),_t(this,v,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const e=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:e.disableAutoFetch,enableXfa:e.enableXfa})}}z=new WeakMap,G=new WeakMap,j=new WeakMap,v=new WeakMap;class PDFObjects{constructor(){it(this,F);it(this,y,Object.create(null))}get(e,o=null){if(o){const l=ht(this,F,re).call(this,e);return l.capability.promise.then(()=>o(l.data)),null}const r=S(this,y)[e];if(!(r!=null&&r.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${e}.`);return r.data}has(e){const o=S(this,y)[e];return(o==null?void 0:o.capability.settled)||!1}resolve(e,o=null){const r=ht(this,F,re).call(this,e);r.data=o,r.capability.resolve()}clear(){_t(this,y,Object.create(null))}}y=new WeakMap,F=new WeakSet,re=function(e){const o=S(this,y)[e];return o||(S(this,y)[e]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(e){it(this,p,null);_t(this,p,e),this.onContinue=null}get promise(){return S(this,p).capability.promise}cancel(){S(this,p).cancel()}get separateAnnots(){const{separateAnnots:e}=S(this,p).operatorList;if(!e)return!1;const{annotationCanvasMap:o}=S(this,p);return e.form||e.canvas&&(o==null?void 0:o.size)>0}}p=new WeakMap,exports.RenderTask=RenderTask;const h=class{constructor({callback:e,params:o,objs:r,commonObjs:l,annotationCanvasMap:t,operatorList:s,pageIndex:_,canvasFactory:C,useRequestAnimationFrame:D=!1,pdfBug:E=!1,pageColors:T=null}){this.callback=e,this.params=o,this.objs=r,this.commonObjs=l,this.annotationCanvasMap=t,this.operatorListIdx=null,this.operatorList=s,this._pageIndex=_,this.canvasFactory=C,this._pdfBug=E,this.pageColors=T,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=D===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=o.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:o}){var _,C;if(this.cancelled)return;if(this._canvas){if(S(h,c).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");S(h,c).add(this._canvas)}this._pdfBug&&((_=globalThis.StepperManager)==null?void 0:_.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:r,viewport:l,transform:t,background:s}=this.params;this.gfx=new _canvas.CanvasGraphics(r,this.commonObjs,this.objs,this.canvasFactory,o,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:t,viewport:l,transparency:e,background:s}),this.operatorListIdx=0,this.graphicsReady=!0,(C=this.graphicsReadyCallback)==null||C.call(this)}cancel(e=null){var o;this.running=!1,this.cancelled=!0,(o=this.gfx)==null||o.endDrawing(),this._canvas&&S(h,c).delete(this._canvas),this.callback(e||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&S(h,c).delete(this._canvas),this.callback())))}};let InternalRenderTask=h;c=new WeakMap,it(InternalRenderTask,c,new WeakSet);const version="3.0.279";exports.version=version;const build="d0823066c";exports.build=build},(ot,f,J)=>{var j,Te,y;Object.defineProperty(f,"__esModule",{value:!0}),f.PrintAnnotationStorage=f.AnnotationStorage=void 0;var m=J(1),x=J(4),X=J(8);class z{constructor(){it(this,j);this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(A,p){const c=this._storage.get(A);return c===void 0?p:Object.assign(p,c)}getRawValue(A){return this._storage.get(A)}remove(A){if(this._storage.delete(A),this._storage.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const p of this._storage.values())if(p instanceof x.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(A,p){const c=this._storage.get(A);let h=!1;if(c!==void 0)for(const[n,e]of Object.entries(p))c[n]!==e&&(h=!0,c[n]=e);else h=!0,this._storage.set(A,p);h&&ht(this,j,Te).call(this),p instanceof x.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(p.constructor._type)}has(A){return this._storage.has(A)}getAll(){return this._storage.size>0?(0,m.objectFromMap)(this._storage):null}get size(){return this._storage.size}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new G(this)}get serializable(){if(this._storage.size===0)return null;const A=new Map;for(const[p,c]of this._storage){const h=c instanceof x.AnnotationEditor?c.serialize():c;h&&A.set(p,h)}return A}static getHash(A){if(!A)return"";const p=new X.MurmurHash3_64;for(const[c,h]of A)p.update(`${c}:${JSON.stringify(h)}`);return p.hexdigest()}}j=new WeakSet,Te=function(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())},f.AnnotationStorage=z;class G extends z{constructor(p){super();it(this,y,null);_t(this,y,structuredClone(p.serializable))}get print(){(0,m.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return S(this,y)}}y=new WeakMap,f.PrintAnnotationStorage=G},(ot,f,J)=>{var z,G,j,v,y,F;Object.defineProperty(f,"__esModule",{value:!0}),f.AnnotationEditor=void 0;var m=J(5),x=J(1);const A=class{constructor(c){it(this,z,this.focusin.bind(this));it(this,G,this.focusout.bind(this));it(this,j,!1);it(this,v,!1);it(this,y,!1);it(this,F,A._zIndex++);this.constructor===A&&(0,x.unreachable)("Cannot initialize AnnotationEditor."),this.parent=c.parent,this.id=c.id,this.width=this.height=null,this.pageIndex=c.parent.pageIndex,this.name=c.name,this.div=null;const[h,n]=this.parent.viewportBaseDimensions;this.x=c.x/h,this.y=c.y/n,this.rotation=this.parent.viewport.rotation,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,x.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=S(this,F)}focusin(c){S(this,j)?_t(this,j,!1):this.parent.setSelected(this)}focusout(c){if(!this.isAttachedToDOM)return;const h=c.relatedTarget;h!=null&&h.closest(`#${this.id}`)||(c.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.parent.addToAnnotationStorage(this)}dragstart(c){const h=this.parent.div.getBoundingClientRect();this.startX=c.clientX-h.x,this.startY=c.clientY-h.y,c.dataTransfer.setData("text/plain",this.id),c.dataTransfer.effectAllowed="move"}setAt(c,h,n,e){const[o,r]=this.parent.viewportBaseDimensions;[n,e]=this.screenToPageTranslation(n,e),this.x=(c+n)/o,this.y=(h+e)/r,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(c,h){const[n,e]=this.parent.viewportBaseDimensions;[c,h]=this.screenToPageTranslation(c,h),this.x+=c/n,this.y+=h/e,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(c,h){const{rotation:n}=this.parent.viewport;switch(n){case 90:return[h,-c];case 180:return[-c,-h];case 270:return[-h,c];default:return[c,h]}}setDims(c,h){const[n,e]=this.parent.viewportBaseDimensions;this.div.style.width=`${100*c/n}%`,this.div.style.height=`${100*h/e}%`}fixDims(){const{style:c}=this.div,{height:h,width:n}=c,e=n.endsWith("%"),o=h.endsWith("%");if(e&&o)return;const[r,l]=this.parent.viewportBaseDimensions;e||(c.width=`${100*parseFloat(n)/r}%`),o||(c.height=`${100*parseFloat(h)/l}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",S(this,z)),this.div.addEventListener("focusout",S(this,G));const[c,h]=this.getInitialTranslation();return this.translate(c,h),(0,m.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(c){const h=m.KeyboardManager.platform.isMac;if(c.button!==0||c.ctrlKey&&h){c.preventDefault();return}c.ctrlKey&&!h||c.shiftKey||c.metaKey&&h?this.parent.toggleSelected(this):this.parent.setSelected(this),_t(this,j,!0)}getRect(c,h){const[n,e]=this.parent.viewportBaseDimensions,[o,r]=this.parent.pageDimensions,l=o*c/n,t=r*h/e,s=this.x*o,_=this.y*r,C=this.width*o,D=this.height*r;switch(this.rotation){case 0:return[s+l,r-_-t-D,s+l+C,r-_-t];case 90:return[s+t,r-_+l,s+t+D,r-_+l+C];case 180:return[s-l-C,r-_+t,s-l,r-_+t+D];case 270:return[s-t-D,r-_-l-C,s-t,r-_-l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(c,h){const[n,e,o,r]=c,l=o-n,t=r-e;switch(this.rotation){case 0:return[n,h-r,l,t];case 90:return[n,h-e,t,l];case 180:return[o,h-e,l,t];case 270:return[o,h-r,t,l];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){_t(this,y,!0)}disableEditMode(){_t(this,y,!1)}isInEditMode(){return S(this,y)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var c;(c=this.div)==null||c.addEventListener("focusin",S(this,z))}serialize(){(0,x.unreachable)("An editor must be serializable")}static deserialize(c,h){const n=new this.prototype.constructor({parent:h,id:h.getNextId()});n.rotation=c.rotation;const[e,o]=h.pageDimensions,[r,l,t,s]=n.getRectInCurrentCoords(c.rect,o);return n.x=r/e,n.y=l/o,n.width=t/e,n.height=s/o,n}remove(){this.div.removeEventListener("focusin",S(this,z)),this.div.removeEventListener("focusout",S(this,G)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var c;(c=this.div)==null||c.classList.add("selectedEditor")}unselect(){var c;(c=this.div)==null||c.classList.remove("selectedEditor")}updateParams(c,h){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return S(this,v)}set isEditing(c){_t(this,v,c),c?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};let X=A;z=new WeakMap,G=new WeakMap,j=new WeakMap,v=new WeakMap,y=new WeakMap,F=new WeakMap,It(X,"_colorManager",new m.ColorManager),It(X,"_zIndex",1),f.AnnotationEditor=X},(ot,f,J)=>{var A,p,c,h,n,e,Pe,t,s,_,C,D,E,T,Q,ct,rt,V,W,$,tt,nt,ft,bt,I,d,a,xe,w,ae,N,we,Y,ke,K,Wt,i,Jt,g,Fe,M,Re,Z,oe,st,Qt,B,le;Object.defineProperty(f,"__esModule",{value:!0}),f.KeyboardManager=f.CommandManager=f.ColorManager=f.AnnotationEditorUIManager=void 0,f.bindEvents=X,f.opacityToHex=z;var m=J(1),x=J(6);function X(yt,q,ut){for(const St of ut)q.addEventListener(St,yt[St].bind(yt))}function z(yt){return Math.round(Math.min(255,Math.max(1,255*yt))).toString(16).padStart(2,"0")}class G{constructor(){it(this,A,0)}getId(){return`${m.AnnotationEditorPrefix}${ie(this,A)._++}`}}A=new WeakMap;class j{constructor(q=128){it(this,p,[]);it(this,c,!1);it(this,h,void 0);it(this,n,-1);_t(this,h,q)}add({cmd:q,undo:ut,mustExec:St,type:Tt=NaN,overwriteIfSameType:Ft=!1,keepUndo:kt=!1}){if(St&&q(),S(this,c))return;const Ct={cmd:q,undo:ut,type:Tt};if(S(this,n)===-1){S(this,p).length>0&&(S(this,p).length=0),_t(this,n,0),S(this,p).push(Ct);return}if(Ft&&S(this,p)[S(this,n)].type===Tt){kt&&(Ct.undo=S(this,p)[S(this,n)].undo),S(this,p)[S(this,n)]=Ct;return}const qt=S(this,n)+1;qt===S(this,h)?S(this,p).splice(0,1):(_t(this,n,qt),qt<S(this,p).length&&S(this,p).splice(qt)),S(this,p).push(Ct)}undo(){S(this,n)!==-1&&(_t(this,c,!0),S(this,p)[S(this,n)].undo(),_t(this,c,!1),_t(this,n,S(this,n)-1))}redo(){S(this,n)<S(this,p).length-1&&(_t(this,n,S(this,n)+1),_t(this,c,!0),S(this,p)[S(this,n)].cmd(),_t(this,c,!1))}hasSomethingToUndo(){return S(this,n)!==-1}hasSomethingToRedo(){return S(this,n)<S(this,p).length-1}destroy(){_t(this,p,null)}}p=new WeakMap,c=new WeakMap,h=new WeakMap,n=new WeakMap,f.CommandManager=j;const r=class{constructor(q){it(this,e);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const ut=r.platform.isMac;for(const[St,Tt]of q)for(const Ft of St){const kt=Ft.startsWith("mac+");ut&&kt?(this.callbacks.set(Ft.slice(4),Tt),this.allKeys.add(Ft.split("+").at(-1))):!ut&&!kt&&(this.callbacks.set(Ft,Tt),this.allKeys.add(Ft.split("+").at(-1)))}}static get platform(){const q=typeof navigator<"u"?navigator.platform:"";return(0,m.shadow)(this,"platform",{isWin:q.includes("Win"),isMac:q.includes("Mac")})}exec(q,ut){if(!this.allKeys.has(ut.key))return;const St=this.callbacks.get(ht(this,e,Pe).call(this,ut));!St||(St.bind(q)(),ut.stopPropagation(),ut.preventDefault())}};let v=r;e=new WeakSet,Pe=function(q){q.altKey&&this.buffer.push("alt"),q.ctrlKey&&this.buffer.push("ctrl"),q.metaKey&&this.buffer.push("meta"),q.shiftKey&&this.buffer.push("shift"),this.buffer.push(q.key);const ut=this.buffer.join("+");return this.buffer.length=0,ut},f.KeyboardManager=v;const l=class{get _colors(){const q=new Map([["CanvasText",null],["Canvas",null]]);return(0,x.getColorValues)(q),(0,m.shadow)(this,"_colors",q)}convert(q){const ut=(0,x.getRGB)(q);if(!window.matchMedia("(forced-colors: active)").matches)return ut;for(const[St,Tt]of this._colors)if(Tt.every((Ft,kt)=>Ft===ut[kt]))return l._colorsMapping.get(St);return ut}getHexCode(q){const ut=this._colors.get(q);return ut?m.Util.makeHexColor(...ut):q}};let y=l;It(y,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]])),f.ColorManager=y;const mt=class{constructor(q,ut){it(this,a);it(this,w);it(this,N);it(this,Y);it(this,K);it(this,i);it(this,g);it(this,M);it(this,Z);it(this,st);it(this,B);it(this,t,null);it(this,s,new Map);it(this,_,new Map);it(this,C,new j);it(this,D,0);it(this,E,null);it(this,T,null);it(this,Q,new G);it(this,ct,!1);it(this,rt,m.AnnotationEditorType.NONE);it(this,V,new Set);it(this,W,this.copy.bind(this));it(this,$,this.cut.bind(this));it(this,tt,this.paste.bind(this));it(this,nt,this.keydown.bind(this));it(this,ft,this.onEditingAction.bind(this));it(this,bt,this.onPageChanging.bind(this));it(this,I,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});it(this,d,null);_t(this,d,q),_t(this,T,ut),S(this,T)._on("editingaction",S(this,ft)),S(this,T)._on("pagechanging",S(this,bt))}destroy(){ht(this,w,ae).call(this),S(this,T)._off("editingaction",S(this,ft)),S(this,T)._off("pagechanging",S(this,bt));for(const q of S(this,_).values())q.destroy();S(this,_).clear(),S(this,s).clear(),_t(this,t,null),S(this,V).clear(),S(this,C).destroy()}onPageChanging({pageNumber:q}){_t(this,D,q-1)}focusMainContainer(){S(this,d).focus()}copy(q){if(q.preventDefault(),S(this,t)&&S(this,t).commitOrRemove(),!this.hasSelection)return;const ut=[];for(const St of S(this,V))St.isEmpty()||ut.push(St.serialize());ut.length!==0&&q.clipboardData.setData("application/pdfjs",JSON.stringify(ut))}cut(q){this.copy(q),this.delete()}paste(q){q.preventDefault();let ut=q.clipboardData.getData("application/pdfjs");if(!ut)return;try{ut=JSON.parse(ut)}catch(Tt){(0,m.warn)(`paste: "${Tt.message}".`);return}if(!Array.isArray(ut))return;this.unselectAll();const St=S(this,_).get(S(this,D));try{const Tt=[];for(const Ct of ut){const qt=St.deserialize(Ct);if(!qt)return;Tt.push(qt)}const Ft=()=>{for(const Ct of Tt)ht(this,Z,oe).call(this,Ct);ht(this,B,le).call(this,Tt)},kt=()=>{for(const Ct of Tt)Ct.remove()};this.addCommands({cmd:Ft,undo:kt,mustExec:!0})}catch(Tt){(0,m.warn)(`paste: "${Tt.message}".`)}}keydown(q){var ut;(ut=this.getActive())!=null&&ut.shouldGetKeyboardEvents()||mt._keyboardManager.exec(this,q)}onEditingAction(q){["undo","redo","delete","selectAll"].includes(q.name)&&this[q.name]()}setEditingState(q){q?(ht(this,a,xe).call(this),ht(this,N,we).call(this),ht(this,K,Wt).call(this,{isEditing:S(this,rt)!==m.AnnotationEditorType.NONE,isEmpty:ht(this,st,Qt).call(this),hasSomethingToUndo:S(this,C).hasSomethingToUndo(),hasSomethingToRedo:S(this,C).hasSomethingToRedo(),hasSelectedEditor:!1})):(ht(this,w,ae).call(this),ht(this,Y,ke).call(this),ht(this,K,Wt).call(this,{isEditing:!1}))}registerEditorTypes(q){if(!S(this,E)){_t(this,E,q);for(const ut of S(this,E))ht(this,i,Jt).call(this,ut.defaultPropertiesToUpdate)}}getId(){return S(this,Q).getId()}addLayer(q){S(this,_).set(q.pageIndex,q),S(this,ct)?q.enable():q.disable()}removeLayer(q){S(this,_).delete(q.pageIndex)}updateMode(q){if(_t(this,rt,q),q===m.AnnotationEditorType.NONE)this.setEditingState(!1),ht(this,M,Re).call(this);else{this.setEditingState(!0),ht(this,g,Fe).call(this);for(const ut of S(this,_).values())ut.updateMode(q)}}updateToolbar(q){q!==S(this,rt)&&S(this,T).dispatch("switchannotationeditormode",{source:this,mode:q})}updateParams(q,ut){if(!!S(this,E)){for(const St of S(this,V))St.updateParams(q,ut);for(const St of S(this,E))St.updateDefaultParams(q,ut)}}getEditors(q){const ut=[];for(const St of S(this,s).values())St.pageIndex===q&&ut.push(St);return ut}getEditor(q){return S(this,s).get(q)}addEditor(q){S(this,s).set(q.id,q)}removeEditor(q){S(this,s).delete(q.id),this.unselect(q)}setActiveEditor(q){S(this,t)!==q&&(_t(this,t,q),q&&ht(this,i,Jt).call(this,q.propertiesToUpdate))}toggleSelected(q){if(S(this,V).has(q)){S(this,V).delete(q),q.unselect(),ht(this,K,Wt).call(this,{hasSelectedEditor:this.hasSelection});return}S(this,V).add(q),q.select(),ht(this,i,Jt).call(this,q.propertiesToUpdate),ht(this,K,Wt).call(this,{hasSelectedEditor:!0})}setSelected(q){for(const ut of S(this,V))ut!==q&&ut.unselect();S(this,V).clear(),S(this,V).add(q),q.select(),ht(this,i,Jt).call(this,q.propertiesToUpdate),ht(this,K,Wt).call(this,{hasSelectedEditor:!0})}isSelected(q){return S(this,V).has(q)}unselect(q){q.unselect(),S(this,V).delete(q),ht(this,K,Wt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return S(this,V).size!==0}undo(){S(this,C).undo(),ht(this,K,Wt).call(this,{hasSomethingToUndo:S(this,C).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:ht(this,st,Qt).call(this)})}redo(){S(this,C).redo(),ht(this,K,Wt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:S(this,C).hasSomethingToRedo(),isEmpty:ht(this,st,Qt).call(this)})}addCommands(q){S(this,C).add(q),ht(this,K,Wt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:ht(this,st,Qt).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const q=[...S(this,V)],ut=()=>{for(const Tt of q)Tt.remove()},St=()=>{for(const Tt of q)ht(this,Z,oe).call(this,Tt)};this.addCommands({cmd:ut,undo:St,mustExec:!0})}commitOrRemove(){var q;(q=S(this,t))==null||q.commitOrRemove()}selectAll(){for(const q of S(this,V))q.commit();ht(this,B,le).call(this,S(this,s).values())}unselectAll(){if(S(this,t)){S(this,t).commitOrRemove();return}if(S(this,V).size!==0){for(const q of S(this,V))q.unselect();S(this,V).clear(),ht(this,K,Wt).call(this,{hasSelectedEditor:!1})}}isActive(q){return S(this,t)===q}getActive(){return S(this,t)}getMode(){return S(this,rt)}};let F=mt;t=new WeakMap,s=new WeakMap,_=new WeakMap,C=new WeakMap,D=new WeakMap,E=new WeakMap,T=new WeakMap,Q=new WeakMap,ct=new WeakMap,rt=new WeakMap,V=new WeakMap,W=new WeakMap,$=new WeakMap,tt=new WeakMap,nt=new WeakMap,ft=new WeakMap,bt=new WeakMap,I=new WeakMap,d=new WeakMap,a=new WeakSet,xe=function(){S(this,d).addEventListener("keydown",S(this,nt))},w=new WeakSet,ae=function(){S(this,d).removeEventListener("keydown",S(this,nt))},N=new WeakSet,we=function(){document.addEventListener("copy",S(this,W)),document.addEventListener("cut",S(this,$)),document.addEventListener("paste",S(this,tt))},Y=new WeakSet,ke=function(){document.removeEventListener("copy",S(this,W)),document.removeEventListener("cut",S(this,$)),document.removeEventListener("paste",S(this,tt))},K=new WeakSet,Wt=function(q){Object.entries(q).some(([St,Tt])=>S(this,I)[St]!==Tt)&&S(this,T).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(S(this,I),q)})},i=new WeakSet,Jt=function(q){S(this,T).dispatch("annotationeditorparamschanged",{source:this,details:q})},g=new WeakSet,Fe=function(){if(!S(this,ct)){_t(this,ct,!0);for(const q of S(this,_).values())q.enable()}},M=new WeakSet,Re=function(){if(this.unselectAll(),S(this,ct)){_t(this,ct,!1);for(const q of S(this,_).values())q.disable()}},Z=new WeakSet,oe=function(q){const ut=S(this,_).get(q.pageIndex);ut?ut.addOrRebuild(q):this.addEditor(q)},st=new WeakSet,Qt=function(){if(S(this,s).size===0)return!0;if(S(this,s).size===1)for(const q of S(this,s).values())return q.isEmpty();return!1},B=new WeakSet,le=function(q){S(this,V).clear();for(const ut of q)ut.isEmpty()||(S(this,V).add(ut),ut.select());ht(this,K,Wt).call(this,{hasSelectedEditor:!0})},It(F,"_keyboardManager",new v([[["ctrl+a","mac+meta+a"],mt.prototype.selectAll],[["ctrl+z","mac+meta+z"],mt.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],mt.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],mt.prototype.delete],[["Escape","mac+Escape"],mt.prototype.unselectAll]])),f.AnnotationEditorUIManager=F},(ot,f,J)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.StatTimer=f.RenderingCancelledException=f.PixelsPerInch=f.PageViewport=f.PDFDateString=f.DOMStandardFontDataFactory=f.DOMSVGFactory=f.DOMCanvasFactory=f.DOMCMapReaderFactory=f.AnnotationPrefix=void 0,f.deprecated=s,f.getColorValues=T,f.getCurrentTransform=Q,f.getCurrentTransformInverse=ct,f.getFilenameFromUrl=e,f.getPdfFilenameFromUrl=o,f.getRGB=E,f.getXfaPageViewport=D,f.isDataScheme=h,f.isPdfFile=n,f.isValidFetchUrl=l,f.loadScript=t;var m=J(7),x=J(1);const X="http://www.w3.org/2000/svg",z="pdfjs_internal_id_";f.AnnotationPrefix=z;const rt=class{};let G=rt;It(G,"CSS",96),It(G,"PDF",72),It(G,"PDF_TO_CSS_UNITS",rt.CSS/rt.PDF),f.PixelsPerInch=G;class j extends m.BaseCanvasFactory{constructor({ownerDocument:W=globalThis.document}={}){super(),this._document=W}_createCanvas(W,$){const tt=this._document.createElement("canvas");return tt.width=W,tt.height=$,tt}}f.DOMCanvasFactory=j;async function v(V,W=!1){if(l(V,document.baseURI)){const $=await fetch(V);if(!$.ok)throw new Error($.statusText);return W?new Uint8Array(await $.arrayBuffer()):(0,x.stringToBytes)(await $.text())}return new Promise(($,tt)=>{const nt=new XMLHttpRequest;nt.open("GET",V,!0),W&&(nt.responseType="arraybuffer"),nt.onreadystatechange=()=>{if(nt.readyState===XMLHttpRequest.DONE){if(nt.status===200||nt.status===0){let ft;if(W&&nt.response?ft=new Uint8Array(nt.response):!W&&nt.responseText&&(ft=(0,x.stringToBytes)(nt.responseText)),ft){$(ft);return}}tt(new Error(nt.statusText))}},nt.send(null)})}class y extends m.BaseCMapReaderFactory{_fetchData(W,$){return v(W,this.isCompressed).then(tt=>({cMapData:tt,compressionType:$}))}}f.DOMCMapReaderFactory=y;class F extends m.BaseStandardFontDataFactory{_fetchData(W){return v(W,!0)}}f.DOMStandardFontDataFactory=F;class A extends m.BaseSVGFactory{_createSVG(W){return document.createElementNS(X,W)}}f.DOMSVGFactory=A;class p{constructor({viewBox:W,scale:$,rotation:tt,offsetX:nt=0,offsetY:ft=0,dontFlip:bt=!1}){this.viewBox=W,this.scale=$,this.rotation=tt,this.offsetX=nt,this.offsetY=ft;const I=(W[2]+W[0])/2,d=(W[3]+W[1])/2;let a,b,w,L;switch(tt%=360,tt<0&&(tt+=360),tt){case 180:a=-1,b=0,w=0,L=1;break;case 90:a=0,b=1,w=1,L=0;break;case 270:a=0,b=-1,w=-1,L=0;break;case 0:a=1,b=0,w=0,L=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}bt&&(w=-w,L=-L);let N,H,Y,at;a===0?(N=Math.abs(d-W[1])*$+nt,H=Math.abs(I-W[0])*$+ft,Y=Math.abs(W[3]-W[1])*$,at=Math.abs(W[2]-W[0])*$):(N=Math.abs(I-W[0])*$+nt,H=Math.abs(d-W[1])*$+ft,Y=Math.abs(W[2]-W[0])*$,at=Math.abs(W[3]-W[1])*$),this.transform=[a*$,b*$,w*$,L*$,N-a*$*I-w*$*d,H-b*$*I-L*$*d],this.width=Y,this.height=at}clone({scale:W=this.scale,rotation:$=this.rotation,offsetX:tt=this.offsetX,offsetY:nt=this.offsetY,dontFlip:ft=!1}={}){return new p({viewBox:this.viewBox.slice(),scale:W,rotation:$,offsetX:tt,offsetY:nt,dontFlip:ft})}convertToViewportPoint(W,$){return x.Util.applyTransform([W,$],this.transform)}convertToViewportRectangle(W){const $=x.Util.applyTransform([W[0],W[1]],this.transform),tt=x.Util.applyTransform([W[2],W[3]],this.transform);return[$[0],$[1],tt[0],tt[1]]}convertToPdfPoint(W,$){return x.Util.applyInverseTransform([W,$],this.transform)}}f.PageViewport=p;class c extends x.BaseException{constructor(W,$){super(W,"RenderingCancelledException"),this.type=$}}f.RenderingCancelledException=c;function h(V){const W=V.length;let $=0;for(;$<W&&V[$].trim()==="";)$++;return V.substring($,$+5).toLowerCase()==="data:"}function n(V){return typeof V=="string"&&/\.pdf$/i.test(V)}function e(V){const W=V.indexOf("#"),$=V.indexOf("?"),tt=Math.min(W>0?W:V.length,$>0?$:V.length);return V.substring(V.lastIndexOf("/",tt)+1,tt)}function o(V,W="document.pdf"){if(typeof V!="string")return W;if(h(V))return(0,x.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),W;const $=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,tt=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,nt=$.exec(V);let ft=tt.exec(nt[1])||tt.exec(nt[2])||tt.exec(nt[3]);if(ft&&(ft=ft[0],ft.includes("%")))try{ft=tt.exec(decodeURIComponent(ft))[0]}catch{}return ft||W}class r{constructor(){this.started=Object.create(null),this.times=[]}time(W){W in this.started&&(0,x.warn)(`Timer is already running for ${W}`),this.started[W]=Date.now()}timeEnd(W){W in this.started||(0,x.warn)(`Timer has not been started for ${W}`),this.times.push({name:W,start:this.started[W],end:Date.now()}),delete this.started[W]}toString(){const W=[];let $=0;for(const tt of this.times){const nt=tt.name;nt.length>$&&($=nt.length)}for(const tt of this.times){const nt=tt.end-tt.start;W.push(`${tt.name.padEnd($)} ${nt}ms
`)}return W.join("")}}f.StatTimer=r;function l(V,W){try{const{protocol:$}=W?new URL(V,W):new URL(V);return $==="http:"||$==="https:"}catch{return!1}}function t(V,W=!1){return new Promise(($,tt)=>{const nt=document.createElement("script");nt.src=V,nt.onload=function(ft){W&&nt.remove(),$(ft)},nt.onerror=function(){tt(new Error(`Cannot load script at: ${nt.src}`))},(document.head||document.documentElement).append(nt)})}function s(V){console.log("Deprecated API usage: "+V)}let _;class C{static toDateObject(W){if(!W||typeof W!="string")return null;_||(_=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const $=_.exec(W);if(!$)return null;const tt=parseInt($[1],10);let nt=parseInt($[2],10);nt=nt>=1&&nt<=12?nt-1:0;let ft=parseInt($[3],10);ft=ft>=1&&ft<=31?ft:1;let bt=parseInt($[4],10);bt=bt>=0&&bt<=23?bt:0;let I=parseInt($[5],10);I=I>=0&&I<=59?I:0;let d=parseInt($[6],10);d=d>=0&&d<=59?d:0;const a=$[7]||"Z";let b=parseInt($[8],10);b=b>=0&&b<=23?b:0;let w=parseInt($[9],10)||0;return w=w>=0&&w<=59?w:0,a==="-"?(bt+=b,I+=w):a==="+"&&(bt-=b,I-=w),new Date(Date.UTC(tt,nt,ft,bt,I,d))}}f.PDFDateString=C;function D(V,{scale:W=1,rotation:$=0}){const{width:tt,height:nt}=V.attributes.style,ft=[0,0,parseInt(tt),parseInt(nt)];return new p({viewBox:ft,scale:W,rotation:$})}function E(V){if(V.startsWith("#")){const W=parseInt(V.slice(1),16);return[(W&16711680)>>16,(W&65280)>>8,W&255]}return V.startsWith("rgb(")?V.slice(4,-1).split(",").map(W=>parseInt(W)):V.startsWith("rgba(")?V.slice(5,-1).split(",").map(W=>parseInt(W)).slice(0,3):((0,x.warn)(`Not a valid color format: "${V}"`),[0,0,0])}function T(V){const W=document.createElement("span");W.style.visibility="hidden",document.body.append(W);for(const $ of V.keys()){W.style.color=$;const tt=window.getComputedStyle(W).color;V.set($,E(tt))}W.remove()}function Q(V){const{a:W,b:$,c:tt,d:nt,e:ft,f:bt}=V.getTransform();return[W,$,tt,nt,ft,bt]}function ct(V){const{a:W,b:$,c:tt,d:nt,e:ft,f:bt}=V.getTransform().invertSelf();return[W,$,tt,nt,ft,bt]}},(ot,f,J)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.BaseStandardFontDataFactory=f.BaseSVGFactory=f.BaseCanvasFactory=f.BaseCMapReaderFactory=void 0;var m=J(1);class x{constructor(){this.constructor===x&&(0,m.unreachable)("Cannot initialize BaseCanvasFactory.")}create(v,y){if(v<=0||y<=0)throw new Error("Invalid canvas size");const F=this._createCanvas(v,y);return{canvas:F,context:F.getContext("2d")}}reset(v,y,F){if(!v.canvas)throw new Error("Canvas is not specified");if(y<=0||F<=0)throw new Error("Invalid canvas size");v.canvas.width=y,v.canvas.height=F}destroy(v){if(!v.canvas)throw new Error("Canvas is not specified");v.canvas.width=0,v.canvas.height=0,v.canvas=null,v.context=null}_createCanvas(v,y){(0,m.unreachable)("Abstract method `_createCanvas` called.")}}f.BaseCanvasFactory=x;class X{constructor({baseUrl:v=null,isCompressed:y=!1}){this.constructor===X&&(0,m.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=v,this.isCompressed=y}async fetch({name:v}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!v)throw new Error("CMap name must be specified.");const y=this.baseUrl+v+(this.isCompressed?".bcmap":""),F=this.isCompressed?m.CMapCompressionType.BINARY:m.CMapCompressionType.NONE;return this._fetchData(y,F).catch(A=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${y}`)})}_fetchData(v,y){(0,m.unreachable)("Abstract method `_fetchData` called.")}}f.BaseCMapReaderFactory=X;class z{constructor({baseUrl:v=null}){this.constructor===z&&(0,m.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=v}async fetch({filename:v}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!v)throw new Error("Font filename must be specified.");const y=`${this.baseUrl}${v}`;return this._fetchData(y).catch(F=>{throw new Error(`Unable to load font data at: ${y}`)})}_fetchData(v){(0,m.unreachable)("Abstract method `_fetchData` called.")}}f.BaseStandardFontDataFactory=z;class G{constructor(){this.constructor===G&&(0,m.unreachable)("Cannot initialize BaseSVGFactory.")}create(v,y,F=!1){if(v<=0||y<=0)throw new Error("Invalid SVG dimensions");const A=this._createSVG("svg:svg");return A.setAttribute("version","1.1"),F||(A.setAttribute("width",`${v}px`),A.setAttribute("height",`${y}px`)),A.setAttribute("preserveAspectRatio","none"),A.setAttribute("viewBox",`0 0 ${v} ${y}`),A}createElement(v){if(typeof v!="string")throw new Error("Invalid SVG element type");return this._createSVG(v)}_createSVG(v){(0,m.unreachable)("Abstract method `_createSVG` called.")}}f.BaseSVGFactory=G},(ot,f,J)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.MurmurHash3_64=void 0;var m=J(1);const x=3285377520,X=4294901760,z=65535;class G{constructor(v){this.h1=v?v&4294967295:x,this.h2=v?v&4294967295:x}update(v){let y,F;if(typeof v=="string"){y=new Uint8Array(v.length*2),F=0;for(let _=0,C=v.length;_<C;_++){const D=v.charCodeAt(_);D<=255?y[F++]=D:(y[F++]=D>>>8,y[F++]=D&255)}}else if((0,m.isArrayBuffer)(v))y=v.slice(),F=y.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const A=F>>2,p=F-A*4,c=new Uint32Array(y.buffer,0,A);let h=0,n=0,e=this.h1,o=this.h2;const r=3432918353,l=461845907,t=r&z,s=l&z;for(let _=0;_<A;_++)_&1?(h=c[_],h=h*r&X|h*t&z,h=h<<15|h>>>17,h=h*l&X|h*s&z,e^=h,e=e<<13|e>>>19,e=e*5+3864292196):(n=c[_],n=n*r&X|n*t&z,n=n<<15|n>>>17,n=n*l&X|n*s&z,o^=n,o=o<<13|o>>>19,o=o*5+3864292196);switch(h=0,p){case 3:h^=y[A*4+2]<<16;case 2:h^=y[A*4+1]<<8;case 1:h^=y[A*4],h=h*r&X|h*t&z,h=h<<15|h>>>17,h=h*l&X|h*s&z,A&1?e^=h:o^=h}this.h1=e,this.h2=o}hexdigest(){let v=this.h1,y=this.h2;v^=y>>>1,v=v*3981806797&X|v*36045&z,y=y*4283543511&X|((y<<16|v>>>16)*2950163797&X)>>>16,v^=y>>>1,v=v*444984403&X|v*60499&z,y=y*3301882366&X|((y<<16|v>>>16)*3120437893&X)>>>16,v^=y>>>1;const F=(v>>>0).toString(16),A=(y>>>0).toString(16);return F.padStart(8,"0")+A.padStart(8,"0")}}f.MurmurHash3_64=G},(ot,f,J)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.FontLoader=f.FontFaceObject=void 0;var m=J(1);class x{constructor({onUnsupportedFeature:G,ownerDocument:j=globalThis.document,styleElement:v=null}){this._onUnsupportedFeature=G,this._document=j,this.nativeFontFaces=[],this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(G){this.nativeFontFaces.push(G),this._document.fonts.add(G)}insertRule(G){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const j=this.styleElement.sheet;j.insertRule(G,j.cssRules.length)}clear(){for(const G of this.nativeFontFaces)this._document.fonts.delete(G);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(G){if(G.attached||G.missingFile)return;if(G.attached=!0,this.isFontLoadingAPISupported){const v=G.createNativeFontFace();if(v){this.addNativeFontFace(v);try{await v.loaded}catch(y){throw this._onUnsupportedFeature({featureId:m.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,m.warn)(`Failed to load font '${v.family}': '${y}'.`),G.disableFontFace=!0,y}}return}const j=G.createFontFaceRule();if(j){if(this.insertRule(j),this.isSyncFontLoadingSupported)return;await new Promise(v=>{const y=this._queueLoadingCallback(v);this._prepareFontLoadEvent(G,y)})}}get isFontLoadingAPISupported(){var j;const G=!!((j=this._document)!=null&&j.fonts);return(0,m.shadow)(this,"isFontLoadingAPISupported",G)}get isSyncFontLoadingSupported(){let G=!1;if(typeof navigator>"u")G=!0;else{const j=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(j==null?void 0:j[1])>=14&&(G=!0)}return(0,m.shadow)(this,"isSyncFontLoadingSupported",G)}_queueLoadingCallback(G){function j(){for((0,m.assert)(!y.done,"completeRequest() cannot be called twice."),y.done=!0;v.length>0&&v[0].done;){const F=v.shift();setTimeout(F.callback,0)}}const{loadingRequests:v}=this,y={done:!1,complete:j,callback:G};return v.push(y),y}get _loadTestFont(){const G=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,m.shadow)(this,"_loadTestFont",G)}_prepareFontLoadEvent(G,j){function v(E,T){return E.charCodeAt(T)<<24|E.charCodeAt(T+1)<<16|E.charCodeAt(T+2)<<8|E.charCodeAt(T+3)&255}function y(E,T,Q,ct){const rt=E.substring(0,T),V=E.substring(T+Q);return rt+ct+V}let F,A;const p=this._document.createElement("canvas");p.width=1,p.height=1;const c=p.getContext("2d");let h=0;function n(E,T){if(++h>30){(0,m.warn)("Load test font never loaded."),T();return}if(c.font="30px "+E,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){T();return}setTimeout(n.bind(null,E,T))}const e=`lt${Date.now()}${this.loadTestFontId++}`;let o=this._loadTestFont;o=y(o,976,e.length,e);const l=16,t=1482184792;let s=v(o,l);for(F=0,A=e.length-3;F<A;F+=4)s=s-t+v(e,F)|0;F<e.length&&(s=s-t+v(e+"XXX",F)|0),o=y(o,l,4,(0,m.string32)(s));const _=`url(data:font/opentype;base64,${btoa(o)});`,C=`@font-face {font-family:"${e}";src:${_}}`;this.insertRule(C);const D=this._document.createElement("div");D.style.visibility="hidden",D.style.width=D.style.height="10px",D.style.position="absolute",D.style.top=D.style.left="0px";for(const E of[G.loadedName,e]){const T=this._document.createElement("span");T.textContent="Hi",T.style.fontFamily=E,D.append(T)}this._document.body.append(D),n(e,()=>{D.remove(),j.complete()})}}f.FontLoader=x;class X{constructor(G,{isEvalSupported:j=!0,disableFontFace:v=!1,ignoreErrors:y=!1,onUnsupportedFeature:F,fontRegistry:A=null}){this.compiledGlyphs=Object.create(null);for(const p in G)this[p]=G[p];this.isEvalSupported=j!==!1,this.disableFontFace=v===!0,this.ignoreErrors=y===!0,this._onUnsupportedFeature=F,this.fontRegistry=A}createNativeFontFace(){var j;if(!this.data||this.disableFontFace)return null;let G;if(!this.cssFontInfo)G=new FontFace(this.loadedName,this.data,{});else{const v={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(v.style=`oblique ${this.cssFontInfo.italicAngle}deg`),G=new FontFace(this.cssFontInfo.fontFamily,this.data,v)}return(j=this.fontRegistry)==null||j.registerFont(this),G}createFontFaceRule(){var y;if(!this.data||this.disableFontFace)return null;const G=(0,m.bytesToString)(this.data),j=`url(data:${this.mimetype};base64,${btoa(G)});`;let v;if(!this.cssFontInfo)v=`@font-face {font-family:"${this.loadedName}";src:${j}}`;else{let F=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(F+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),v=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${F}src:${j}}`}return(y=this.fontRegistry)==null||y.registerFont(this,j),v}getPathGenerator(G,j){if(this.compiledGlyphs[j]!==void 0)return this.compiledGlyphs[j];let v;try{v=G.get(this.loadedName+"_path_"+j)}catch(y){if(!this.ignoreErrors)throw y;return this._onUnsupportedFeature({featureId:m.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,m.warn)(`getPathGenerator - ignoring character: "${y}".`),this.compiledGlyphs[j]=function(F,A){}}if(this.isEvalSupported&&m.FeatureTest.isEvalSupported){const y=[];for(const F of v){const A=F.args!==void 0?F.args.join(","):"";y.push("c.",F.cmd,"(",A,`);
`)}return this.compiledGlyphs[j]=new Function("c","size",y.join(""))}return this.compiledGlyphs[j]=function(y,F){for(const A of v)A.cmd==="scale"&&(A.args=[F,-F]),y[A.cmd].apply(y,A.args)}}}f.FontFaceObject=X},(ot,f,J)=>{var nt,ce;Object.defineProperty(f,"__esModule",{value:!0}),f.CanvasGraphics=void 0;var m=J(1),x=J(6),X=J(11),z=J(13),G=J(12);const j=16,v=100,y=4096,F=15,A=10,p=G.isNodeJS&&typeof Path2D>"u"?-1:1e3,c=16;function h(I,d){if(I._removeMirroring)throw new Error("Context is already forwarding operations.");I.__originalSave=I.save,I.__originalRestore=I.restore,I.__originalRotate=I.rotate,I.__originalScale=I.scale,I.__originalTranslate=I.translate,I.__originalTransform=I.transform,I.__originalSetTransform=I.setTransform,I.__originalResetTransform=I.resetTransform,I.__originalClip=I.clip,I.__originalMoveTo=I.moveTo,I.__originalLineTo=I.lineTo,I.__originalBezierCurveTo=I.bezierCurveTo,I.__originalRect=I.rect,I.__originalClosePath=I.closePath,I.__originalBeginPath=I.beginPath,I._removeMirroring=()=>{I.save=I.__originalSave,I.restore=I.__originalRestore,I.rotate=I.__originalRotate,I.scale=I.__originalScale,I.translate=I.__originalTranslate,I.transform=I.__originalTransform,I.setTransform=I.__originalSetTransform,I.resetTransform=I.__originalResetTransform,I.clip=I.__originalClip,I.moveTo=I.__originalMoveTo,I.lineTo=I.__originalLineTo,I.bezierCurveTo=I.__originalBezierCurveTo,I.rect=I.__originalRect,I.closePath=I.__originalClosePath,I.beginPath=I.__originalBeginPath,delete I._removeMirroring},I.save=function(){d.save(),this.__originalSave()},I.restore=function(){d.restore(),this.__originalRestore()},I.translate=function(b,w){d.translate(b,w),this.__originalTranslate(b,w)},I.scale=function(b,w){d.scale(b,w),this.__originalScale(b,w)},I.transform=function(b,w,L,N,H,Y){d.transform(b,w,L,N,H,Y),this.__originalTransform(b,w,L,N,H,Y)},I.setTransform=function(b,w,L,N,H,Y){d.setTransform(b,w,L,N,H,Y),this.__originalSetTransform(b,w,L,N,H,Y)},I.resetTransform=function(){d.resetTransform(),this.__originalResetTransform()},I.rotate=function(b){d.rotate(b),this.__originalRotate(b)},I.clip=function(b){d.clip(b),this.__originalClip(b)},I.moveTo=function(a,b){d.moveTo(a,b),this.__originalMoveTo(a,b)},I.lineTo=function(a,b){d.lineTo(a,b),this.__originalLineTo(a,b)},I.bezierCurveTo=function(a,b,w,L,N,H){d.bezierCurveTo(a,b,w,L,N,H),this.__originalBezierCurveTo(a,b,w,L,N,H)},I.rect=function(a,b,w,L){d.rect(a,b,w,L),this.__originalRect(a,b,w,L)},I.closePath=function(){d.closePath(),this.__originalClosePath()},I.beginPath=function(){d.beginPath(),this.__originalBeginPath()}}class n{constructor(d){this.canvasFactory=d,this.cache=Object.create(null)}getCanvas(d,a,b){let w;return this.cache[d]!==void 0?(w=this.cache[d],this.canvasFactory.reset(w,a,b)):(w=this.canvasFactory.create(a,b),this.cache[d]=w),w}delete(d){delete this.cache[d]}clear(){for(const d in this.cache){const a=this.cache[d];this.canvasFactory.destroy(a),delete this.cache[d]}}}function e(I,d,a,b,w,L,N,H,Y,at){const[K,et,i,u,g,P]=(0,x.getCurrentTransform)(I);if(et===0&&i===0){const Z=N*K+g,lt=Math.round(Z),st=H*u+P,gt=Math.round(st),B=(N+Y)*K+g,pt=Math.abs(Math.round(B)-lt)||1,mt=(H+at)*u+P,yt=Math.abs(Math.round(mt)-gt)||1;return I.setTransform(Math.sign(K),0,0,Math.sign(u),lt,gt),I.drawImage(d,a,b,w,L,0,0,pt,yt),I.setTransform(K,et,i,u,g,P),[pt,yt]}if(K===0&&u===0){const Z=H*i+g,lt=Math.round(Z),st=N*et+P,gt=Math.round(st),B=(H+at)*i+g,pt=Math.abs(Math.round(B)-lt)||1,mt=(N+Y)*et+P,yt=Math.abs(Math.round(mt)-gt)||1;return I.setTransform(0,Math.sign(et),Math.sign(i),0,lt,gt),I.drawImage(d,a,b,w,L,0,0,yt,pt),I.setTransform(K,et,i,u,g,P),[yt,pt]}I.drawImage(d,a,b,w,L,N,H,Y,at);const M=Math.hypot(K,et),U=Math.hypot(i,u);return[M*Y,U*at]}function o(I){const{width:d,height:a}=I;if(d>p||a>p)return null;const b=1e3,w=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),L=d+1;let N=new Uint8Array(L*(a+1)),H,Y,at;const K=d+7&-8;let et=new Uint8Array(K*a),i=0;for(const U of I.data){let Z=128;for(;Z>0;)et[i++]=U&Z?0:255,Z>>=1}let u=0;for(i=0,et[i]!==0&&(N[0]=1,++u),Y=1;Y<d;Y++)et[i]!==et[i+1]&&(N[Y]=et[i]?2:1,++u),i++;for(et[i]!==0&&(N[Y]=2,++u),H=1;H<a;H++){i=H*K,at=H*L,et[i-K]!==et[i]&&(N[at]=et[i]?1:8,++u);let U=(et[i]?4:0)+(et[i-K]?8:0);for(Y=1;Y<d;Y++)U=(U>>2)+(et[i+1]?4:0)+(et[i-K+1]?8:0),w[U]&&(N[at+Y]=w[U],++u),i++;if(et[i-K]!==et[i]&&(N[at+Y]=et[i]?2:4,++u),u>b)return null}for(i=K*(a-1),at=H*L,et[i]!==0&&(N[at]=8,++u),Y=1;Y<d;Y++)et[i]!==et[i+1]&&(N[at+Y]=et[i]?4:8,++u),i++;if(et[i]!==0&&(N[at+Y]=4,++u),u>b)return null;const g=new Int32Array([0,L,-1,0,-L,0,0,0,1]),P=new Path2D;for(H=0;u&&H<=a;H++){let U=H*L;const Z=U+d;for(;U<Z&&!N[U];)U++;if(U===Z)continue;P.moveTo(U%L,H);const lt=U;let st=N[U];do{const gt=g[st];do U+=gt;while(!N[U]);const B=N[U];B!==5&&B!==10?(st=B,N[U]=0):(st=B&51*st>>4,N[U]&=st>>2|st<<2),P.lineTo(U%L,U/L|0),N[U]||--u}while(lt!==U);--H}return et=null,N=null,function(U){U.save(),U.scale(1/d,-1/a),U.translate(0,-a),U.fill(P),U.beginPath(),U.restore()}}class r{constructor(d,a){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=m.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=m.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=m.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,d,a])}clone(){const d=Object.create(this);return d.clipBox=this.clipBox.slice(),d}setCurrentPoint(d,a){this.x=d,this.y=a}updatePathMinMax(d,a,b){[a,b]=m.Util.applyTransform([a,b],d),this.minX=Math.min(this.minX,a),this.minY=Math.min(this.minY,b),this.maxX=Math.max(this.maxX,a),this.maxY=Math.max(this.maxY,b)}updateRectMinMax(d,a){const b=m.Util.applyTransform(a,d),w=m.Util.applyTransform(a.slice(2),d);this.minX=Math.min(this.minX,b[0],w[0]),this.minY=Math.min(this.minY,b[1],w[1]),this.maxX=Math.max(this.maxX,b[0],w[0]),this.maxY=Math.max(this.maxY,b[1],w[1])}updateScalingPathMinMax(d,a){m.Util.scaleMinMax(d,a),this.minX=Math.min(this.minX,a[0]),this.maxX=Math.max(this.maxX,a[1]),this.minY=Math.min(this.minY,a[2]),this.maxY=Math.max(this.maxY,a[3])}updateCurvePathMinMax(d,a,b,w,L,N,H,Y,at,K){const et=m.Util.bezierBoundingBox(a,b,w,L,N,H,Y,at);if(K){K[0]=Math.min(K[0],et[0],et[2]),K[1]=Math.max(K[1],et[0],et[2]),K[2]=Math.min(K[2],et[1],et[3]),K[3]=Math.max(K[3],et[1],et[3]);return}this.updateRectMinMax(d,et)}getPathBoundingBox(d=X.PathType.FILL,a=null){const b=[this.minX,this.minY,this.maxX,this.maxY];if(d===X.PathType.STROKE){a||(0,m.unreachable)("Stroke bounding box must include transform.");const w=m.Util.singularValueDecompose2dScale(a),L=w[0]*this.lineWidth/2,N=w[1]*this.lineWidth/2;b[0]-=L,b[1]-=N,b[2]+=L,b[3]+=N}return b}updateClipFromPath(){const d=m.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(d||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(d){this.clipBox=d,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(d=X.PathType.FILL,a=null){return m.Util.intersect(this.clipBox,this.getPathBoundingBox(d,a))}}function l(I,d,a=null){if(typeof ImageData<"u"&&d instanceof ImageData){I.putImageData(d,0,0);return}const b=d.height,w=d.width,L=b%c,N=(b-L)/c,H=L===0?N:N+1,Y=I.createImageData(w,c);let at=0,K;const et=d.data,i=Y.data;let u,g,P,M,U,Z,lt,st;if(a)switch(a.length){case 1:U=a[0],Z=a[0],lt=a[0],st=a[0];break;case 4:U=a[0],Z=a[1],lt=a[2],st=a[3];break}if(d.kind===m.ImageKind.GRAYSCALE_1BPP){const gt=et.byteLength,B=new Uint32Array(i.buffer,0,i.byteLength>>2),pt=B.length,mt=w+7>>3;let yt=4294967295,q=m.FeatureTest.isLittleEndian?4278190080:255;for(st&&st[0]===255&&st[255]===0&&([yt,q]=[q,yt]),u=0;u<H;u++){for(P=u<N?c:L,K=0,g=0;g<P;g++){const ut=gt-at;let St=0;const Tt=ut>mt?w:ut*8-7,Ft=Tt&-8;let kt=0,Ct=0;for(;St<Ft;St+=8)Ct=et[at++],B[K++]=Ct&128?yt:q,B[K++]=Ct&64?yt:q,B[K++]=Ct&32?yt:q,B[K++]=Ct&16?yt:q,B[K++]=Ct&8?yt:q,B[K++]=Ct&4?yt:q,B[K++]=Ct&2?yt:q,B[K++]=Ct&1?yt:q;for(;St<Tt;St++)kt===0&&(Ct=et[at++],kt=128),B[K++]=Ct&kt?yt:q,kt>>=1}for(;K<pt;)B[K++]=0;I.putImageData(Y,0,u*c)}}else if(d.kind===m.ImageKind.RGBA_32BPP){const gt=!!(U||Z||lt);for(g=0,M=w*c*4,u=0;u<N;u++){if(i.set(et.subarray(at,at+M)),at+=M,gt)for(let B=0;B<M;B+=4)U&&(i[B+0]=U[i[B+0]]),Z&&(i[B+1]=Z[i[B+1]]),lt&&(i[B+2]=lt[i[B+2]]);I.putImageData(Y,0,g),g+=c}if(u<H){if(M=w*L*4,i.set(et.subarray(at,at+M)),gt)for(let B=0;B<M;B+=4)U&&(i[B+0]=U[i[B+0]]),Z&&(i[B+1]=Z[i[B+1]]),lt&&(i[B+2]=lt[i[B+2]]);I.putImageData(Y,0,g)}}else if(d.kind===m.ImageKind.RGB_24BPP){const gt=!!(U||Z||lt);for(P=c,M=w*P,u=0;u<H;u++){for(u>=N&&(P=L,M=w*P),K=0,g=M;g--;)i[K++]=et[at++],i[K++]=et[at++],i[K++]=et[at++],i[K++]=255;if(gt)for(let B=0;B<K;B+=4)U&&(i[B+0]=U[i[B+0]]),Z&&(i[B+1]=Z[i[B+1]]),lt&&(i[B+2]=lt[i[B+2]]);I.putImageData(Y,0,u*c)}}else throw new Error(`bad image kind: ${d.kind}`)}function t(I,d){if(d.bitmap){I.drawImage(d.bitmap,0,0);return}const a=d.height,b=d.width,w=a%c,L=(a-w)/c,N=w===0?L:L+1,H=I.createImageData(b,c);let Y=0;const at=d.data,K=H.data;for(let et=0;et<N;et++){const i=et<L?c:w;({srcPos:Y}=(0,z.applyMaskImageData)({src:at,srcPos:Y,dest:K,width:b,height:i})),I.putImageData(H,0,et*c)}}function s(I,d){const a=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(const b of a)I[b]!==void 0&&(d[b]=I[b]);I.setLineDash!==void 0&&(d.setLineDash(I.getLineDash()),d.lineDashOffset=I.lineDashOffset)}function _(I,d){I.strokeStyle=I.fillStyle=d||"#000000",I.fillRule="nonzero",I.globalAlpha=1,I.lineWidth=1,I.lineCap="butt",I.lineJoin="miter",I.miterLimit=10,I.globalCompositeOperation="source-over",I.font="10px sans-serif",I.setLineDash!==void 0&&(I.setLineDash([]),I.lineDashOffset=0)}function C(I,d,a,b){const w=I.length;for(let L=3;L<w;L+=4){const N=I[L];if(N===0)I[L-3]=d,I[L-2]=a,I[L-1]=b;else if(N<255){const H=255-N;I[L-3]=I[L-3]*N+d*H>>8,I[L-2]=I[L-2]*N+a*H>>8,I[L-1]=I[L-1]*N+b*H>>8}}}function D(I,d,a){const b=I.length,w=1/255;for(let L=3;L<b;L+=4){const N=a?a[I[L]]:I[L];d[L]=d[L]*N*w|0}}function E(I,d,a){const b=I.length;for(let w=3;w<b;w+=4){const L=I[w-3]*77+I[w-2]*152+I[w-1]*28;d[w]=a?d[w]*a[L>>8]>>8:d[w]*L>>16}}function T(I,d,a,b,w,L,N,H,Y,at,K){const et=!!L,i=et?L[0]:0,u=et?L[1]:0,g=et?L[2]:0;let P;w==="Luminosity"?P=E:P=D;const U=Math.min(b,Math.ceil(1048576/a));for(let Z=0;Z<b;Z+=U){const lt=Math.min(U,b-Z),st=I.getImageData(H-at,Z+(Y-K),a,lt),gt=d.getImageData(H,Z+Y,a,lt);et&&C(st.data,i,u,g),P(st.data,gt.data,N),d.putImageData(gt,H,Z+Y)}}function Q(I,d,a,b){const w=b[0],L=b[1],N=b[2]-w,H=b[3]-L;N===0||H===0||(T(d.context,a,N,H,d.subtype,d.backdrop,d.transferMap,w,L,d.offsetX,d.offsetY),I.save(),I.globalAlpha=1,I.globalCompositeOperation="source-over",I.setTransform(1,0,0,1,0,0),I.drawImage(a.canvas,0,0),I.restore())}function ct(I,d){const a=m.Util.singularValueDecompose2dScale(I);a[0]=Math.fround(a[0]),a[1]=Math.fround(a[1]);const b=Math.fround((globalThis.devicePixelRatio||1)*x.PixelsPerInch.PDF_TO_CSS_UNITS);return d!==void 0?d:a[0]<=b||a[1]<=b}const rt=["butt","round","square"],V=["miter","round","bevel"],W={},$={},bt=class{constructor(d,a,b,w,L,N,H){it(this,nt);this.ctx=d,this.current=new r(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=a,this.objs=b,this.canvasFactory=w,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=L,this.cachedCanvases=new n(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=N,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(H==null?void 0:H.background)||null,this.foregroundColor=(H==null?void 0:H.foreground)||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(d,a=null){return typeof d=="string"?d.startsWith("g_")?this.commonObjs.get(d):this.objs.get(d):a}beginDrawing({transform:d,viewport:a,transparency:b=!1,background:w=null}){const L=this.ctx.canvas.width,N=this.ctx.canvas.height,H=w||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const Y=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const at=this.backgroundColor=this.ctx.fillStyle;let K=!0,et=H;if(this.ctx.fillStyle=H,et=this.ctx.fillStyle,K=typeof et=="string"&&/^#[0-9A-Fa-f]{6}$/.test(et),Y==="#000000"&&at==="#ffffff"||Y===at||!K)this.foregroundColor=this.backgroundColor=null;else{const[i,u,g]=(0,x.getRGB)(et),P=U=>(U/=255,U<=.03928?U/12.92:((U+.055)/1.055)**2.4),M=Math.round(.2126*P(i)+.7152*P(u)+.0722*P(g));this.selectColor=(U,Z,lt)=>{const st=.2126*P(U)+.7152*P(Z)+.0722*P(lt);return Math.round(st)===M?at:Y}}}if(this.ctx.fillStyle=this.backgroundColor||H,this.ctx.fillRect(0,0,L,N),this.ctx.restore(),b){const Y=this.cachedCanvases.getCanvas("transparent",L,N);this.compositeCtx=this.ctx,this.transparentCanvas=Y.canvas,this.ctx=Y.context,this.ctx.save(),this.ctx.transform(...(0,x.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),_(this.ctx,this.foregroundColor),d&&(this.ctx.transform(...d),this.outputScaleX=d[0],this.outputScaleY=d[0]),this.ctx.transform(...a.transform),this.viewportScale=a.scale,this.baseTransform=(0,x.getCurrentTransform)(this.ctx)}executeOperatorList(d,a,b,w){const L=d.argsArray,N=d.fnArray;let H=a||0;const Y=L.length;if(Y===H)return H;const at=Y-H>A&&typeof b=="function",K=at?Date.now()+F:0;let et=0;const i=this.commonObjs,u=this.objs;let g;for(;;){if(w!==void 0&&H===w.nextBreakPoint)return w.breakIt(H,b),H;if(g=N[H],g!==m.OPS.dependency)this[g].apply(this,L[H]);else for(const P of L[H]){const M=P.startsWith("g_")?i:u;if(!M.has(P))return M.get(P,b),H}if(H++,H===Y)return H;if(at&&++et>A){if(Date.now()>K)return b(),H;et=0}}}endDrawing(){ht(this,nt,ce).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const d of this._cachedBitmapsMap.values()){for(const a of d.values())typeof HTMLCanvasElement<"u"&&a instanceof HTMLCanvasElement&&(a.width=a.height=0);d.clear()}this._cachedBitmapsMap.clear()}_scaleImage(d,a){const b=d.width,w=d.height;let L=Math.max(Math.hypot(a[0],a[1]),1),N=Math.max(Math.hypot(a[2],a[3]),1),H=b,Y=w,at="prescale1",K,et;for(;L>2&&H>1||N>2&&Y>1;){let i=H,u=Y;L>2&&H>1&&(i=Math.ceil(H/2),L/=H/i),N>2&&Y>1&&(u=Math.ceil(Y/2),N/=Y/u),K=this.cachedCanvases.getCanvas(at,i,u),et=K.context,et.clearRect(0,0,i,u),et.drawImage(d,0,0,H,Y,0,0,i,u),d=K.canvas,H=i,Y=u,at=at==="prescale1"?"prescale2":"prescale1"}return{img:d,paintWidth:H,paintHeight:Y}}_createMaskCanvas(d){const a=this.ctx,{width:b,height:w}=d,L=this.current.fillColor,N=this.current.patternFill,H=(0,x.getCurrentTransform)(a);let Y,at,K,et;if((d.bitmap||d.data)&&d.count>1){const pt=d.bitmap||d.data.buffer;at=JSON.stringify(N?H:[H.slice(0,4),L]),Y=this._cachedBitmapsMap.get(pt),Y||(Y=new Map,this._cachedBitmapsMap.set(pt,Y));const mt=Y.get(at);if(mt&&!N){const yt=Math.round(Math.min(H[0],H[2])+H[4]),q=Math.round(Math.min(H[1],H[3])+H[5]);return{canvas:mt,offsetX:yt,offsetY:q}}K=mt}K||(et=this.cachedCanvases.getCanvas("maskCanvas",b,w),t(et.context,d));let i=m.Util.transform(H,[1/b,0,0,-1/w,0,0]);i=m.Util.transform(i,[1,0,0,1,0,-w]);const u=m.Util.applyTransform([0,0],i),g=m.Util.applyTransform([b,w],i),P=m.Util.normalizeRect([u[0],u[1],g[0],g[1]]),M=Math.round(P[2]-P[0])||1,U=Math.round(P[3]-P[1])||1,Z=this.cachedCanvases.getCanvas("fillCanvas",M,U),lt=Z.context,st=Math.min(u[0],g[0]),gt=Math.min(u[1],g[1]);lt.translate(-st,-gt),lt.transform(...i),K||(K=this._scaleImage(et.canvas,(0,x.getCurrentTransformInverse)(lt)),K=K.img,Y&&N&&Y.set(at,K)),lt.imageSmoothingEnabled=ct((0,x.getCurrentTransform)(lt),d.interpolate),e(lt,K,0,0,K.width,K.height,0,0,b,w),lt.globalCompositeOperation="source-in";const B=m.Util.transform((0,x.getCurrentTransformInverse)(lt),[1,0,0,1,-st,-gt]);return lt.fillStyle=N?L.getPattern(a,this,B,X.PathType.FILL):L,lt.fillRect(0,0,b,w),Y&&!N&&(this.cachedCanvases.delete("fillCanvas"),Y.set(at,Z.canvas)),{canvas:Z.canvas,offsetX:Math.round(st),offsetY:Math.round(gt)}}setLineWidth(d){d!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=d,this.ctx.lineWidth=d}setLineCap(d){this.ctx.lineCap=rt[d]}setLineJoin(d){this.ctx.lineJoin=V[d]}setMiterLimit(d){this.ctx.miterLimit=d}setDash(d,a){const b=this.ctx;b.setLineDash!==void 0&&(b.setLineDash(d),b.lineDashOffset=a)}setRenderingIntent(d){}setFlatness(d){}setGState(d){for(const[a,b]of d)switch(a){case"LW":this.setLineWidth(b);break;case"LC":this.setLineCap(b);break;case"LJ":this.setLineJoin(b);break;case"ML":this.setMiterLimit(b);break;case"D":this.setDash(b[0],b[1]);break;case"RI":this.setRenderingIntent(b);break;case"FL":this.setFlatness(b);break;case"Font":this.setFont(b[0],b[1]);break;case"CA":this.current.strokeAlpha=b;break;case"ca":this.current.fillAlpha=b,this.ctx.globalAlpha=b;break;case"BM":this.ctx.globalCompositeOperation=b;break;case"SMask":this.current.activeSMask=b?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=b}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const d=this.inSMaskMode;this.current.activeSMask&&!d?this.beginSMaskMode():!this.current.activeSMask&&d&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const d=this.ctx.canvas.width,a=this.ctx.canvas.height,b="smaskGroupAt"+this.groupLevel,w=this.cachedCanvases.getCanvas(b,d,a);this.suspendedCtx=this.ctx,this.ctx=w.context;const L=this.ctx;L.setTransform(...(0,x.getCurrentTransform)(this.suspendedCtx)),s(this.suspendedCtx,L),h(L,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),s(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(d){if(!this.current.activeSMask)return;d?(d[0]=Math.floor(d[0]),d[1]=Math.floor(d[1]),d[2]=Math.ceil(d[2]),d[3]=Math.ceil(d[3])):d=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const a=this.current.activeSMask,b=this.suspendedCtx;Q(b,a,this.ctx,d),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(s(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const d=this.current;this.stateStack.push(d),this.current=d.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),s(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(d,a,b,w,L,N){this.ctx.transform(d,a,b,w,L,N),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(d,a,b){const w=this.ctx,L=this.current;let N=L.x,H=L.y,Y,at;const K=(0,x.getCurrentTransform)(w),et=K[0]===0&&K[3]===0||K[1]===0&&K[2]===0,i=et?b.slice(0):null;for(let u=0,g=0,P=d.length;u<P;u++)switch(d[u]|0){case m.OPS.rectangle:N=a[g++],H=a[g++];const M=a[g++],U=a[g++],Z=N+M,lt=H+U;w.moveTo(N,H),M===0||U===0?w.lineTo(Z,lt):(w.lineTo(Z,H),w.lineTo(Z,lt),w.lineTo(N,lt)),et||L.updateRectMinMax(K,[N,H,Z,lt]),w.closePath();break;case m.OPS.moveTo:N=a[g++],H=a[g++],w.moveTo(N,H),et||L.updatePathMinMax(K,N,H);break;case m.OPS.lineTo:N=a[g++],H=a[g++],w.lineTo(N,H),et||L.updatePathMinMax(K,N,H);break;case m.OPS.curveTo:Y=N,at=H,N=a[g+4],H=a[g+5],w.bezierCurveTo(a[g],a[g+1],a[g+2],a[g+3],N,H),L.updateCurvePathMinMax(K,Y,at,a[g],a[g+1],a[g+2],a[g+3],N,H,i),g+=6;break;case m.OPS.curveTo2:Y=N,at=H,w.bezierCurveTo(N,H,a[g],a[g+1],a[g+2],a[g+3]),L.updateCurvePathMinMax(K,Y,at,N,H,a[g],a[g+1],a[g+2],a[g+3],i),N=a[g+2],H=a[g+3],g+=4;break;case m.OPS.curveTo3:Y=N,at=H,N=a[g+2],H=a[g+3],w.bezierCurveTo(a[g],a[g+1],N,H,N,H),L.updateCurvePathMinMax(K,Y,at,a[g],a[g+1],N,H,N,H,i),g+=4;break;case m.OPS.closePath:w.closePath();break}et&&L.updateScalingPathMinMax(K,i),L.setCurrentPoint(N,H)}closePath(){this.ctx.closePath()}stroke(d){d=typeof d<"u"?d:!0;const a=this.ctx,b=this.current.strokeColor;a.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof b=="object"&&(b==null?void 0:b.getPattern)?(a.save(),a.strokeStyle=b.getPattern(a,this,(0,x.getCurrentTransformInverse)(a),X.PathType.STROKE),this.rescaleAndStroke(!1),a.restore()):this.rescaleAndStroke(!0)),d&&this.consumePath(this.current.getClippedPathBoundingBox()),a.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(d){d=typeof d<"u"?d:!0;const a=this.ctx,b=this.current.fillColor,w=this.current.patternFill;let L=!1;w&&(a.save(),a.fillStyle=b.getPattern(a,this,(0,x.getCurrentTransformInverse)(a),X.PathType.FILL),L=!0);const N=this.current.getClippedPathBoundingBox();this.contentVisible&&N!==null&&(this.pendingEOFill?(a.fill("evenodd"),this.pendingEOFill=!1):a.fill()),L&&a.restore(),d&&this.consumePath(N)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=W}eoClip(){this.pendingClip=$}beginText(){this.current.textMatrix=m.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const d=this.pendingTextPaths,a=this.ctx;if(d===void 0){a.beginPath();return}a.save(),a.beginPath();for(const b of d)a.setTransform(...b.transform),a.translate(b.x,b.y),b.addToPath(a,b.fontSize);a.restore(),a.clip(),a.beginPath(),delete this.pendingTextPaths}setCharSpacing(d){this.current.charSpacing=d}setWordSpacing(d){this.current.wordSpacing=d}setHScale(d){this.current.textHScale=d/100}setLeading(d){this.current.leading=-d}setFont(d,a){const b=this.commonObjs.get(d),w=this.current;if(!b)throw new Error(`Can't find font for ${d}`);if(w.fontMatrix=b.fontMatrix||m.FONT_IDENTITY_MATRIX,(w.fontMatrix[0]===0||w.fontMatrix[3]===0)&&(0,m.warn)("Invalid font matrix for font "+d),a<0?(a=-a,w.fontDirection=-1):w.fontDirection=1,this.current.font=b,this.current.fontSize=a,b.isType3Font)return;const L=b.loadedName||"sans-serif";let N="normal";b.black?N="900":b.bold&&(N="bold");const H=b.italic?"italic":"normal",Y=`"${L}", ${b.fallbackName}`;let at=a;a<j?at=j:a>v&&(at=v),this.current.fontSizeScale=a/at,this.ctx.font=`${H} ${N} ${at}px ${Y}`}setTextRenderingMode(d){this.current.textRenderingMode=d}setTextRise(d){this.current.textRise=d}moveText(d,a){this.current.x=this.current.lineX+=d,this.current.y=this.current.lineY+=a}setLeadingMoveText(d,a){this.setLeading(-a),this.moveText(d,a)}setTextMatrix(d,a,b,w,L,N){this.current.textMatrix=[d,a,b,w,L,N],this.current.textMatrixScale=Math.hypot(d,a),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(d,a,b,w){const L=this.ctx,N=this.current,H=N.font,Y=N.textRenderingMode,at=N.fontSize/N.fontSizeScale,K=Y&m.TextRenderingMode.FILL_STROKE_MASK,et=!!(Y&m.TextRenderingMode.ADD_TO_PATH_FLAG),i=N.patternFill&&!H.missingFile;let u;(H.disableFontFace||et||i)&&(u=H.getPathGenerator(this.commonObjs,d)),H.disableFontFace||i?(L.save(),L.translate(a,b),L.beginPath(),u(L,at),w&&L.setTransform(...w),(K===m.TextRenderingMode.FILL||K===m.TextRenderingMode.FILL_STROKE)&&L.fill(),(K===m.TextRenderingMode.STROKE||K===m.TextRenderingMode.FILL_STROKE)&&L.stroke(),L.restore()):((K===m.TextRenderingMode.FILL||K===m.TextRenderingMode.FILL_STROKE)&&L.fillText(d,a,b),(K===m.TextRenderingMode.STROKE||K===m.TextRenderingMode.FILL_STROKE)&&L.strokeText(d,a,b)),et&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,x.getCurrentTransform)(L),x:a,y:b,fontSize:at,addToPath:u})}get isFontSubpixelAAEnabled(){const{context:d}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);d.scale(1.5,1),d.fillText("I",0,10);const a=d.getImageData(0,0,10,10).data;let b=!1;for(let w=3;w<a.length;w+=4)if(a[w]>0&&a[w]<255){b=!0;break}return(0,m.shadow)(this,"isFontSubpixelAAEnabled",b)}showText(d){const a=this.current,b=a.font;if(b.isType3Font)return this.showType3Text(d);const w=a.fontSize;if(w===0)return;const L=this.ctx,N=a.fontSizeScale,H=a.charSpacing,Y=a.wordSpacing,at=a.fontDirection,K=a.textHScale*at,et=d.length,i=b.vertical,u=i?1:-1,g=b.defaultVMetrics,P=w*a.fontMatrix[0],M=a.textRenderingMode===m.TextRenderingMode.FILL&&!b.disableFontFace&&!a.patternFill;L.save(),L.transform(...a.textMatrix),L.translate(a.x,a.y+a.textRise),at>0?L.scale(K,-1):L.scale(K,1);let U;if(a.patternFill){L.save();const B=a.fillColor.getPattern(L,this,(0,x.getCurrentTransformInverse)(L),X.PathType.FILL);U=(0,x.getCurrentTransform)(L),L.restore(),L.fillStyle=B}let Z=a.lineWidth;const lt=a.textMatrixScale;if(lt===0||Z===0){const B=a.textRenderingMode&m.TextRenderingMode.FILL_STROKE_MASK;(B===m.TextRenderingMode.STROKE||B===m.TextRenderingMode.FILL_STROKE)&&(Z=this.getSinglePixelWidth())}else Z/=lt;N!==1&&(L.scale(N,N),Z/=N),L.lineWidth=Z;let st=0,gt;for(gt=0;gt<et;++gt){const B=d[gt];if(typeof B=="number"){st+=u*B*w/1e3;continue}let pt=!1;const mt=(B.isSpace?Y:0)+H,yt=B.fontChar,q=B.accent;let ut,St,Tt=B.width;if(i){const kt=B.vmetric||g,Ct=-(B.vmetric?kt[1]:Tt*.5)*P,qt=kt[2]*P;Tt=kt?-kt[0]:Tt,ut=Ct/N,St=(st+qt)/N}else ut=st/N,St=0;if(b.remeasure&&Tt>0){const kt=L.measureText(yt).width*1e3/w*N;if(Tt<kt&&this.isFontSubpixelAAEnabled){const Ct=Tt/kt;pt=!0,L.save(),L.scale(Ct,1),ut/=Ct}else Tt!==kt&&(ut+=(Tt-kt)/2e3*w/N)}if(this.contentVisible&&(B.isInFont||b.missingFile)){if(M&&!q)L.fillText(yt,ut,St);else if(this.paintChar(yt,ut,St,U),q){const kt=ut+w*q.offset.x/N,Ct=St-w*q.offset.y/N;this.paintChar(q.fontChar,kt,Ct,U)}}let Ft;i?Ft=Tt*P-mt*at:Ft=Tt*P+mt*at,st+=Ft,pt&&L.restore()}i?a.y-=st:a.x+=st*K,L.restore(),this.compose()}showType3Text(d){const a=this.ctx,b=this.current,w=b.font,L=b.fontSize,N=b.fontDirection,H=w.vertical?1:-1,Y=b.charSpacing,at=b.wordSpacing,K=b.textHScale*N,et=b.fontMatrix||m.FONT_IDENTITY_MATRIX,i=d.length,u=b.textRenderingMode===m.TextRenderingMode.INVISIBLE;let g,P,M,U;if(!(u||L===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,a.save(),a.transform(...b.textMatrix),a.translate(b.x,b.y),a.scale(K,N),g=0;g<i;++g){if(P=d[g],typeof P=="number"){U=H*P*L/1e3,this.ctx.translate(U,0),b.x+=U*K;continue}const Z=(P.isSpace?at:0)+Y,lt=w.charProcOperatorList[P.operatorListId];if(!lt){(0,m.warn)(`Type3 character "${P.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=P,this.save(),a.scale(L,L),a.transform(...et),this.executeOperatorList(lt),this.restore()),M=m.Util.applyTransform([P.width,0],et)[0]*L+Z,a.translate(M,0),b.x+=M*K}a.restore(),this.processingType3=null}}setCharWidth(d,a){}setCharWidthAndBounds(d,a,b,w,L,N){this.ctx.rect(b,w,L-b,N-w),this.ctx.clip(),this.endPath()}getColorN_Pattern(d){let a;if(d[0]==="TilingPattern"){const b=d[1],w=this.baseTransform||(0,x.getCurrentTransform)(this.ctx),L={createCanvasGraphics:N=>new bt(N,this.commonObjs,this.objs,this.canvasFactory)};a=new X.TilingPattern(d,b,this.ctx,L,w)}else a=this._getPattern(d[1],d[2]);return a}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(d,a,b){var L;const w=((L=this.selectColor)==null?void 0:L.call(this,d,a,b))||m.Util.makeHexColor(d,a,b);this.ctx.strokeStyle=w,this.current.strokeColor=w}setFillRGBColor(d,a,b){var L;const w=((L=this.selectColor)==null?void 0:L.call(this,d,a,b))||m.Util.makeHexColor(d,a,b);this.ctx.fillStyle=w,this.current.fillColor=w,this.current.patternFill=!1}_getPattern(d,a=null){let b;return this.cachedPatterns.has(d)?b=this.cachedPatterns.get(d):(b=(0,X.getShadingPattern)(this.objs.get(d)),this.cachedPatterns.set(d,b)),a&&(b.matrix=a),b}shadingFill(d){if(!this.contentVisible)return;const a=this.ctx;this.save();const b=this._getPattern(d);a.fillStyle=b.getPattern(a,this,(0,x.getCurrentTransformInverse)(a),X.PathType.SHADING);const w=(0,x.getCurrentTransformInverse)(a);if(w){const L=a.canvas,N=L.width,H=L.height,Y=m.Util.applyTransform([0,0],w),at=m.Util.applyTransform([0,H],w),K=m.Util.applyTransform([N,0],w),et=m.Util.applyTransform([N,H],w),i=Math.min(Y[0],at[0],K[0],et[0]),u=Math.min(Y[1],at[1],K[1],et[1]),g=Math.max(Y[0],at[0],K[0],et[0]),P=Math.max(Y[1],at[1],K[1],et[1]);this.ctx.fillRect(i,u,g-i,P-u)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,m.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,m.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(d,a){if(!!this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(d)&&d.length===6&&this.transform(...d),this.baseTransform=(0,x.getCurrentTransform)(this.ctx),a)){const b=a[2]-a[0],w=a[3]-a[1];this.ctx.rect(a[0],a[1],b,w),this.current.updateRectMinMax((0,x.getCurrentTransform)(this.ctx),a),this.clip(),this.endPath()}}paintFormXObjectEnd(){!this.contentVisible||(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(d){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const a=this.ctx;d.isolated||(0,m.info)("TODO: Support non-isolated groups."),d.knockout&&(0,m.warn)("Knockout groups not supported.");const b=(0,x.getCurrentTransform)(a);if(d.matrix&&a.transform(...d.matrix),!d.bbox)throw new Error("Bounding box is required.");let w=m.Util.getAxialAlignedBoundingBox(d.bbox,(0,x.getCurrentTransform)(a));const L=[0,0,a.canvas.width,a.canvas.height];w=m.Util.intersect(w,L)||[0,0,0,0];const N=Math.floor(w[0]),H=Math.floor(w[1]);let Y=Math.max(Math.ceil(w[2])-N,1),at=Math.max(Math.ceil(w[3])-H,1),K=1,et=1;Y>y&&(K=Y/y,Y=y),at>y&&(et=at/y,at=y),this.current.startNewPathAndClipBox([0,0,Y,at]);let i="groupAt"+this.groupLevel;d.smask&&(i+="_smask_"+this.smaskCounter++%2);const u=this.cachedCanvases.getCanvas(i,Y,at),g=u.context;g.scale(1/K,1/et),g.translate(-N,-H),g.transform(...b),d.smask?this.smaskStack.push({canvas:u.canvas,context:g,offsetX:N,offsetY:H,scaleX:K,scaleY:et,subtype:d.smask.subtype,backdrop:d.smask.backdrop,transferMap:d.smask.transferMap||null,startTransformInverse:null}):(a.setTransform(1,0,0,1,0,0),a.translate(N,H),a.scale(K,et),a.save()),s(a,g),this.ctx=g,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(a),this.groupLevel++}endGroup(d){if(!this.contentVisible)return;this.groupLevel--;const a=this.ctx,b=this.groupStack.pop();if(this.ctx=b,this.ctx.imageSmoothingEnabled=!1,d.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const w=(0,x.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...w);const L=m.Util.getAxialAlignedBoundingBox([0,0,a.canvas.width,a.canvas.height],w);this.ctx.drawImage(a.canvas,0,0),this.ctx.restore(),this.compose(L)}}beginAnnotation(d,a,b,w,L){if(ht(this,nt,ce).call(this),_(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(a)&&a.length===4){const N=a[2]-a[0],H=a[3]-a[1];if(L&&this.annotationCanvasMap){b=b.slice(),b[4]-=a[0],b[5]-=a[1],a=a.slice(),a[0]=a[1]=0,a[2]=N,a[3]=H;const[Y,at]=m.Util.singularValueDecompose2dScale((0,x.getCurrentTransform)(this.ctx)),{viewportScale:K}=this,et=Math.ceil(N*this.outputScaleX*K),i=Math.ceil(H*this.outputScaleY*K);this.annotationCanvas=this.canvasFactory.create(et,i);const{canvas:u,context:g}=this.annotationCanvas;this.annotationCanvasMap.set(d,u),this.annotationCanvas.savedCtx=this.ctx,this.ctx=g,this.ctx.setTransform(Y,0,0,-at,0,H*at),_(this.ctx,this.foregroundColor)}else _(this.ctx,this.foregroundColor),this.ctx.rect(a[0],a[1],N,H),this.ctx.clip(),this.endPath()}this.current=new r(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...b),this.transform(...w)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(d){if(!this.contentVisible)return;const a=d.count;d=this.getObject(d.data,d),d.count=a;const b=this.ctx,w=this.processingType3;if(w&&(w.compiled===void 0&&(w.compiled=o(d)),w.compiled)){w.compiled(b);return}const L=this._createMaskCanvas(d),N=L.canvas;b.save(),b.setTransform(1,0,0,1,0,0),b.drawImage(N,L.offsetX,L.offsetY),b.restore(),this.compose()}paintImageMaskXObjectRepeat(d,a,b=0,w=0,L,N){if(!this.contentVisible)return;d=this.getObject(d.data,d);const H=this.ctx;H.save();const Y=(0,x.getCurrentTransform)(H);H.transform(a,b,w,L,0,0);const at=this._createMaskCanvas(d);H.setTransform(1,0,0,1,0,0);for(let K=0,et=N.length;K<et;K+=2){const i=m.Util.transform(Y,[a,b,w,L,N[K],N[K+1]]),[u,g]=m.Util.applyTransform([0,0],i);H.drawImage(at.canvas,u,g)}H.restore(),this.compose()}paintImageMaskXObjectGroup(d){if(!this.contentVisible)return;const a=this.ctx,b=this.current.fillColor,w=this.current.patternFill;for(const L of d){const{data:N,width:H,height:Y,transform:at}=L,K=this.cachedCanvases.getCanvas("maskCanvas",H,Y),et=K.context;et.save();const i=this.getObject(N,L);t(et,i),et.globalCompositeOperation="source-in",et.fillStyle=w?b.getPattern(et,this,(0,x.getCurrentTransformInverse)(a),X.PathType.FILL):b,et.fillRect(0,0,H,Y),et.restore(),a.save(),a.transform(...at),a.scale(1,-1),e(a,K.canvas,0,0,H,Y,0,-1,1,1),a.restore()}this.compose()}paintImageXObject(d){if(!this.contentVisible)return;const a=this.getObject(d);if(!a){(0,m.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(a)}paintImageXObjectRepeat(d,a,b,w){if(!this.contentVisible)return;const L=this.getObject(d);if(!L){(0,m.warn)("Dependent image isn't ready yet");return}const N=L.width,H=L.height,Y=[];for(let at=0,K=w.length;at<K;at+=2)Y.push({transform:[a,0,0,b,w[at],w[at+1]],x:0,y:0,w:N,h:H});this.paintInlineImageXObjectGroup(L,Y)}paintInlineImageXObject(d){if(!this.contentVisible)return;const a=d.width,b=d.height,w=this.ctx;this.save(),w.scale(1/a,-1/b);let L;if(typeof HTMLElement=="function"&&d instanceof HTMLElement||!d.data)L=d;else{const H=this.cachedCanvases.getCanvas("inlineImage",a,b),Y=H.context;l(Y,d,this.current.transferMaps),L=H.canvas}const N=this._scaleImage(L,(0,x.getCurrentTransformInverse)(w));w.imageSmoothingEnabled=ct((0,x.getCurrentTransform)(w),d.interpolate),e(w,N.img,0,0,N.paintWidth,N.paintHeight,0,-b,a,b),this.compose(),this.restore()}paintInlineImageXObjectGroup(d,a){if(!this.contentVisible)return;const b=this.ctx,w=d.width,L=d.height,N=this.cachedCanvases.getCanvas("inlineImage",w,L),H=N.context;l(H,d,this.current.transferMaps);for(const Y of a)b.save(),b.transform(...Y.transform),b.scale(1,-1),e(b,N.canvas,Y.x,Y.y,Y.w,Y.h,0,-1,1,1),b.restore();this.compose()}paintSolidColorImageMask(){!this.contentVisible||(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(d){}markPointProps(d,a){}beginMarkedContent(d){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(d,a){d==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(a)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(d){const a=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(d);const b=this.ctx;this.pendingClip&&(a||(this.pendingClip===$?b.clip("evenodd"):b.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),b.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const d=(0,x.getCurrentTransform)(this.ctx);if(d[1]===0&&d[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(d[0]),Math.abs(d[3]));else{const a=Math.abs(d[0]*d[3]-d[2]*d[1]),b=Math.hypot(d[0],d[2]),w=Math.hypot(d[1],d[3]);this._cachedGetSinglePixelWidth=Math.max(b,w)/a}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:d}=this.current,a=(0,x.getCurrentTransform)(this.ctx);let b,w;if(a[1]===0&&a[2]===0){const L=Math.abs(a[0]),N=Math.abs(a[3]);if(d===0)b=1/L,w=1/N;else{const H=L*d,Y=N*d;b=H<1?1/H:1,w=Y<1?1/Y:1}}else{const L=Math.abs(a[0]*a[3]-a[2]*a[1]),N=Math.hypot(a[0],a[1]),H=Math.hypot(a[2],a[3]);if(d===0)b=H/L,w=N/L;else{const Y=d*L;b=H>Y?H/Y:1,w=N>Y?N/Y:1}}this._cachedScaleForStroking=[b,w]}return this._cachedScaleForStroking}rescaleAndStroke(d){const{ctx:a}=this,{lineWidth:b}=this.current,[w,L]=this.getScaleForStroking();if(a.lineWidth=b||1,w===1&&L===1){a.stroke();return}let N,H,Y;d&&(N=(0,x.getCurrentTransform)(a),H=a.getLineDash().slice(),Y=a.lineDashOffset),a.scale(w,L);const at=Math.max(w,L);a.setLineDash(a.getLineDash().map(K=>K/at)),a.lineDashOffset/=at,a.stroke(),d&&(a.setTransform(...N),a.setLineDash(H),a.lineDashOffset=Y)}isContentVisible(){for(let d=this.markedContentStack.length-1;d>=0;d--)if(!this.markedContentStack[d].visible)return!1;return!0}};let tt=bt;nt=new WeakSet,ce=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},f.CanvasGraphics=tt;for(const I in m.OPS)tt.prototype[I]!==void 0&&(tt.prototype[m.OPS[I]]=tt.prototype[I])},(ot,f,J)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.TilingPattern=f.PathType=void 0,f.getShadingPattern=c;var m=J(1),x=J(6),X=J(12);const z={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};f.PathType=z;function G(e,o){if(!o||X.isNodeJS)return;const r=o[2]-o[0],l=o[3]-o[1],t=new Path2D;t.rect(o[0],o[1],r,l),e.clip(t)}class j{constructor(){this.constructor===j&&(0,m.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,m.unreachable)("Abstract method `getPattern` called.")}}class v extends j{constructor(o){super(),this._type=o[1],this._bbox=o[2],this._colorStops=o[3],this._p0=o[4],this._p1=o[5],this._r0=o[6],this._r1=o[7],this.matrix=null}_createGradient(o){let r;this._type==="axial"?r=o.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(r=o.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const l of this._colorStops)r.addColorStop(l[0],l[1]);return r}getPattern(o,r,l,t){let s;if(t===z.STROKE||t===z.FILL){const _=r.current.getClippedPathBoundingBox(t,(0,x.getCurrentTransform)(o))||[0,0,0,0],C=Math.ceil(_[2]-_[0])||1,D=Math.ceil(_[3]-_[1])||1,E=r.cachedCanvases.getCanvas("pattern",C,D,!0),T=E.context;T.clearRect(0,0,T.canvas.width,T.canvas.height),T.beginPath(),T.rect(0,0,T.canvas.width,T.canvas.height),T.translate(-_[0],-_[1]),l=m.Util.transform(l,[1,0,0,1,_[0],_[1]]),T.transform(...r.baseTransform),this.matrix&&T.transform(...this.matrix),G(T,this._bbox),T.fillStyle=this._createGradient(T),T.fill(),s=o.createPattern(E.canvas,"no-repeat");const Q=new DOMMatrix(l);s.setTransform(Q)}else G(o,this._bbox),s=this._createGradient(o);return s}}function y(e,o,r,l,t,s,_,C){const D=o.coords,E=o.colors,T=e.data,Q=e.width*4;let ct;D[r+1]>D[l+1]&&(ct=r,r=l,l=ct,ct=s,s=_,_=ct),D[l+1]>D[t+1]&&(ct=l,l=t,t=ct,ct=_,_=C,C=ct),D[r+1]>D[l+1]&&(ct=r,r=l,l=ct,ct=s,s=_,_=ct);const rt=(D[r]+o.offsetX)*o.scaleX,V=(D[r+1]+o.offsetY)*o.scaleY,W=(D[l]+o.offsetX)*o.scaleX,$=(D[l+1]+o.offsetY)*o.scaleY,tt=(D[t]+o.offsetX)*o.scaleX,nt=(D[t+1]+o.offsetY)*o.scaleY;if(V>=nt)return;const ft=E[s],bt=E[s+1],I=E[s+2],d=E[_],a=E[_+1],b=E[_+2],w=E[C],L=E[C+1],N=E[C+2],H=Math.round(V),Y=Math.round(nt);let at,K,et,i,u,g,P,M;for(let U=H;U<=Y;U++){if(U<$){let B;U<V?B=0:B=(V-U)/(V-$),at=rt-(rt-W)*B,K=ft-(ft-d)*B,et=bt-(bt-a)*B,i=I-(I-b)*B}else{let B;U>nt?B=1:$===nt?B=0:B=($-U)/($-nt),at=W-(W-tt)*B,K=d-(d-w)*B,et=a-(a-L)*B,i=b-(b-N)*B}let Z;U<V?Z=0:U>nt?Z=1:Z=(V-U)/(V-nt),u=rt-(rt-tt)*Z,g=ft-(ft-w)*Z,P=bt-(bt-L)*Z,M=I-(I-N)*Z;const lt=Math.round(Math.min(at,u)),st=Math.round(Math.max(at,u));let gt=Q*U+lt*4;for(let B=lt;B<=st;B++)Z=(at-B)/(at-u),Z<0?Z=0:Z>1&&(Z=1),T[gt++]=K-(K-g)*Z|0,T[gt++]=et-(et-P)*Z|0,T[gt++]=i-(i-M)*Z|0,T[gt++]=255}}function F(e,o,r){const l=o.coords,t=o.colors;let s,_;switch(o.type){case"lattice":const C=o.verticesPerRow,D=Math.floor(l.length/C)-1,E=C-1;for(s=0;s<D;s++){let T=s*C;for(let Q=0;Q<E;Q++,T++)y(e,r,l[T],l[T+1],l[T+C],t[T],t[T+1],t[T+C]),y(e,r,l[T+C+1],l[T+1],l[T+C],t[T+C+1],t[T+1],t[T+C])}break;case"triangles":for(s=0,_=l.length;s<_;s+=3)y(e,r,l[s],l[s+1],l[s+2],t[s],t[s+1],t[s+2]);break;default:throw new Error("illegal figure")}}class A extends j{constructor(o){super(),this._coords=o[2],this._colors=o[3],this._figures=o[4],this._bounds=o[5],this._bbox=o[7],this._background=o[8],this.matrix=null}_createMeshCanvas(o,r,l){const C=Math.floor(this._bounds[0]),D=Math.floor(this._bounds[1]),E=Math.ceil(this._bounds[2])-C,T=Math.ceil(this._bounds[3])-D,Q=Math.min(Math.ceil(Math.abs(E*o[0]*1.1)),3e3),ct=Math.min(Math.ceil(Math.abs(T*o[1]*1.1)),3e3),rt=E/Q,V=T/ct,W={coords:this._coords,colors:this._colors,offsetX:-C,offsetY:-D,scaleX:1/rt,scaleY:1/V},$=Q+2*2,tt=ct+2*2,nt=l.getCanvas("mesh",$,tt,!1),ft=nt.context,bt=ft.createImageData(Q,ct);if(r){const d=bt.data;for(let a=0,b=d.length;a<b;a+=4)d[a]=r[0],d[a+1]=r[1],d[a+2]=r[2],d[a+3]=255}for(const d of this._figures)F(bt,d,W);return ft.putImageData(bt,2,2),{canvas:nt.canvas,offsetX:C-2*rt,offsetY:D-2*V,scaleX:rt,scaleY:V}}getPattern(o,r,l,t){G(o,this._bbox);let s;if(t===z.SHADING)s=m.Util.singularValueDecompose2dScale((0,x.getCurrentTransform)(o));else if(s=m.Util.singularValueDecompose2dScale(r.baseTransform),this.matrix){const C=m.Util.singularValueDecompose2dScale(this.matrix);s=[s[0]*C[0],s[1]*C[1]]}const _=this._createMeshCanvas(s,t===z.SHADING?null:this._background,r.cachedCanvases);return t!==z.SHADING&&(o.setTransform(...r.baseTransform),this.matrix&&o.transform(...this.matrix)),o.translate(_.offsetX,_.offsetY),o.scale(_.scaleX,_.scaleY),o.createPattern(_.canvas,"no-repeat")}}class p extends j{getPattern(){return"hotpink"}}function c(e){switch(e[0]){case"RadialAxial":return new v(e);case"Mesh":return new A(e);case"Dummy":return new p}throw new Error(`Unknown IR type: ${e[0]}`)}const h={COLORED:1,UNCOLORED:2};class n{static get MAX_PATTERN_SIZE(){return(0,m.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(o,r,l,t,s){this.operatorList=o[2],this.matrix=o[3]||[1,0,0,1,0,0],this.bbox=o[4],this.xstep=o[5],this.ystep=o[6],this.paintType=o[7],this.tilingType=o[8],this.color=r,this.ctx=l,this.canvasGraphicsFactory=t,this.baseTransform=s}createPatternCanvas(o){const r=this.operatorList,l=this.bbox,t=this.xstep,s=this.ystep,_=this.paintType,C=this.tilingType,D=this.color,E=this.canvasGraphicsFactory;(0,m.info)("TilingType: "+C);const T=l[0],Q=l[1],ct=l[2],rt=l[3],V=m.Util.singularValueDecompose2dScale(this.matrix),W=m.Util.singularValueDecompose2dScale(this.baseTransform),$=[V[0]*W[0],V[1]*W[1]],tt=this.getSizeAndScale(t,this.ctx.canvas.width,$[0]),nt=this.getSizeAndScale(s,this.ctx.canvas.height,$[1]),ft=o.cachedCanvases.getCanvas("pattern",tt.size,nt.size,!0),bt=ft.context,I=E.createCanvasGraphics(bt);I.groupLevel=o.groupLevel,this.setFillAndStrokeStyleToContext(I,_,D);let d=T,a=Q,b=ct,w=rt;return T<0&&(d=0,b+=Math.abs(T)),Q<0&&(a=0,w+=Math.abs(Q)),bt.translate(-(tt.scale*d),-(nt.scale*a)),I.transform(tt.scale,0,0,nt.scale,0,0),bt.save(),this.clipBbox(I,d,a,b,w),I.baseTransform=(0,x.getCurrentTransform)(I.ctx),I.executeOperatorList(r),I.endDrawing(),{canvas:ft.canvas,scaleX:tt.scale,scaleY:nt.scale,offsetX:d,offsetY:a}}getSizeAndScale(o,r,l){o=Math.abs(o);const t=Math.max(n.MAX_PATTERN_SIZE,r);let s=Math.ceil(o*l);return s>=t?s=t:l=s/o,{scale:l,size:s}}clipBbox(o,r,l,t,s){const _=t-r,C=s-l;o.ctx.rect(r,l,_,C),o.current.updateRectMinMax((0,x.getCurrentTransform)(o.ctx),[r,l,t,s]),o.clip(),o.endPath()}setFillAndStrokeStyleToContext(o,r,l){const t=o.ctx,s=o.current;switch(r){case h.COLORED:const _=this.ctx;t.fillStyle=_.fillStyle,t.strokeStyle=_.strokeStyle,s.fillColor=_.fillStyle,s.strokeColor=_.strokeStyle;break;case h.UNCOLORED:const C=m.Util.makeHexColor(l[0],l[1],l[2]);t.fillStyle=C,t.strokeStyle=C,s.fillColor=C,s.strokeColor=C;break;default:throw new m.FormatError(`Unsupported paint type: ${r}`)}}getPattern(o,r,l,t){let s=l;t!==z.SHADING&&(s=m.Util.transform(s,r.baseTransform),this.matrix&&(s=m.Util.transform(s,this.matrix)));const _=this.createPatternCanvas(r);let C=new DOMMatrix(s);C=C.translate(_.offsetX,_.offsetY),C=C.scale(1/_.scaleX,1/_.scaleY);const D=o.createPattern(_.canvas,"repeat");return D.setTransform(C),D}}f.TilingPattern=n},(ot,f)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.isNodeJS=void 0;const J=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");f.isNodeJS=J},(ot,f,J)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.applyMaskImageData=x;var m=J(1);function x({src:X,srcPos:z=0,dest:G,destPos:j=0,width:v,height:y,inverseDecode:F=!1}){const A=m.FeatureTest.isLittleEndian?4278190080:255,[p,c]=F?[0,A]:[A,0],h=v>>3,n=v&7,e=X.length;G=new Uint32Array(G.buffer);for(let o=0;o<y;o++){for(const l=z+h;z<l;z++){const t=z<e?X[z]:255;G[j++]=t&128?c:p,G[j++]=t&64?c:p,G[j++]=t&32?c:p,G[j++]=t&16?c:p,G[j++]=t&8?c:p,G[j++]=t&4?c:p,G[j++]=t&2?c:p,G[j++]=t&1?c:p}if(n===0)continue;const r=z<e?X[z++]:255;for(let l=0;l<n;l++)G[j++]=r&1<<7-l?c:p}return{srcPos:z,destPos:j}}},(ot,f)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.GlobalWorkerOptions=void 0;const J=Object.create(null);f.GlobalWorkerOptions=J,J.workerPort=J.workerPort===void 0?null:J.workerPort,J.workerSrc=J.workerSrc===void 0?"":J.workerSrc},(ot,f,J)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.MessageHandler=void 0;var m=J(1);const x={UNKNOWN:0,DATA:1,ERROR:2},X={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function z(j){switch(j instanceof Error||typeof j=="object"&&j!==null||(0,m.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),j.name){case"AbortException":return new m.AbortException(j.message);case"MissingPDFException":return new m.MissingPDFException(j.message);case"PasswordException":return new m.PasswordException(j.message,j.code);case"UnexpectedResponseException":return new m.UnexpectedResponseException(j.message,j.status);case"UnknownErrorException":return new m.UnknownErrorException(j.message,j.details);default:return new m.UnknownErrorException(j.message,j.toString())}}class G{constructor(v,y,F){this.sourceName=v,this.targetName=y,this.comObj=F,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=A=>{const p=A.data;if(p.targetName!==this.sourceName)return;if(p.stream){this._processStreamMessage(p);return}if(p.callback){const h=p.callbackId,n=this.callbackCapabilities[h];if(!n)throw new Error(`Cannot resolve callback ${h}`);if(delete this.callbackCapabilities[h],p.callback===x.DATA)n.resolve(p.data);else if(p.callback===x.ERROR)n.reject(z(p.reason));else throw new Error("Unexpected callback case");return}const c=this.actionHandler[p.action];if(!c)throw new Error(`Unknown action from worker: ${p.action}`);if(p.callbackId){const h=this.sourceName,n=p.sourceName;new Promise(function(e){e(c(p.data))}).then(function(e){F.postMessage({sourceName:h,targetName:n,callback:x.DATA,callbackId:p.callbackId,data:e})},function(e){F.postMessage({sourceName:h,targetName:n,callback:x.ERROR,callbackId:p.callbackId,reason:z(e)})});return}if(p.streamId){this._createStreamSink(p);return}c(p.data)},F.addEventListener("message",this._onComObjOnMessage)}on(v,y){const F=this.actionHandler;if(F[v])throw new Error(`There is already an actionName called "${v}"`);F[v]=y}send(v,y,F){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:v,data:y},F)}sendWithPromise(v,y,F){const A=this.callbackId++,p=(0,m.createPromiseCapability)();this.callbackCapabilities[A]=p;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:v,callbackId:A,data:y},F)}catch(c){p.reject(c)}return p.promise}sendWithStream(v,y,F,A){const p=this.streamId++,c=this.sourceName,h=this.targetName,n=this.comObj;return new ReadableStream({start:e=>{const o=(0,m.createPromiseCapability)();return this.streamControllers[p]={controller:e,startCall:o,pullCall:null,cancelCall:null,isClosed:!1},n.postMessage({sourceName:c,targetName:h,action:v,streamId:p,data:y,desiredSize:e.desiredSize},A),o.promise},pull:e=>{const o=(0,m.createPromiseCapability)();return this.streamControllers[p].pullCall=o,n.postMessage({sourceName:c,targetName:h,stream:X.PULL,streamId:p,desiredSize:e.desiredSize}),o.promise},cancel:e=>{(0,m.assert)(e instanceof Error,"cancel must have a valid reason");const o=(0,m.createPromiseCapability)();return this.streamControllers[p].cancelCall=o,this.streamControllers[p].isClosed=!0,n.postMessage({sourceName:c,targetName:h,stream:X.CANCEL,streamId:p,reason:z(e)}),o.promise}},F)}_createStreamSink(v){const y=v.streamId,F=this.sourceName,A=v.sourceName,p=this.comObj,c=this,h=this.actionHandler[v.action],n={enqueue(e,o=1,r){if(this.isCancelled)return;const l=this.desiredSize;this.desiredSize-=o,l>0&&this.desiredSize<=0&&(this.sinkCapability=(0,m.createPromiseCapability)(),this.ready=this.sinkCapability.promise),p.postMessage({sourceName:F,targetName:A,stream:X.ENQUEUE,streamId:y,chunk:e},r)},close(){this.isCancelled||(this.isCancelled=!0,p.postMessage({sourceName:F,targetName:A,stream:X.CLOSE,streamId:y}),delete c.streamSinks[y])},error(e){(0,m.assert)(e instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,p.postMessage({sourceName:F,targetName:A,stream:X.ERROR,streamId:y,reason:z(e)}))},sinkCapability:(0,m.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:v.desiredSize,ready:null};n.sinkCapability.resolve(),n.ready=n.sinkCapability.promise,this.streamSinks[y]=n,new Promise(function(e){e(h(v.data,n))}).then(function(){p.postMessage({sourceName:F,targetName:A,stream:X.START_COMPLETE,streamId:y,success:!0})},function(e){p.postMessage({sourceName:F,targetName:A,stream:X.START_COMPLETE,streamId:y,reason:z(e)})})}_processStreamMessage(v){const y=v.streamId,F=this.sourceName,A=v.sourceName,p=this.comObj,c=this.streamControllers[y],h=this.streamSinks[y];switch(v.stream){case X.START_COMPLETE:v.success?c.startCall.resolve():c.startCall.reject(z(v.reason));break;case X.PULL_COMPLETE:v.success?c.pullCall.resolve():c.pullCall.reject(z(v.reason));break;case X.PULL:if(!h){p.postMessage({sourceName:F,targetName:A,stream:X.PULL_COMPLETE,streamId:y,success:!0});break}h.desiredSize<=0&&v.desiredSize>0&&h.sinkCapability.resolve(),h.desiredSize=v.desiredSize,new Promise(function(n){n(h.onPull&&h.onPull())}).then(function(){p.postMessage({sourceName:F,targetName:A,stream:X.PULL_COMPLETE,streamId:y,success:!0})},function(n){p.postMessage({sourceName:F,targetName:A,stream:X.PULL_COMPLETE,streamId:y,reason:z(n)})});break;case X.ENQUEUE:if((0,m.assert)(c,"enqueue should have stream controller"),c.isClosed)break;c.controller.enqueue(v.chunk);break;case X.CLOSE:if((0,m.assert)(c,"close should have stream controller"),c.isClosed)break;c.isClosed=!0,c.controller.close(),this._deleteStreamController(c,y);break;case X.ERROR:(0,m.assert)(c,"error should have stream controller"),c.controller.error(z(v.reason)),this._deleteStreamController(c,y);break;case X.CANCEL_COMPLETE:v.success?c.cancelCall.resolve():c.cancelCall.reject(z(v.reason)),this._deleteStreamController(c,y);break;case X.CANCEL:if(!h)break;new Promise(function(n){n(h.onCancel&&h.onCancel(z(v.reason)))}).then(function(){p.postMessage({sourceName:F,targetName:A,stream:X.CANCEL_COMPLETE,streamId:y,success:!0})},function(n){p.postMessage({sourceName:F,targetName:A,stream:X.CANCEL_COMPLETE,streamId:y,reason:z(n)})}),h.sinkCapability.reject(z(v.reason)),h.isCancelled=!0,delete this.streamSinks[y];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(v,y){await Promise.allSettled([v.startCall&&v.startCall.promise,v.pullCall&&v.pullCall.promise,v.cancelCall&&v.cancelCall.promise]),delete this.streamControllers[y]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}f.MessageHandler=G},(ot,f,J)=>{var X,z;Object.defineProperty(f,"__esModule",{value:!0}),f.Metadata=void 0;var m=J(1);class x{constructor({parsedData:j,rawData:v}){it(this,X,void 0);it(this,z,void 0);_t(this,X,j),_t(this,z,v)}getRaw(){return S(this,z)}get(j){return S(this,X).get(j)??null}getAll(){return(0,m.objectFromMap)(S(this,X))}has(j){return S(this,X).has(j)}}X=new WeakMap,z=new WeakMap,f.Metadata=x},(ot,f,J)=>{var j,v,y,F,A,p,he;Object.defineProperty(f,"__esModule",{value:!0}),f.OptionalContentConfig=void 0;var m=J(1),x=J(8);const X=Symbol("INTERNAL");class z{constructor(n,e){it(this,j,!0);this.name=n,this.intent=e}get visible(){return S(this,j)}_setVisible(n,e){n!==X&&(0,m.unreachable)("Internal method `_setVisible` called."),_t(this,j,e)}}j=new WeakMap;class G{constructor(n){it(this,p);it(this,v,null);it(this,y,new Map);it(this,F,null);it(this,A,null);if(this.name=null,this.creator=null,n!==null){this.name=n.name,this.creator=n.creator,_t(this,A,n.order);for(const e of n.groups)S(this,y).set(e.id,new z(e.name,e.intent));if(n.baseState==="OFF")for(const e of S(this,y).values())e._setVisible(X,!1);for(const e of n.on)S(this,y).get(e)._setVisible(X,!0);for(const e of n.off)S(this,y).get(e)._setVisible(X,!1);_t(this,F,this.getHash())}}isVisible(n){if(S(this,y).size===0)return!0;if(!n)return(0,m.warn)("Optional content group not defined."),!0;if(n.type==="OCG")return S(this,y).has(n.id)?S(this,y).get(n.id).visible:((0,m.warn)(`Optional content group not found: ${n.id}`),!0);if(n.type==="OCMD"){if(n.expression)return ht(this,p,he).call(this,n.expression);if(!n.policy||n.policy==="AnyOn"){for(const e of n.ids){if(!S(this,y).has(e))return(0,m.warn)(`Optional content group not found: ${e}`),!0;if(S(this,y).get(e).visible)return!0}return!1}else if(n.policy==="AllOn"){for(const e of n.ids){if(!S(this,y).has(e))return(0,m.warn)(`Optional content group not found: ${e}`),!0;if(!S(this,y).get(e).visible)return!1}return!0}else if(n.policy==="AnyOff"){for(const e of n.ids){if(!S(this,y).has(e))return(0,m.warn)(`Optional content group not found: ${e}`),!0;if(!S(this,y).get(e).visible)return!0}return!1}else if(n.policy==="AllOff"){for(const e of n.ids){if(!S(this,y).has(e))return(0,m.warn)(`Optional content group not found: ${e}`),!0;if(S(this,y).get(e).visible)return!1}return!0}return(0,m.warn)(`Unknown optional content policy ${n.policy}.`),!0}return(0,m.warn)(`Unknown group type ${n.type}.`),!0}setVisibility(n,e=!0){if(!S(this,y).has(n)){(0,m.warn)(`Optional content group not found: ${n}`);return}S(this,y).get(n)._setVisible(X,!!e),_t(this,v,null)}get hasInitialVisibility(){return this.getHash()===S(this,F)}getOrder(){return S(this,y).size?S(this,A)?S(this,A).slice():[...S(this,y).keys()]:null}getGroups(){return S(this,y).size>0?(0,m.objectFromMap)(S(this,y)):null}getGroup(n){return S(this,y).get(n)||null}getHash(){if(S(this,v)!==null)return S(this,v);const n=new x.MurmurHash3_64;for(const[e,o]of S(this,y))n.update(`${e}:${o.visible}`);return _t(this,v,n.hexdigest())}}v=new WeakMap,y=new WeakMap,F=new WeakMap,A=new WeakMap,p=new WeakSet,he=function(n){const e=n.length;if(e<2)return!0;const o=n[0];for(let r=1;r<e;r++){const l=n[r];let t;if(Array.isArray(l))t=ht(this,p,he).call(this,l);else if(S(this,y).has(l))t=S(this,y).get(l).visible;else return(0,m.warn)(`Optional content group not found: ${l}`),!0;switch(o){case"And":if(!t)return!1;break;case"Or":if(t)return!0;break;case"Not":return!t;default:return!0}}return o==="And"},f.OptionalContentConfig=G},(ot,f,J)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.PDFDataTransportStream=void 0;var m=J(1),x=J(6);class X{constructor(v,y){(0,m.assert)(y,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=v.progressiveDone||!1,this._contentDispositionFilename=v.contentDispositionFilename||null;const F=v.initialData;if((F==null?void 0:F.length)>0){const A=new Uint8Array(F).buffer;this._queuedChunks.push(A)}this._pdfDataRangeTransport=y,this._isStreamingSupported=!v.disableStream,this._isRangeSupported=!v.disableRange,this._contentLength=v.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((A,p)=>{this._onReceiveData({begin:A,chunk:p})}),this._pdfDataRangeTransport.addProgressListener((A,p)=>{this._onProgress({loaded:A,total:p})}),this._pdfDataRangeTransport.addProgressiveReadListener(A=>{this._onReceiveData({chunk:A})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(v){const y=new Uint8Array(v.chunk).buffer;if(v.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(y):this._queuedChunks.push(y);else{const F=this._rangeReaders.some(function(A){return A._begin!==v.begin?!1:(A._enqueue(y),!0)});(0,m.assert)(F,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var v;return((v=this._fullRequestReader)==null?void 0:v._loaded)??0}_onProgress(v){var y,F,A,p;v.total===void 0?(F=(y=this._rangeReaders[0])==null?void 0:y.onProgress)==null||F.call(y,{loaded:v.loaded}):(p=(A=this._fullRequestReader)==null?void 0:A.onProgress)==null||p.call(A,{loaded:v.loaded,total:v.total})}_onProgressiveDone(){var v;(v=this._fullRequestReader)==null||v.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(v){const y=this._rangeReaders.indexOf(v);y>=0&&this._rangeReaders.splice(y,1)}getFullReader(){(0,m.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const v=this._queuedChunks;return this._queuedChunks=null,new z(this,v,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(v,y){if(y<=this._progressiveDataLength)return null;const F=new G(this,v,y);return this._pdfDataRangeTransport.requestDataRange(v,y),this._rangeReaders.push(F),F}cancelAllRequests(v){var y;(y=this._fullRequestReader)==null||y.cancel(v);for(const F of this._rangeReaders.slice(0))F.cancel(v);this._pdfDataRangeTransport.abort()}}f.PDFDataTransportStream=X;class z{constructor(v,y,F=!1,A=null){this._stream=v,this._done=F||!1,this._filename=(0,x.isPdfFile)(A)?A:null,this._queuedChunks=y||[],this._loaded=0;for(const p of this._queuedChunks)this._loaded+=p.byteLength;this._requests=[],this._headersReady=Promise.resolve(),v._fullRequestReader=this,this.onProgress=null}_enqueue(v){this._done||(this._requests.length>0?this._requests.shift().resolve({value:v,done:!1}):this._queuedChunks.push(v),this._loaded+=v.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const v=(0,m.createPromiseCapability)();return this._requests.push(v),v.promise}cancel(v){this._done=!0;for(const y of this._requests)y.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class G{constructor(v,y,F){this._stream=v,this._begin=y,this._end=F,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(v){if(!this._done){if(this._requests.length===0)this._queuedChunk=v;else{this._requests.shift().resolve({value:v,done:!1});for(const F of this._requests)F.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const y=this._queuedChunk;return this._queuedChunk=null,{value:y,done:!1}}if(this._done)return{value:void 0,done:!0};const v=(0,m.createPromiseCapability)();return this._requests.push(v),v.promise}cancel(v){this._done=!0;for(const y of this._requests)y.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(ot,f)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.XfaText=void 0;class J{static textContent(x){const X=[],z={items:X,styles:Object.create(null)};function G(j){var F;if(!j)return;let v=null;const y=j.name;if(y==="#text")v=j.value;else if(J.shouldBuildText(y))(F=j==null?void 0:j.attributes)!=null&&F.textContent?v=j.attributes.textContent:j.value&&(v=j.value);else return;if(v!==null&&X.push({str:v}),!!j.children)for(const A of j.children)G(A)}return G(x),z}static shouldBuildText(x){return!(x==="textarea"||x==="input"||x==="option"||x==="select")}}f.XfaText=J},(ot,f,J)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.NodeStandardFontDataFactory=f.NodeCanvasFactory=f.NodeCMapReaderFactory=void 0;var m=J(7);const x=function(j){return new Promise((v,y)=>{require$$5.readFile(j,(A,p)=>{if(A||!p){y(new Error(A));return}v(new Uint8Array(p))})})};class X extends m.BaseCanvasFactory{_createCanvas(v,y){return require$$5.createCanvas(v,y)}}f.NodeCanvasFactory=X;class z extends m.BaseCMapReaderFactory{_fetchData(v,y){return x(v).then(F=>({cMapData:F,compressionType:y}))}}f.NodeCMapReaderFactory=z;class G extends m.BaseStandardFontDataFactory{_fetchData(v){return x(v)}}f.NodeStandardFontDataFactory=G},(ot,f,J)=>{var j,v,y,F,A,p,c,h,n,de,o,Me,l,ue,s,Oe;Object.defineProperty(f,"__esModule",{value:!0}),f.AnnotationEditorLayer=void 0;var m=J(5),x=J(1),X=J(22),z=J(23);const C=class{constructor(E){it(this,n);it(this,o);it(this,l);it(this,s);it(this,j,void 0);it(this,v,!1);it(this,y,this.pointerup.bind(this));it(this,F,this.pointerdown.bind(this));it(this,A,new Map);it(this,p,!1);it(this,c,!1);it(this,h,void 0);C._initialized||(C._initialized=!0,X.FreeTextEditor.initialize(E.l10n),z.InkEditor.initialize(E.l10n)),E.uiManager.registerEditorTypes([X.FreeTextEditor,z.InkEditor]),_t(this,h,E.uiManager),this.annotationStorage=E.annotationStorage,this.pageIndex=E.pageIndex,this.div=E.div,_t(this,j,E.accessibilityManager),S(this,h).addLayer(this)}updateToolbar(E){S(this,h).updateToolbar(E)}updateMode(E=S(this,h).getMode()){ht(this,s,Oe).call(this),E===x.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),S(this,h).unselectAll(),this.div.classList.toggle("freeTextEditing",E===x.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",E===x.AnnotationEditorType.INK)}addInkEditorIfNeeded(E){if(!E&&S(this,h).getMode()!==x.AnnotationEditorType.INK)return;if(!E){for(const Q of S(this,A).values())if(Q.isEmpty()){Q.setInBackground();return}}ht(this,l,ue).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(E){S(this,h).setEditingState(E)}addCommands(E){S(this,h).addCommands(E)}enable(){this.div.style.pointerEvents="auto";for(const E of S(this,A).values())E.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const E of S(this,A).values())E.disableEditing()}setActiveEditor(E){S(this,h).getActive()!==E&&S(this,h).setActiveEditor(E)}enableClick(){this.div.addEventListener("pointerdown",S(this,F)),this.div.addEventListener("pointerup",S(this,y))}disableClick(){this.div.removeEventListener("pointerdown",S(this,F)),this.div.removeEventListener("pointerup",S(this,y))}attach(E){S(this,A).set(E.id,E)}detach(E){var T;S(this,A).delete(E.id),(T=S(this,j))==null||T.removePointerInTextLayer(E.contentDiv)}remove(E){S(this,h).removeEditor(E),this.detach(E),this.annotationStorage.remove(E.id),E.div.style.display="none",setTimeout(()=>{E.div.style.display="",E.div.remove(),E.isAttachedToDOM=!1,document.activeElement===document.body&&S(this,h).focusMainContainer()},0),S(this,c)||this.addInkEditorIfNeeded(!1)}add(E){if(ht(this,n,de).call(this,E),S(this,h).addEditor(E),this.attach(E),!E.isAttachedToDOM){const T=E.render();this.div.append(T),E.isAttachedToDOM=!0}this.moveEditorInDOM(E),E.onceAdded(),this.addToAnnotationStorage(E)}moveEditorInDOM(E){var T;(T=S(this,j))==null||T.moveElementInDOM(this.div,E.div,E.contentDiv,!0)}addToAnnotationStorage(E){!E.isEmpty()&&!this.annotationStorage.has(E.id)&&this.annotationStorage.setValue(E.id,E)}addOrRebuild(E){E.needsToBeRebuilt()?E.rebuild():this.add(E)}addANewEditor(E){const T=()=>{this.addOrRebuild(E)},Q=()=>{E.remove()};this.addCommands({cmd:T,undo:Q,mustExec:!0})}addUndoableEditor(E){const T=()=>{this.addOrRebuild(E)},Q=()=>{E.remove()};this.addCommands({cmd:T,undo:Q,mustExec:!1})}getNextId(){return S(this,h).getId()}deserialize(E){switch(E.annotationType){case x.AnnotationEditorType.FREETEXT:return X.FreeTextEditor.deserialize(E,this);case x.AnnotationEditorType.INK:return z.InkEditor.deserialize(E,this)}return null}setSelected(E){S(this,h).setSelected(E)}toggleSelected(E){S(this,h).toggleSelected(E)}isSelected(E){return S(this,h).isSelected(E)}unselect(E){S(this,h).unselect(E)}pointerup(E){const T=m.KeyboardManager.platform.isMac;if(!(E.button!==0||E.ctrlKey&&T)&&E.target===this.div&&!!S(this,p)){if(_t(this,p,!1),!S(this,v)){_t(this,v,!0);return}ht(this,l,ue).call(this,E)}}pointerdown(E){const T=m.KeyboardManager.platform.isMac;if(E.button!==0||E.ctrlKey&&T||E.target!==this.div)return;_t(this,p,!0);const Q=S(this,h).getActive();_t(this,v,!Q||Q.isEmpty())}drop(E){const T=E.dataTransfer.getData("text/plain"),Q=S(this,h).getEditor(T);if(!Q)return;E.preventDefault(),E.dataTransfer.dropEffect="move",ht(this,n,de).call(this,Q);const ct=this.div.getBoundingClientRect(),rt=E.clientX-ct.x,V=E.clientY-ct.y;Q.translate(rt-Q.startX,V-Q.startY),this.moveEditorInDOM(Q),Q.div.focus()}dragover(E){E.preventDefault()}destroy(){var E,T;((E=S(this,h).getActive())==null?void 0:E.parent)===this&&S(this,h).setActiveEditor(null);for(const Q of S(this,A).values())(T=S(this,j))==null||T.removePointerInTextLayer(Q.contentDiv),Q.isAttachedToDOM=!1,Q.div.remove(),Q.parent=null;this.div=null,S(this,A).clear(),S(this,h).removeLayer(this)}render(E){this.viewport=E.viewport,(0,m.bindEvents)(this,this.div,["dragover","drop"]),this.setDimensions();for(const T of S(this,h).getEditors(this.pageIndex))this.add(T);this.updateMode()}update(E){S(this,h).commitOrRemove(),this.viewport=E.viewport,this.setDimensions(),this.updateMode()}get scaleFactor(){return this.viewport.scale}get pageDimensions(){const[E,T,Q,ct]=this.viewport.viewBox,rt=Q-E,V=ct-T;return[rt,V]}get viewportBaseDimensions(){const{width:E,height:T,rotation:Q}=this.viewport;return Q%180===0?[E,T]:[T,E]}setDimensions(){const{width:E,height:T,rotation:Q}=this.viewport,ct=Q%180!==0,rt=Math.floor(E)+"px",V=Math.floor(T)+"px";this.div.style.width=ct?V:rt,this.div.style.height=ct?rt:V,this.div.setAttribute("data-main-rotation",Q)}};let G=C;j=new WeakMap,v=new WeakMap,y=new WeakMap,F=new WeakMap,A=new WeakMap,p=new WeakMap,c=new WeakMap,h=new WeakMap,n=new WeakSet,de=function(E){var T;E.parent!==this&&(this.attach(E),E.pageIndex=this.pageIndex,(T=E.parent)==null||T.detach(E),E.parent=this,E.div&&E.isAttachedToDOM&&(E.div.remove(),this.div.append(E.div)))},o=new WeakSet,Me=function(E){switch(S(this,h).getMode()){case x.AnnotationEditorType.FREETEXT:return new X.FreeTextEditor(E);case x.AnnotationEditorType.INK:return new z.InkEditor(E)}return null},l=new WeakSet,ue=function(E){const T=this.getNextId(),Q=ht(this,o,Me).call(this,{parent:this,id:T,x:E.offsetX,y:E.offsetY});return Q&&this.add(Q),Q},s=new WeakSet,Oe=function(){_t(this,c,!0);for(const E of S(this,A).values())E.isEmpty()&&E.remove();_t(this,c,!1)},It(G,"_initialized",!1),f.AnnotationEditorLayer=G},(ot,f,J)=>{var G,j,v,y,F,A,p,c,h,n,De,o,Ie,l,Le,s,fe;Object.defineProperty(f,"__esModule",{value:!0}),f.FreeTextEditor=void 0;var m=J(1),x=J(5),X=J(4);const C=class extends X.AnnotationEditor{constructor(T){super({...T,name:"freeTextEditor"});it(this,n);it(this,o);it(this,l);it(this,s);it(this,G,this.editorDivBlur.bind(this));it(this,j,this.editorDivFocus.bind(this));it(this,v,this.editorDivInput.bind(this));it(this,y,this.editorDivKeydown.bind(this));it(this,F,void 0);it(this,A,"");it(this,p,`${this.id}-editor`);it(this,c,!1);it(this,h,void 0);_t(this,F,T.color||C._defaultColor||X.AnnotationEditor._defaultLineColor),_t(this,h,T.fontSize||C._defaultFontSize)}static initialize(T){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(ct=>[ct,T.get(ct)]));const Q=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(Q.getPropertyValue("--freetext-padding"))}static updateDefaultParams(T,Q){switch(T){case m.AnnotationEditorParamsType.FREETEXT_SIZE:C._defaultFontSize=Q;break;case m.AnnotationEditorParamsType.FREETEXT_COLOR:C._defaultColor=Q;break}}updateParams(T,Q){switch(T){case m.AnnotationEditorParamsType.FREETEXT_SIZE:ht(this,n,De).call(this,Q);break;case m.AnnotationEditorParamsType.FREETEXT_COLOR:ht(this,o,Ie).call(this,Q);break}}static get defaultPropertiesToUpdate(){return[[m.AnnotationEditorParamsType.FREETEXT_SIZE,C._defaultFontSize],[m.AnnotationEditorParamsType.FREETEXT_COLOR,C._defaultColor||X.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[m.AnnotationEditorParamsType.FREETEXT_SIZE,S(this,h)],[m.AnnotationEditorParamsType.FREETEXT_COLOR,S(this,F)]]}getInitialTranslation(){return[-C._internalPadding*this.parent.scaleFactor,-(C._internalPadding+S(this,h))*this.parent.scaleFactor]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(m.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",S(this,y)),this.editorDiv.addEventListener("focus",S(this,j)),this.editorDiv.addEventListener("blur",S(this,G)),this.editorDiv.addEventListener("input",S(this,v)))}disableEditMode(){!this.isInEditMode()||(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",S(this,p)),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",S(this,y)),this.editorDiv.removeEventListener("focus",S(this,j)),this.editorDiv.removeEventListener("blur",S(this,G)),this.editorDiv.removeEventListener("input",S(this,v)),this.div.focus(),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(T){super.focusin(T),T.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing"),super.remove()}commit(){super.commit(),S(this,c)||(_t(this,c,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),_t(this,A,ht(this,l,Le).call(this).trimEnd()),ht(this,s,fe).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(T){this.enableEditMode(),this.editorDiv.focus()}keydown(T){T.target===this.div&&T.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(T){C._keyboardManager.exec(this,T)}editorDivFocus(T){this.isEditing=!0}editorDivBlur(T){this.isEditing=!1}editorDivInput(T){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let T,Q;this.width&&(T=this.x,Q=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",S(this,p)),this.enableEditing(),C._l10nPromise.get("editor_free_text2_aria_label").then(rt=>{var V;return(V=this.editorDiv)==null?void 0:V.setAttribute("aria-label",rt)}),C._l10nPromise.get("free_text2_default_content").then(rt=>{var V;return(V=this.editorDiv)==null?void 0:V.setAttribute("default-content",rt)}),this.editorDiv.contentEditable=!0;const{style:ct}=this.editorDiv;if(ct.fontSize=`calc(${S(this,h)}px * var(--scale-factor))`,ct.color=S(this,F),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,x.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[rt,V]=this.parent.viewportBaseDimensions;this.setAt(T*rt,Q*V,this.width*rt,this.height*V);for(const W of S(this,A).split(`
`)){const $=document.createElement("div");$.append(W?document.createTextNode(W):document.createElement("br")),this.editorDiv.append($)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(T,Q){const ct=super.deserialize(T,Q);return _t(ct,h,T.fontSize),_t(ct,F,m.Util.makeHexColor(...T.color)),_t(ct,A,T.value),ct}serialize(){if(this.isEmpty())return null;const T=C._internalPadding*this.parent.scaleFactor,Q=this.getRect(T,T),ct=X.AnnotationEditor._colorManager.convert(getComputedStyle(this.editorDiv).color);return{annotationType:m.AnnotationEditorType.FREETEXT,color:ct,fontSize:S(this,h),value:S(this,A),pageIndex:this.parent.pageIndex,rect:Q,rotation:this.rotation}}};let z=C;G=new WeakMap,j=new WeakMap,v=new WeakMap,y=new WeakMap,F=new WeakMap,A=new WeakMap,p=new WeakMap,c=new WeakMap,h=new WeakMap,n=new WeakSet,De=function(T){const Q=rt=>{this.editorDiv.style.fontSize=`calc(${rt}px * var(--scale-factor))`,this.translate(0,-(rt-S(this,h))*this.parent.scaleFactor),_t(this,h,rt),ht(this,s,fe).call(this)},ct=S(this,h);this.parent.addCommands({cmd:()=>{Q(T)},undo:()=>{Q(ct)},mustExec:!0,type:m.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},o=new WeakSet,Ie=function(T){const Q=S(this,F);this.parent.addCommands({cmd:()=>{_t(this,F,T),this.editorDiv.style.color=T},undo:()=>{_t(this,F,Q),this.editorDiv.style.color=Q},mustExec:!0,type:m.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},l=new WeakSet,Le=function(){const T=this.editorDiv.getElementsByTagName("div");if(T.length===0)return this.editorDiv.innerText;const Q=[];for(const ct of T){const rt=ct.firstChild;(rt==null?void 0:rt.nodeName)==="#text"?Q.push(rt.data):Q.push("")}return Q.join(`
`)},s=new WeakSet,fe=function(){const[T,Q]=this.parent.viewportBaseDimensions,ct=this.div.getBoundingClientRect();this.width=ct.width/T,this.height=ct.height/Q},It(z,"_freeTextDefaultContent",""),It(z,"_l10nPromise"),It(z,"_internalPadding",0),It(z,"_defaultColor",null),It(z,"_defaultFontSize",10),It(z,"_keyboardManager",new x.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],C.prototype.commitOrRemove]])),It(z,"_type","freetext"),f.FreeTextEditor=z},(ot,f,J)=>{var y,F,A,p,c,h,n,e,o,r,l,t,s,_,C,Ne,E,Ue,Q,je,rt,Be,W,pe,tt,We,ft,qe,I,He,a,zt,w,ge,N,Zt,Y,te,K,$t,i,me,g,ee,M,_e,Z,Ge,st,Xe,B,ze,mt,be,q,se,St,Yt,Ft,Ae;Object.defineProperty(f,"__esModule",{value:!0}),f.InkEditor=void 0,Object.defineProperty(f,"fitCurve",{enumerable:!0,get:function(){return X.fitCurve}});var m=J(1),x=J(4),X=J(24),z=J(5);const G=16,j=100,Ct=class extends x.AnnotationEditor{constructor(R){super({...R,name:"inkEditor"});it(this,C);it(this,E);it(this,Q);it(this,rt);it(this,W);it(this,tt);it(this,ft);it(this,I);it(this,a);it(this,w);it(this,N);it(this,Y);it(this,K);it(this,i);it(this,g);it(this,Z);it(this,st);it(this,B);it(this,mt);it(this,q);it(this,St);it(this,Ft);it(this,y,0);it(this,F,0);it(this,A,0);it(this,p,this.canvasPointermove.bind(this));it(this,c,this.canvasPointerleave.bind(this));it(this,h,this.canvasPointerup.bind(this));it(this,n,this.canvasPointerdown.bind(this));it(this,e,!1);it(this,o,!1);it(this,r,null);it(this,l,null);it(this,t,0);it(this,s,0);it(this,_,null);this.color=R.color||null,this.thickness=R.thickness||null,this.opacity=R.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(R){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(k=>[k,R.get(k)]))}static updateDefaultParams(R,k){switch(R){case m.AnnotationEditorParamsType.INK_THICKNESS:Ct._defaultThickness=k;break;case m.AnnotationEditorParamsType.INK_COLOR:Ct._defaultColor=k;break;case m.AnnotationEditorParamsType.INK_OPACITY:Ct._defaultOpacity=k/100;break}}updateParams(R,k){switch(R){case m.AnnotationEditorParamsType.INK_THICKNESS:ht(this,C,Ne).call(this,k);break;case m.AnnotationEditorParamsType.INK_COLOR:ht(this,E,Ue).call(this,k);break;case m.AnnotationEditorParamsType.INK_OPACITY:ht(this,Q,je).call(this,k);break}}static get defaultPropertiesToUpdate(){return[[m.AnnotationEditorParamsType.INK_THICKNESS,Ct._defaultThickness],[m.AnnotationEditorParamsType.INK_COLOR,Ct._defaultColor||x.AnnotationEditor._defaultLineColor],[m.AnnotationEditorParamsType.INK_OPACITY,Math.round(Ct._defaultOpacity*100)]]}get propertiesToUpdate(){return[[m.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Ct._defaultThickness],[m.AnnotationEditorParamsType.INK_COLOR,this.color||Ct._defaultColor||x.AnnotationEditor._defaultLineColor],[m.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??Ct._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(ht(this,N,Zt).call(this),ht(this,Y,te).call(this)),this.isAttachedToDOM||(this.parent.add(this),ht(this,K,$t).call(this)),ht(this,St,Yt).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,S(this,l).disconnect(),_t(this,l,null),super.remove())}enableEditMode(){S(this,e)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",S(this,n)),this.canvas.addEventListener("pointerup",S(this,h)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",S(this,n)),this.canvas.removeEventListener("pointerup",S(this,h)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){S(this,e)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),_t(this,e,!0),this.div.classList.add("disabled"),ht(this,St,Yt).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus())}focusin(R){super.focusin(R),this.enableEditMode()}canvasPointerdown(R){R.button!==0||!this.isInEditMode()||S(this,e)||(this.setInForeground(),R.type!=="mouse"&&this.div.focus(),R.stopPropagation(),this.canvas.addEventListener("pointerleave",S(this,c)),this.canvas.addEventListener("pointermove",S(this,p)),ht(this,tt,We).call(this,R.offsetX,R.offsetY))}canvasPointermove(R){R.stopPropagation(),ht(this,ft,qe).call(this,R.offsetX,R.offsetY)}canvasPointerup(R){R.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(R.stopPropagation(),ht(this,w,ge).call(this,R),this.setInBackground())}canvasPointerleave(R){ht(this,w,ge).call(this,R),this.setInBackground()}render(){if(this.div)return this.div;let R,k;this.width&&(R=this.x,k=this.y),super.render(),Ct._l10nPromise.get("editor_ink2_aria_label").then(vt=>{var Pt;return(Pt=this.div)==null?void 0:Pt.setAttribute("aria-label",vt)});const[O,dt,At,Et]=ht(this,rt,Be).call(this);if(this.setAt(O,dt,0,0),this.setDims(At,Et),ht(this,N,Zt).call(this),this.width){const[vt,Pt]=this.parent.viewportBaseDimensions;this.setAt(R*vt,k*Pt,this.width*vt,this.height*Pt),_t(this,o,!0),ht(this,K,$t).call(this),this.setDims(this.width*vt,this.height*Pt),ht(this,a,zt).call(this),ht(this,Ft,Ae).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return ht(this,Y,te).call(this),this.div}setDimensions(R,k){const O=Math.round(R),dt=Math.round(k);if(S(this,t)===O&&S(this,s)===dt)return;_t(this,t,O),_t(this,s,dt),this.canvas.style.visibility="hidden",S(this,y)&&Math.abs(S(this,y)-R/k)>.01&&(k=Math.ceil(R/S(this,y)),this.setDims(R,k));const[At,Et]=this.parent.viewportBaseDimensions;this.width=R/At,this.height=k/Et,S(this,e)&&ht(this,i,me).call(this,R,k),ht(this,K,$t).call(this),ht(this,a,zt).call(this),this.canvas.style.visibility="visible"}static deserialize(R,k){var Ot,Dt;const O=super.deserialize(R,k);O.thickness=R.thickness,O.color=m.Util.makeHexColor(...R.color),O.opacity=R.opacity;const[dt,At]=k.pageDimensions,Et=O.width*dt,vt=O.height*At,Pt=k.scaleFactor,Rt=R.thickness/2;_t(O,y,Et/vt),_t(O,e,!0),_t(O,t,Math.round(Et)),_t(O,s,Math.round(vt));for(const{bezier:xt}of R.paths){const Ut=[];O.paths.push(Ut);let Mt=Pt*(xt[0]-Rt),jt=Pt*(vt-xt[1]-Rt);for(let Lt=2,Ht=xt.length;Lt<Ht;Lt+=6){const Gt=Pt*(xt[Lt]-Rt),Nt=Pt*(vt-xt[Lt+1]-Rt),Xt=Pt*(xt[Lt+2]-Rt),Vt=Pt*(vt-xt[Lt+3]-Rt),Kt=Pt*(xt[Lt+4]-Rt),Ce=Pt*(vt-xt[Lt+5]-Rt);Ut.push([[Mt,jt],[Gt,Nt],[Xt,Vt],[Kt,Ce]]),Mt=Kt,jt=Ce}const Bt=ht(this,M,_e).call(this,Ut);O.bezierPath2D.push(Bt)}const wt=ht(Ot=O,mt,be).call(Ot);return _t(O,A,Math.max(G,wt[2]-wt[0])),_t(O,F,Math.max(G,wt[3]-wt[1])),ht(Dt=O,i,me).call(Dt,Et,vt),O}serialize(){if(this.isEmpty())return null;const R=this.getRect(0,0),k=this.rotation%180===0?R[3]-R[1]:R[2]-R[0],O=x.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:m.AnnotationEditorType.INK,color:O,thickness:this.thickness,opacity:this.opacity,paths:ht(this,Z,Ge).call(this,this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,k),pageIndex:this.parent.pageIndex,rect:R,rotation:this.rotation}}};let v=Ct;y=new WeakMap,F=new WeakMap,A=new WeakMap,p=new WeakMap,c=new WeakMap,h=new WeakMap,n=new WeakMap,e=new WeakMap,o=new WeakMap,r=new WeakMap,l=new WeakMap,t=new WeakMap,s=new WeakMap,_=new WeakMap,C=new WeakSet,Ne=function(R){const k=this.thickness;this.parent.addCommands({cmd:()=>{this.thickness=R,ht(this,St,Yt).call(this)},undo:()=>{this.thickness=k,ht(this,St,Yt).call(this)},mustExec:!0,type:m.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},E=new WeakSet,Ue=function(R){const k=this.color;this.parent.addCommands({cmd:()=>{this.color=R,ht(this,a,zt).call(this)},undo:()=>{this.color=k,ht(this,a,zt).call(this)},mustExec:!0,type:m.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Q=new WeakSet,je=function(R){R/=100;const k=this.opacity;this.parent.addCommands({cmd:()=>{this.opacity=R,ht(this,a,zt).call(this)},undo:()=>{this.opacity=k,ht(this,a,zt).call(this)},mustExec:!0,type:m.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},rt=new WeakSet,Be=function(){const{width:R,height:k,rotation:O}=this.parent.viewport;switch(O){case 90:return[0,R,R,k];case 180:return[R,k,R,k];case 270:return[k,0,R,k];default:return[0,0,R,k]}},W=new WeakSet,pe=function(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle=`${this.color}${(0,z.opacityToHex)(this.opacity)}`},tt=new WeakSet,We=function(R,k){this.isEditing=!0,S(this,o)||(_t(this,o,!0),ht(this,K,$t).call(this),this.thickness||(this.thickness=Ct._defaultThickness),this.color||(this.color=Ct._defaultColor||x.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=Ct._defaultOpacity)),this.currentPath.push([R,k]),_t(this,r,null),ht(this,W,pe).call(this),this.ctx.beginPath(),this.ctx.moveTo(R,k),_t(this,_,()=>{!S(this,_)||(S(this,r)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):ht(this,a,zt).call(this),this.ctx.lineTo(...S(this,r)),_t(this,r,null),this.ctx.stroke()),window.requestAnimationFrame(S(this,_)))}),window.requestAnimationFrame(S(this,_))},ft=new WeakSet,qe=function(R,k){const[O,dt]=this.currentPath.at(-1);R===O&&k===dt||(this.currentPath.push([R,k]),_t(this,r,[R,k]))},I=new WeakSet,He=function(R,k){var Rt;this.ctx.closePath(),_t(this,_,null),R=Math.min(Math.max(R,0),this.canvas.width),k=Math.min(Math.max(k,0),this.canvas.height);const[O,dt]=this.currentPath.at(-1);(R!==O||k!==dt)&&this.currentPath.push([R,k]);let At;if(this.currentPath.length!==1)At=(0,X.fitCurve)(this.currentPath,30,null);else{const wt=[R,k];At=[[wt,wt.slice(),wt.slice(),wt]]}const Et=ht(Rt=Ct,M,_e).call(Rt,At);this.currentPath.length=0;const vt=()=>{this.paths.push(At),this.bezierPath2D.push(Et),this.rebuild()},Pt=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(ht(this,N,Zt).call(this),ht(this,Y,te).call(this)),ht(this,St,Yt).call(this))};this.parent.addCommands({cmd:vt,undo:Pt,mustExec:!0})},a=new WeakSet,zt=function(){if(this.isEmpty()){ht(this,g,ee).call(this);return}ht(this,W,pe).call(this);const{canvas:R,ctx:k}=this;k.setTransform(1,0,0,1,0,0),k.clearRect(0,0,R.width,R.height),ht(this,g,ee).call(this);for(const O of this.bezierPath2D)k.stroke(O)},w=new WeakSet,ge=function(R){ht(this,I,He).call(this,R.offsetX,R.offsetY),this.canvas.removeEventListener("pointerleave",S(this,c)),this.canvas.removeEventListener("pointermove",S(this,p)),this.parent.addToAnnotationStorage(this)},N=new WeakSet,Zt=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",Ct._l10nPromise.get("editor_ink_canvas_aria_label").then(R=>{var k;return(k=this.canvas)==null?void 0:k.setAttribute("aria-label",R)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Y=new WeakSet,te=function(){let R=null;_t(this,l,new ResizeObserver(k=>{const O=k[0].contentRect;O.width&&O.height&&(R!==null&&clearTimeout(R),R=setTimeout(()=>{this.fixDims(),R=null},j),this.setDimensions(O.width,O.height))})),S(this,l).observe(this.div)},K=new WeakSet,$t=function(){if(!S(this,o))return;const[R,k]=this.parent.viewportBaseDimensions;this.canvas.width=Math.ceil(this.width*R),this.canvas.height=Math.ceil(this.height*k),ht(this,g,ee).call(this)},i=new WeakSet,me=function(R,k){const O=ht(this,q,se).call(this),dt=(R-O)/S(this,A),At=(k-O)/S(this,F);this.scaleFactor=Math.min(dt,At)},g=new WeakSet,ee=function(){const R=ht(this,q,se).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+R,this.translationY*this.scaleFactor+R)},M=new WeakSet,_e=function(R){const k=new Path2D;for(let O=0,dt=R.length;O<dt;O++){const[At,Et,vt,Pt]=R[O];O===0&&k.moveTo(...At),k.bezierCurveTo(Et[0],Et[1],vt[0],vt[1],Pt[0],Pt[1])}return k},Z=new WeakSet,Ge=function(R,k,O,dt){const Et=[],vt=this.thickness/2;let Pt,Rt;for(const wt of this.paths){Pt=[],Rt=[];for(let Ot=0,Dt=wt.length;Ot<Dt;Ot++){const[xt,Ut,Mt,jt]=wt[Ot],Bt=R*(xt[0]+k)+vt,Lt=dt-R*(xt[1]+O)-vt,Ht=R*(Ut[0]+k)+vt,Gt=dt-R*(Ut[1]+O)-vt,Nt=R*(Mt[0]+k)+vt,Xt=dt-R*(Mt[1]+O)-vt,Vt=R*(jt[0]+k)+vt,Kt=dt-R*(jt[1]+O)-vt;Ot===0&&(Pt.push(Bt,Lt),Rt.push(Bt,Lt)),Pt.push(Ht,Gt,Nt,Xt,Vt,Kt),ht(this,st,Xe).call(this,Bt,Lt,Ht,Gt,Nt,Xt,Vt,Kt,4,Rt)}Et.push({bezier:Pt,points:Rt})}return Et},st=new WeakSet,Xe=function(R,k,O,dt,At,Et,vt,Pt,Rt,wt){if(ht(this,B,ze).call(this,R,k,O,dt,At,Et,vt,Pt)){wt.push(vt,Pt);return}for(let Ot=1;Ot<Rt-1;Ot++){const Dt=Ot/Rt,xt=1-Dt;let Ut=Dt*R+xt*O,Mt=Dt*k+xt*dt,jt=Dt*O+xt*At,Bt=Dt*dt+xt*Et;const Lt=Dt*At+xt*vt,Ht=Dt*Et+xt*Pt;Ut=Dt*Ut+xt*jt,Mt=Dt*Mt+xt*Bt,jt=Dt*jt+xt*Lt,Bt=Dt*Bt+xt*Ht,Ut=Dt*Ut+xt*jt,Mt=Dt*Mt+xt*Bt,wt.push(Ut,Mt)}wt.push(vt,Pt)},B=new WeakSet,ze=function(R,k,O,dt,At,Et,vt,Pt){const wt=(3*O-2*R-vt)**2,Ot=(3*dt-2*k-Pt)**2,Dt=(3*At-R-2*vt)**2,xt=(3*Et-k-2*Pt)**2;return Math.max(wt,Dt)+Math.max(Ot,xt)<=10},mt=new WeakSet,be=function(){let R=1/0,k=-1/0,O=1/0,dt=-1/0;for(const At of this.paths)for(const[Et,vt,Pt,Rt]of At){const wt=m.Util.bezierBoundingBox(...Et,...vt,...Pt,...Rt);R=Math.min(R,wt[0]),O=Math.min(O,wt[1]),k=Math.max(k,wt[2]),dt=Math.max(dt,wt[3])}return[R,O,k,dt]},q=new WeakSet,se=function(){return S(this,e)?Math.ceil(this.thickness*this.parent.scaleFactor):0},St=new WeakSet,Yt=function(R=!1){if(this.isEmpty())return;if(!S(this,e)){ht(this,a,zt).call(this);return}const k=ht(this,mt,be).call(this),O=ht(this,q,se).call(this);_t(this,A,Math.max(G,k[2]-k[0])),_t(this,F,Math.max(G,k[3]-k[1]));const dt=Math.ceil(O+S(this,A)*this.scaleFactor),At=Math.ceil(O+S(this,F)*this.scaleFactor),[Et,vt]=this.parent.viewportBaseDimensions;this.width=dt/Et,this.height=At/vt,_t(this,y,dt/At),ht(this,Ft,Ae).call(this);const Pt=this.translationX,Rt=this.translationY;this.translationX=-k[0],this.translationY=-k[1],ht(this,K,$t).call(this),ht(this,a,zt).call(this),_t(this,t,dt),_t(this,s,At),this.setDims(dt,At);const wt=R?O/this.scaleFactor/2:0;this.translate(Pt-this.translationX-wt,Rt-this.translationY-wt)},Ft=new WeakSet,Ae=function(){const{style:R}=this.div;S(this,y)>=1?(R.minHeight=`${G}px`,R.minWidth=`${Math.round(S(this,y)*G)}px`):(R.minWidth=`${G}px`,R.minHeight=`${Math.round(G/S(this,y))}px`)},it(v,M),It(v,"_defaultColor",null),It(v,"_defaultOpacity",1),It(v,"_defaultThickness",1),It(v,"_l10nPromise"),It(v,"_type","ink"),f.InkEditor=v},(ot,f,J)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.fitCurve=void 0;const m=J(25);f.fitCurve=m},ot=>{function f(c,h,n){if(!Array.isArray(c))throw new TypeError("First argument should be an array");if(c.forEach(l=>{if(!Array.isArray(l)||l.some(t=>typeof t!="number")||l.length!==c[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),c=c.filter((l,t)=>t===0||!l.every((s,_)=>s===c[t-1][_])),c.length<2)return[];const e=c.length,o=F(c[1],c[0]),r=F(c[e-2],c[e-1]);return J(c,o,r,h,n)}function J(c,h,n,e,o){var l,t,s,_,C,D,E,T,Q,ct,rt,V,W;if(c.length===2)return V=A.vectorLen(A.subtract(c[0],c[1]))/3,l=[c[0],A.addArrays(c[0],A.mulItems(h,V)),A.addArrays(c[1],A.mulItems(n,V)),c[1]],[l];if(t=G(c),[l,_,D]=m(c,t,t,h,n,o),_===0||_<e)return[l];if(_<e*e)for(s=t,C=_,E=D,W=0;W<20;W++){if(s=X(l,c,s),[l,_,D]=m(c,t,s,h,n,o),_<e)return[l];if(D===E){let $=_/C;if($>.9999&&$<1.0001)break}C=_,E=D}return rt=[],T=A.subtract(c[D-1],c[D+1]),T.every($=>$===0)&&(T=A.subtract(c[D-1],c[D]),[T[0],T[1]]=[-T[1],T[0]]),Q=A.normalize(T),ct=A.mulItems(Q,-1),rt=rt.concat(J(c.slice(0,D+1),h,Q,e,o)),rt=rt.concat(J(c.slice(D),ct,n,e,o)),rt}function m(c,h,n,e,o,r){var l,t,s;return l=x(c,n,e,o),[t,s]=j(c,l,h),r&&r({bez:l,points:c,params:h,maxErr:t,maxPoint:s}),[l,t,s]}function x(c,h,n,e){var o,r,l,t,s,_,C,D,E,T,Q,ct,rt,V,W,$,tt,nt=c[0],ft=c[c.length-1];for(o=[nt,null,null,ft],r=A.zeros_Xx2x2(h.length),rt=0,V=h.length;rt<V;rt++)$=h[rt],tt=1-$,l=r[rt],l[0]=A.mulItems(n,3*$*(tt*tt)),l[1]=A.mulItems(e,3*tt*($*$));for(t=[[0,0],[0,0]],s=[0,0],rt=0,V=c.length;rt<V;rt++)$=h[rt],l=r[rt],t[0][0]+=A.dot(l[0],l[0]),t[0][1]+=A.dot(l[0],l[1]),t[1][0]+=A.dot(l[0],l[1]),t[1][1]+=A.dot(l[1],l[1]),W=A.subtract(c[rt],p.q([nt,nt,ft,ft],$)),s[0]+=A.dot(l[0],W),s[1]+=A.dot(l[1],W);return _=t[0][0]*t[1][1]-t[1][0]*t[0][1],C=t[0][0]*s[1]-t[1][0]*s[0],D=s[0]*t[1][1]-s[1]*t[0][1],E=_===0?0:D/_,T=_===0?0:C/_,ct=A.vectorLen(A.subtract(nt,ft)),Q=1e-6*ct,E<Q||T<Q?(o[1]=A.addArrays(nt,A.mulItems(n,ct/3)),o[2]=A.addArrays(ft,A.mulItems(e,ct/3))):(o[1]=A.addArrays(nt,A.mulItems(n,E)),o[2]=A.addArrays(ft,A.mulItems(e,T))),o}function X(c,h,n){return n.map((e,o)=>z(c,h[o],e))}function z(c,h,n){var e=A.subtract(p.q(c,n),h),o=p.qprime(c,n),r=A.mulMatrix(e,o),l=A.sum(A.squareItems(o))+2*A.mulMatrix(e,p.qprimeprime(c,n));return l===0?n:n-r/l}function G(c){var h=[],n,e,o;return c.forEach((r,l)=>{n=l?e+A.vectorLen(A.subtract(r,o)):0,h.push(n),e=n,o=r}),h=h.map(r=>r/e),h}function j(c,h,n){var e,o,r,l,t,s,_,C;o=0,r=Math.floor(c.length/2);const D=v(h,10);for(t=0,s=c.length;t<s;t++)_=c[t],C=y(h,n[t],D,10),l=A.subtract(p.q(h,C),_),e=l[0]*l[0]+l[1]*l[1],e>o&&(o=e,r=t);return[o,r]}var v=function(c,h){for(var n,e=[0],o=c[0],r=0,l=1;l<=h;l++)n=p.q(c,l/h),r+=A.vectorLen(A.subtract(n,o)),e.push(r),o=n;return e=e.map(t=>t/r),e};function y(c,h,n,e){if(h<0)return 0;if(h>1)return 1;for(var o,r,l,t,s,_=1;_<=e;_++)if(h<=n[_]){t=(_-1)/e,l=_/e,r=n[_-1],o=n[_],s=(h-r)/(o-r)*(l-t)+t;break}return s}function F(c,h){return A.normalize(A.subtract(c,h))}class A{static zeros_Xx2x2(h){for(var n=[];h--;)n.push([0,0]);return n}static mulItems(h,n){return h.map(e=>e*n)}static mulMatrix(h,n){return h.reduce((e,o,r)=>e+o*n[r],0)}static subtract(h,n){return h.map((e,o)=>e-n[o])}static addArrays(h,n){return h.map((e,o)=>e+n[o])}static addItems(h,n){return h.map(e=>e+n)}static sum(h){return h.reduce((n,e)=>n+e)}static dot(h,n){return A.mulMatrix(h,n)}static vectorLen(h){return Math.hypot(...h)}static divItems(h,n){return h.map(e=>e/n)}static squareItems(h){return h.map(n=>n*n)}static normalize(h){return this.divItems(h,this.vectorLen(h))}}class p{static q(h,n){var e=1-n,o=A.mulItems(h[0],e*e*e),r=A.mulItems(h[1],3*e*e*n),l=A.mulItems(h[2],3*e*n*n),t=A.mulItems(h[3],n*n*n);return A.addArrays(A.addArrays(o,r),A.addArrays(l,t))}static qprime(h,n){var e=1-n,o=A.mulItems(A.subtract(h[1],h[0]),3*e*e),r=A.mulItems(A.subtract(h[2],h[1]),6*e*n),l=A.mulItems(A.subtract(h[3],h[2]),3*n*n);return A.addArrays(A.addArrays(o,r),l)}static qprimeprime(h,n){return A.addArrays(A.mulItems(A.addArrays(A.subtract(h[2],A.mulItems(h[1],2)),h[0]),6*(1-n)),A.mulItems(A.addArrays(A.subtract(h[3],A.mulItems(h[2],2)),h[1]),6*n))}}ot.exports=f,ot.exports.fitCubic=J,ot.exports.createTangent=F},(ot,f,J)=>{var d,Ve,w,ye,N,ve,Y,Se;Object.defineProperty(f,"__esModule",{value:!0}),f.AnnotationLayer=void 0;var m=J(1),x=J(6),X=J(3),z=J(27),G=J(28);const j=1e3,v=9,y=new WeakSet;function F(et){return{width:et[2]-et[0],height:et[3]-et[1]}}class A{static create(i){switch(i.data.annotationType){case m.AnnotationType.LINK:return new c(i);case m.AnnotationType.TEXT:return new h(i);case m.AnnotationType.WIDGET:switch(i.data.fieldType){case"Tx":return new e(i);case"Btn":return i.data.radioButton?new r(i):i.data.checkBox?new o(i):new l(i);case"Ch":return new t(i)}return new n(i);case m.AnnotationType.POPUP:return new s(i);case m.AnnotationType.FREETEXT:return new C(i);case m.AnnotationType.LINE:return new D(i);case m.AnnotationType.SQUARE:return new E(i);case m.AnnotationType.CIRCLE:return new T(i);case m.AnnotationType.POLYLINE:return new Q(i);case m.AnnotationType.CARET:return new rt(i);case m.AnnotationType.INK:return new V(i);case m.AnnotationType.POLYGON:return new ct(i);case m.AnnotationType.HIGHLIGHT:return new W(i);case m.AnnotationType.UNDERLINE:return new $(i);case m.AnnotationType.SQUIGGLY:return new tt(i);case m.AnnotationType.STRIKEOUT:return new nt(i);case m.AnnotationType.STAMP:return new ft(i);case m.AnnotationType.FILEATTACHMENT:return new bt(i);default:return new p(i)}}}class p{constructor(i,{isRenderable:u=!1,ignoreBorder:g=!1,createQuadrilaterals:P=!1}={}){this.isRenderable=u,this.data=i.data,this.layer=i.layer,this.page=i.page,this.viewport=i.viewport,this.linkService=i.linkService,this.downloadManager=i.downloadManager,this.imageResourcesPath=i.imageResourcesPath,this.renderForms=i.renderForms,this.svgFactory=i.svgFactory,this.annotationStorage=i.annotationStorage,this.enableScripting=i.enableScripting,this.hasJSActions=i.hasJSActions,this._fieldObjects=i.fieldObjects,this._mouseState=i.mouseState,u&&(this.container=this._createContainer(g)),P&&(this.quadrilaterals=this._createQuadrilaterals(g))}_createContainer(i=!1){const u=this.data,g=this.page,P=this.viewport,M=document.createElement("section"),{width:U,height:Z}=F(u.rect),[lt,st,gt,B]=P.viewBox,pt=gt-lt,mt=B-st;M.setAttribute("data-annotation-id",u.id);const yt=m.Util.normalizeRect([u.rect[0],g.view[3]-u.rect[1]+g.view[1],u.rect[2],g.view[3]-u.rect[3]+g.view[1]]);if(!i&&u.borderStyle.width>0){M.style.borderWidth=`${u.borderStyle.width}px`;const ut=u.borderStyle.horizontalCornerRadius,St=u.borderStyle.verticalCornerRadius;if(ut>0||St>0){const Ft=`calc(${ut}px * var(--scale-factor)) / calc(${St}px * var(--scale-factor))`;M.style.borderRadius=Ft}else if(this instanceof r){const Ft=`calc(${U}px * var(--scale-factor)) / calc(${Z}px * var(--scale-factor))`;M.style.borderRadius=Ft}switch(u.borderStyle.style){case m.AnnotationBorderStyleType.SOLID:M.style.borderStyle="solid";break;case m.AnnotationBorderStyleType.DASHED:M.style.borderStyle="dashed";break;case m.AnnotationBorderStyleType.BEVELED:(0,m.warn)("Unimplemented border style: beveled");break;case m.AnnotationBorderStyleType.INSET:(0,m.warn)("Unimplemented border style: inset");break;case m.AnnotationBorderStyleType.UNDERLINE:M.style.borderBottomStyle="solid";break}const Tt=u.borderColor||null;Tt?M.style.borderColor=m.Util.makeHexColor(Tt[0]|0,Tt[1]|0,Tt[2]|0):M.style.borderWidth=0}M.style.left=`${100*(yt[0]-lt)/pt}%`,M.style.top=`${100*(yt[1]-st)/mt}%`;const{rotation:q}=u;return u.hasOwnCanvas||q===0?(M.style.width=`${100*U/pt}%`,M.style.height=`${100*Z/mt}%`):this.setRotation(q,M),M}setRotation(i,u=this.container){const[g,P,M,U]=this.viewport.viewBox,Z=M-g,lt=U-P,{width:st,height:gt}=F(this.data.rect);let B,pt;i%180===0?(B=100*st/Z,pt=100*gt/lt):(B=100*gt/Z,pt=100*st/lt),u.style.width=`${B}%`,u.style.height=`${pt}%`,u.setAttribute("data-main-rotation",(360-i)%360)}get _commonActions(){const i=(u,g,P)=>{const M=P.detail[u];P.target.style[g]=z.ColorConverters[`${M[0]}_HTML`](M.slice(1))};return(0,m.shadow)(this,"_commonActions",{display:u=>{const g=u.detail.display%2===1;this.container.style.visibility=g?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:g,print:u.detail.display===0||u.detail.display===3})},print:u=>{this.annotationStorage.setValue(this.data.id,{print:u.detail.print})},hidden:u=>{this.container.style.visibility=u.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:u.detail.hidden})},focus:u=>{setTimeout(()=>u.target.focus({preventScroll:!1}),0)},userName:u=>{u.target.title=u.detail.userName},readonly:u=>{u.detail.readonly?u.target.setAttribute("readonly",""):u.target.removeAttribute("readonly")},required:u=>{this._setRequired(u.target,u.detail.required)},bgColor:u=>{i("bgColor","backgroundColor",u)},fillColor:u=>{i("fillColor","backgroundColor",u)},fgColor:u=>{i("fgColor","color",u)},textColor:u=>{i("textColor","color",u)},borderColor:u=>{i("borderColor","borderColor",u)},strokeColor:u=>{i("strokeColor","borderColor",u)},rotation:u=>{const g=u.detail.rotation;this.setRotation(g),this.annotationStorage.setValue(this.data.id,{rotation:g})}})}_dispatchEventFromSandbox(i,u){const g=this._commonActions;for(const P of Object.keys(u.detail)){const M=i[P]||g[P];M==null||M(u)}}_setDefaultPropertiesFromJS(i){if(!this.enableScripting)return;const u=this.annotationStorage.getRawValue(this.data.id);if(!u)return;const g=this._commonActions;for(const[P,M]of Object.entries(u)){const U=g[P];if(U){const Z={detail:{[P]:M},target:i};U(Z),delete u[P]}}}_createQuadrilaterals(i=!1){if(!this.data.quadPoints)return null;const u=[],g=this.data.rect;for(const P of this.data.quadPoints)this.data.rect=[P[2].x,P[2].y,P[1].x,P[1].y],u.push(this._createContainer(i));return this.data.rect=g,u}_createPopup(i,u){let g=this.container;this.quadrilaterals&&(i=i||this.quadrilaterals,g=this.quadrilaterals[0]),i||(i=document.createElement("div"),i.className="popupTriggerArea",g.append(i));const M=new _({container:g,trigger:i,color:u.color,titleObj:u.titleObj,modificationDate:u.modificationDate,contentsObj:u.contentsObj,richText:u.richText,hideWrapper:!0}).render();M.style.left="100%",g.append(M)}_renderQuadrilaterals(i){for(const u of this.quadrilaterals)u.className=i;return this.quadrilaterals}render(){(0,m.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(i,u=null){const g=[];if(this._fieldObjects){const P=this._fieldObjects[i];if(P)for(const{page:M,id:U,exportValues:Z}of P){if(M===-1||U===u)continue;const lt=typeof Z=="string"?Z:null,st=document.querySelector(`[data-element-id="${U}"]`);if(st&&!y.has(st)){(0,m.warn)(`_getElementsByName - element not allowed: ${U}`);continue}g.push({id:U,exportValue:lt,domElement:st})}return g}for(const P of document.getElementsByName(i)){const{exportValue:M}=P,U=P.getAttribute("data-element-id");U!==u&&(!y.has(P)||g.push({id:U,exportValue:M,domElement:P}))}return g}static get platform(){const i=typeof navigator<"u"?navigator.platform:"";return(0,m.shadow)(this,"platform",{isWin:i.includes("Win"),isMac:i.includes("Mac")})}}class c extends p{constructor(u,g=null){super(u,{isRenderable:!0,ignoreBorder:!!(g!=null&&g.ignoreBorder),createQuadrilaterals:!0});it(this,d);this.isTooltipOnly=u.data.isTooltipOnly}render(){const{data:u,linkService:g}=this,P=document.createElement("a");P.setAttribute("data-element-id",u.id);let M=!1;return u.url?(g.addLinkAttributes(P,u.url,u.newWindow),M=!0):u.action?(this._bindNamedAction(P,u.action),M=!0):u.attachment?(this._bindAttachment(P,u.attachment),M=!0):u.setOCGState?(ht(this,d,Ve).call(this,P,u.setOCGState),M=!0):u.dest?(this._bindLink(P,u.dest),M=!0):(u.actions&&(u.actions.Action||u.actions["Mouse Up"]||u.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(P,u),M=!0),u.resetForm?(this._bindResetFormAction(P,u.resetForm),M=!0):this.isTooltipOnly&&!M&&(this._bindLink(P,""),M=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((U,Z)=>{const lt=Z===0?P:P.cloneNode();return U.append(lt),U}):(this.container.className="linkAnnotation",M&&this.container.append(P),this.container)}_bindLink(u,g){u.href=this.linkService.getDestinationHash(g),u.onclick=()=>(g&&this.linkService.goToDestination(g),!1),(g||g==="")&&(u.className="internalLink")}_bindNamedAction(u,g){u.href=this.linkService.getAnchorUrl(""),u.onclick=()=>(this.linkService.executeNamedAction(g),!1),u.className="internalLink"}_bindAttachment(u,g){u.href=this.linkService.getAnchorUrl(""),u.onclick=()=>{var P;return(P=this.downloadManager)==null||P.openOrDownloadData(this.container,g.content,g.filename),!1},u.className="internalLink"}_bindJSAction(u,g){u.href=this.linkService.getAnchorUrl("");const P=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const M of Object.keys(g.actions)){const U=P.get(M);!U||(u[U]=()=>{var Z;return(Z=this.linkService.eventBus)==null||Z.dispatch("dispatcheventinsandbox",{source:this,detail:{id:g.id,name:M}}),!1})}u.onclick||(u.onclick=()=>!1),u.className="internalLink"}_bindResetFormAction(u,g){const P=u.onclick;if(P||(u.href=this.linkService.getAnchorUrl("")),u.className="internalLink",!this._fieldObjects){(0,m.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),P||(u.onclick=()=>!1);return}u.onclick=()=>{var B;P==null||P();const{fields:M,refs:U,include:Z}=g,lt=[];if(M.length!==0||U.length!==0){const pt=new Set(U);for(const mt of M){const yt=this._fieldObjects[mt]||[];for(const{id:q}of yt)pt.add(q)}for(const mt of Object.values(this._fieldObjects))for(const yt of mt)pt.has(yt.id)===Z&&lt.push(yt)}else for(const pt of Object.values(this._fieldObjects))lt.push(...pt);const st=this.annotationStorage,gt=[];for(const pt of lt){const{id:mt}=pt;switch(gt.push(mt),pt.type){case"text":{const q=pt.defaultValue||"";st.setValue(mt,{value:q});break}case"checkbox":case"radiobutton":{const q=pt.defaultValue===pt.exportValues;st.setValue(mt,{value:q});break}case"combobox":case"listbox":{const q=pt.defaultValue||"";st.setValue(mt,{value:q});break}default:continue}const yt=document.querySelector(`[data-element-id="${mt}"]`);if(yt){if(!y.has(yt)){(0,m.warn)(`_bindResetFormAction - element not allowed: ${mt}`);continue}}else continue;yt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((B=this.linkService.eventBus)==null||B.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:gt,name:"ResetForm"}})),!1}}}d=new WeakSet,Ve=function(u,g){u.href=this.linkService.getAnchorUrl(""),u.onclick=()=>(this.linkService.executeSetOCGState(g),!1),u.className="internalLink"};class h extends p{constructor(i){var g,P,M;const u=!!(i.data.hasPopup||((g=i.data.titleObj)==null?void 0:g.str)||((P=i.data.contentsObj)==null?void 0:P.str)||((M=i.data.richText)==null?void 0:M.str));super(i,{isRenderable:u})}render(){this.container.className="textAnnotation";const i=document.createElement("img");return i.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",i.alt="[{{type}} Annotation]",i.dataset.l10nId="text_annotation_type",i.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(i,this.data),this.container.append(i),this.container}}class n extends p{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(i){const{isWin:u,isMac:g}=p.platform;return u&&i.ctrlKey||g&&i.metaKey}_setEventListener(i,u,g,P){u.includes("mouse")?i.addEventListener(u,M=>{var U;(U=this.linkService.eventBus)==null||U.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:g,value:P(M),shift:M.shiftKey,modifier:this._getKeyModifier(M)}})}):i.addEventListener(u,M=>{var U;(U=this.linkService.eventBus)==null||U.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:g,value:P(M)}})})}_setEventListeners(i,u,g){var P;for(const[M,U]of u)(U==="Action"||((P=this.data.actions)==null?void 0:P[U]))&&this._setEventListener(i,M,U,g)}_setBackgroundColor(i){const u=this.data.backgroundColor||null;i.style.backgroundColor=u===null?"transparent":m.Util.makeHexColor(u[0],u[1],u[2])}_setTextStyle(i){const u=["left","center","right"],{fontColor:g}=this.data.defaultAppearanceData,P=this.data.defaultAppearanceData.fontSize||v,M=i.style;let U;const Z=2,lt=st=>Math.round(10*st)/10;if(this.data.multiLine){const st=Math.abs(this.data.rect[3]-this.data.rect[1]-Z),gt=Math.round(st/(m.LINE_FACTOR*P))||1,B=st/gt;U=Math.min(P,lt(B/m.LINE_FACTOR))}else{const st=Math.abs(this.data.rect[3]-this.data.rect[1]-Z);U=Math.min(P,lt(st/m.LINE_FACTOR))}M.fontSize=`calc(${U}px * var(--scale-factor))`,M.color=m.Util.makeHexColor(g[0],g[1],g[2]),this.data.textAlignment!==null&&(M.textAlign=u[this.data.textAlignment])}_setRequired(i,u){u?i.setAttribute("required",!0):i.removeAttribute("required"),i.setAttribute("aria-required",u)}}class e extends n{constructor(i){const u=i.renderForms||!i.data.hasAppearance&&!!i.data.fieldValue;super(i,{isRenderable:u})}setPropertyOnSiblings(i,u,g,P){const M=this.annotationStorage;for(const U of this._getElementsByName(i.name,i.id))U.domElement&&(U.domElement[u]=g),M.setValue(U.id,{[P]:g})}render(){var P;const i=this.annotationStorage,u=this.data.id;this.container.className="textWidgetAnnotation";let g=null;if(this.renderForms){const M=i.getValue(u,{value:this.data.fieldValue});let U=M.formattedValue||M.value||"";const Z=i.getValue(u,{charLimit:this.data.maxLen}).charLimit;Z&&U.length>Z&&(U=U.slice(0,Z));const lt={userValue:U,formattedValue:null,valueOnFocus:""};this.data.multiLine?(g=document.createElement("textarea"),g.textContent=U,this.data.doNotScroll&&(g.style.overflowY="hidden")):(g=document.createElement("input"),g.type="text",g.setAttribute("value",U),this.data.doNotScroll&&(g.style.overflowX="hidden")),y.add(g),g.setAttribute("data-element-id",u),g.disabled=this.data.readOnly,g.name=this.data.fieldName,g.tabIndex=j,this._setRequired(g,this.data.required),Z&&(g.maxLength=Z),g.addEventListener("input",gt=>{i.setValue(u,{value:gt.target.value}),this.setPropertyOnSiblings(g,"value",gt.target.value,"value")}),g.addEventListener("resetform",gt=>{const B=this.data.defaultFieldValue??"";g.value=lt.userValue=B,lt.formattedValue=null});let st=gt=>{const{formattedValue:B}=lt;B!=null&&(gt.target.value=B),gt.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){g.addEventListener("focus",B=>{lt.userValue&&(B.target.value=lt.userValue),lt.valueOnFocus=B.target.value}),g.addEventListener("updatefromsandbox",B=>{const pt={value(mt){lt.userValue=mt.detail.value??"",i.setValue(u,{value:lt.userValue.toString()}),mt.target.value=lt.userValue},formattedValue(mt){const{formattedValue:yt}=mt.detail;lt.formattedValue=yt,yt!=null&&mt.target!==document.activeElement&&(mt.target.value=yt),i.setValue(u,{formattedValue:yt})},selRange(mt){mt.target.setSelectionRange(...mt.detail.selRange)},charLimit:mt=>{var St;const{charLimit:yt}=mt.detail,{target:q}=mt;if(yt===0){q.removeAttribute("maxLength");return}q.setAttribute("maxLength",yt);let ut=lt.userValue;!ut||ut.length<=yt||(ut=ut.slice(0,yt),q.value=lt.userValue=ut,i.setValue(u,{value:ut}),(St=this.linkService.eventBus)==null||St.dispatch("dispatcheventinsandbox",{source:this,detail:{id:u,name:"Keystroke",value:ut,willCommit:!0,commitKey:1,selStart:q.selectionStart,selEnd:q.selectionEnd}}))}};this._dispatchEventFromSandbox(pt,B)}),g.addEventListener("keydown",B=>{var yt;let pt=-1;if(B.key==="Escape"?pt=0:B.key==="Enter"&&!this.data.multiLine?pt=2:B.key==="Tab"&&(pt=3),pt===-1)return;const{value:mt}=B.target;lt.valueOnFocus!==mt&&(lt.userValue=mt,(yt=this.linkService.eventBus)==null||yt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:u,name:"Keystroke",value:mt,willCommit:!0,commitKey:pt,selStart:B.target.selectionStart,selEnd:B.target.selectionEnd}}))});const gt=st;st=null,g.addEventListener("blur",B=>{var mt;const{value:pt}=B.target;lt.userValue=pt,this._mouseState.isDown&&lt.valueOnFocus!==pt&&((mt=this.linkService.eventBus)==null||mt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:u,name:"Keystroke",value:pt,willCommit:!0,commitKey:1,selStart:B.target.selectionStart,selEnd:B.target.selectionEnd}})),gt(B)}),(P=this.data.actions)!=null&&P.Keystroke&&g.addEventListener("beforeinput",B=>{var Ft;const{data:pt,target:mt}=B,{value:yt,selectionStart:q,selectionEnd:ut}=mt;let St=q,Tt=ut;switch(B.inputType){case"deleteWordBackward":{const kt=yt.substring(0,q).match(/\w*[^\w]*$/);kt&&(St-=kt[0].length);break}case"deleteWordForward":{const kt=yt.substring(q).match(/^[^\w]*\w*/);kt&&(Tt+=kt[0].length);break}case"deleteContentBackward":q===ut&&(St-=1);break;case"deleteContentForward":q===ut&&(Tt+=1);break}B.preventDefault(),(Ft=this.linkService.eventBus)==null||Ft.dispatch("dispatcheventinsandbox",{source:this,detail:{id:u,name:"Keystroke",value:yt,change:pt||"",willCommit:!1,selStart:St,selEnd:Tt}})}),this._setEventListeners(g,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],B=>B.target.value)}if(st&&g.addEventListener("blur",st),this.data.comb){const B=(this.data.rect[2]-this.data.rect[0])/Z;g.classList.add("comb"),g.style.letterSpacing=`calc(${B}px * var(--scale-factor) - 1ch)`}}else g=document.createElement("div"),g.textContent=this.data.fieldValue,g.style.verticalAlign="middle",g.style.display="table-cell";return this._setTextStyle(g),this._setBackgroundColor(g),this._setDefaultPropertiesFromJS(g),this.container.append(g),this.container}}class o extends n{constructor(i){super(i,{isRenderable:i.renderForms})}render(){const i=this.annotationStorage,u=this.data,g=u.id;let P=i.getValue(g,{value:u.exportValue===u.fieldValue}).value;typeof P=="string"&&(P=P!=="Off",i.setValue(g,{value:P})),this.container.className="buttonWidgetAnnotation checkBox";const M=document.createElement("input");return y.add(M),M.setAttribute("data-element-id",g),M.disabled=u.readOnly,this._setRequired(M,this.data.required),M.type="checkbox",M.name=u.fieldName,P&&M.setAttribute("checked",!0),M.setAttribute("exportValue",u.exportValue),M.tabIndex=j,M.addEventListener("change",U=>{const{name:Z,checked:lt}=U.target;for(const st of this._getElementsByName(Z,g)){const gt=lt&&st.exportValue===u.exportValue;st.domElement&&(st.domElement.checked=gt),i.setValue(st.id,{value:gt})}i.setValue(g,{value:lt})}),M.addEventListener("resetform",U=>{const Z=u.defaultFieldValue||"Off";U.target.checked=Z===u.exportValue}),this.enableScripting&&this.hasJSActions&&(M.addEventListener("updatefromsandbox",U=>{const Z={value(lt){lt.target.checked=lt.detail.value!=="Off",i.setValue(g,{value:lt.target.checked})}};this._dispatchEventFromSandbox(Z,U)}),this._setEventListeners(M,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],U=>U.target.checked)),this._setBackgroundColor(M),this._setDefaultPropertiesFromJS(M),this.container.append(M),this.container}}class r extends n{constructor(i){super(i,{isRenderable:i.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const i=this.annotationStorage,u=this.data,g=u.id;let P=i.getValue(g,{value:u.fieldValue===u.buttonValue}).value;typeof P=="string"&&(P=P!==u.buttonValue,i.setValue(g,{value:P}));const M=document.createElement("input");if(y.add(M),M.setAttribute("data-element-id",g),M.disabled=u.readOnly,this._setRequired(M,this.data.required),M.type="radio",M.name=u.fieldName,P&&M.setAttribute("checked",!0),M.tabIndex=j,M.addEventListener("change",U=>{const{name:Z,checked:lt}=U.target;for(const st of this._getElementsByName(Z,g))i.setValue(st.id,{value:!1});i.setValue(g,{value:lt})}),M.addEventListener("resetform",U=>{const Z=u.defaultFieldValue;U.target.checked=Z!=null&&Z===u.buttonValue}),this.enableScripting&&this.hasJSActions){const U=u.buttonValue;M.addEventListener("updatefromsandbox",Z=>{const lt={value:st=>{const gt=U===st.detail.value;for(const B of this._getElementsByName(st.target.name)){const pt=gt&&B.id===g;B.domElement&&(B.domElement.checked=pt),i.setValue(B.id,{value:pt})}}};this._dispatchEventFromSandbox(lt,Z)}),this._setEventListeners(M,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Z=>Z.target.checked)}return this._setBackgroundColor(M),this._setDefaultPropertiesFromJS(M),this.container.append(M),this.container}}class l extends c{constructor(i){super(i,{ignoreBorder:i.data.hasAppearance})}render(){const i=super.render();i.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(i.title=this.data.alternativeText);const u=i.lastChild;return this.enableScripting&&this.hasJSActions&&u&&(this._setDefaultPropertiesFromJS(u),u.addEventListener("updatefromsandbox",g=>{this._dispatchEventFromSandbox({},g)})),i}}class t extends n{constructor(i){super(i,{isRenderable:i.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const i=this.annotationStorage,u=this.data.id,g=i.getValue(u,{value:this.data.fieldValue}),P=document.createElement("select");y.add(P),P.setAttribute("data-element-id",u),P.disabled=this.data.readOnly,this._setRequired(P,this.data.required),P.name=this.data.fieldName,P.tabIndex=j;let M=this.data.combo&&this.data.options.length>0;this.data.combo||(P.size=this.data.options.length,this.data.multiSelect&&(P.multiple=!0)),P.addEventListener("resetform",st=>{const gt=this.data.defaultFieldValue;for(const B of P.options)B.selected=B.value===gt});for(const st of this.data.options){const gt=document.createElement("option");gt.textContent=st.displayValue,gt.value=st.exportValue,g.value.includes(st.exportValue)&&(gt.setAttribute("selected",!0),M=!1),P.append(gt)}let U=null;if(M){const st=document.createElement("option");st.value=" ",st.setAttribute("hidden",!0),st.setAttribute("selected",!0),P.prepend(st),U=()=>{st.remove(),P.removeEventListener("input",U),U=null},P.addEventListener("input",U)}const Z=(st,gt)=>{const B=gt?"value":"textContent",pt=st.target.options;return st.target.multiple?Array.prototype.filter.call(pt,mt=>mt.selected).map(mt=>mt[B]):pt.selectedIndex===-1?null:pt[pt.selectedIndex][B]},lt=st=>{const gt=st.target.options;return Array.prototype.map.call(gt,B=>({displayValue:B.textContent,exportValue:B.value}))};return this.enableScripting&&this.hasJSActions?(P.addEventListener("updatefromsandbox",st=>{const gt={value(B){U==null||U();const pt=B.detail.value,mt=new Set(Array.isArray(pt)?pt:[pt]);for(const yt of P.options)yt.selected=mt.has(yt.value);i.setValue(u,{value:Z(B,!0)})},multipleSelection(B){P.multiple=!0},remove(B){const pt=P.options,mt=B.detail.remove;pt[mt].selected=!1,P.remove(mt),pt.length>0&&Array.prototype.findIndex.call(pt,q=>q.selected)===-1&&(pt[0].selected=!0),i.setValue(u,{value:Z(B,!0),items:lt(B)})},clear(B){for(;P.length!==0;)P.remove(0);i.setValue(u,{value:null,items:[]})},insert(B){const{index:pt,displayValue:mt,exportValue:yt}=B.detail.insert,q=P.children[pt],ut=document.createElement("option");ut.textContent=mt,ut.value=yt,q?q.before(ut):P.append(ut),i.setValue(u,{value:Z(B,!0),items:lt(B)})},items(B){const{items:pt}=B.detail;for(;P.length!==0;)P.remove(0);for(const mt of pt){const{displayValue:yt,exportValue:q}=mt,ut=document.createElement("option");ut.textContent=yt,ut.value=q,P.append(ut)}P.options.length>0&&(P.options[0].selected=!0),i.setValue(u,{value:Z(B,!0),items:lt(B)})},indices(B){const pt=new Set(B.detail.indices);for(const mt of B.target.options)mt.selected=pt.has(mt.index);i.setValue(u,{value:Z(B,!0)})},editable(B){B.target.disabled=!B.detail.editable}};this._dispatchEventFromSandbox(gt,st)}),P.addEventListener("input",st=>{var pt;const gt=Z(st,!0),B=Z(st,!1);i.setValue(u,{value:gt}),(pt=this.linkService.eventBus)==null||pt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:u,name:"Keystroke",value:B,changeEx:gt,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(P,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],st=>st.target.checked)):P.addEventListener("input",function(st){i.setValue(u,{value:Z(st,!0)})}),this.data.combo&&this._setTextStyle(P),this._setBackgroundColor(P),this._setDefaultPropertiesFromJS(P),this.container.append(P),this.container}}const b=class extends p{constructor(i){var P,M,U;const{data:u}=i,g=!b.IGNORE_TYPES.has(u.parentType)&&!!(((P=u.titleObj)==null?void 0:P.str)||((M=u.contentsObj)==null?void 0:M.str)||((U=u.richText)==null?void 0:U.str));super(i,{isRenderable:g})}render(){this.container.className="popupAnnotation";const i=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(i.length===0)return this.container;const u=new _({container:this.container,trigger:Array.from(i),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),g=this.page,P=m.Util.normalizeRect([this.data.parentRect[0],g.view[3]-this.data.parentRect[1]+g.view[1],this.data.parentRect[2],g.view[3]-this.data.parentRect[3]+g.view[1]]),M=P[0]+this.data.parentRect[2]-this.data.parentRect[0],U=P[1],[Z,lt,st,gt]=this.viewport.viewBox,B=st-Z,pt=gt-lt;return this.container.style.left=`${100*(M-Z)/B}%`,this.container.style.top=`${100*(U-lt)/pt}%`,this.container.append(u.render()),this.container}};let s=b;It(s,"IGNORE_TYPES",new Set(["Line","Square","Circle","PolyLine","Polygon","Ink"]));class _{constructor(i){this.container=i.container,this.trigger=i.trigger,this.color=i.color,this.titleObj=i.titleObj,this.modificationDate=i.modificationDate,this.contentsObj=i.contentsObj,this.richText=i.richText,this.hideWrapper=i.hideWrapper||!1,this.pinned=!1}render(){var Z,lt;const u=document.createElement("div");u.className="popupWrapper",this.hideElement=this.hideWrapper?u:this.container,this.hideElement.hidden=!0;const g=document.createElement("div");g.className="popup";const P=this.color;if(P){const st=.7*(255-P[0])+P[0],gt=.7*(255-P[1])+P[1],B=.7*(255-P[2])+P[2];g.style.backgroundColor=m.Util.makeHexColor(st|0,gt|0,B|0)}const M=document.createElement("h1");M.dir=this.titleObj.dir,M.textContent=this.titleObj.str,g.append(M);const U=x.PDFDateString.toDateObject(this.modificationDate);if(U){const st=document.createElement("span");st.className="popupDate",st.textContent="{{date}}, {{time}}",st.dataset.l10nId="annotation_date_string",st.dataset.l10nArgs=JSON.stringify({date:U.toLocaleDateString(),time:U.toLocaleTimeString()}),g.append(st)}if(((Z=this.richText)==null?void 0:Z.str)&&(!((lt=this.contentsObj)!=null&&lt.str)||this.contentsObj.str===this.richText.str))G.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:g}),g.lastChild.className="richText popupContent";else{const st=this._formatContents(this.contentsObj);g.append(st)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const st of this.trigger)st.addEventListener("click",this._toggle.bind(this)),st.addEventListener("mouseover",this._show.bind(this,!1)),st.addEventListener("mouseout",this._hide.bind(this,!1));return g.addEventListener("click",this._hide.bind(this,!0)),u.append(g),u}_formatContents({str:i,dir:u}){const g=document.createElement("p");g.className="popupContent",g.dir=u;const P=i.split(/(?:\r\n?|\n)/);for(let M=0,U=P.length;M<U;++M){const Z=P[M];g.append(document.createTextNode(Z)),M<U-1&&g.append(document.createElement("br"))}return g}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(i=!1){i&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(i=!0){i&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class C extends p{constructor(i){var g,P,M;const u=!!(i.data.hasPopup||((g=i.data.titleObj)==null?void 0:g.str)||((P=i.data.contentsObj)==null?void 0:P.str)||((M=i.data.richText)==null?void 0:M.str));super(i,{isRenderable:u,ignoreBorder:!0}),this.textContent=i.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const i=document.createElement("div");i.className="annotationTextContent",i.setAttribute("role","comment");for(const u of this.textContent){const g=document.createElement("span");g.textContent=u,i.append(g)}this.container.append(i)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class D extends p{constructor(i){var g,P,M;const u=!!(i.data.hasPopup||((g=i.data.titleObj)==null?void 0:g.str)||((P=i.data.contentsObj)==null?void 0:P.str)||((M=i.data.richText)==null?void 0:M.str));super(i,{isRenderable:u,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const i=this.data,{width:u,height:g}=F(i.rect),P=this.svgFactory.create(u,g,!0),M=this.svgFactory.createElement("svg:line");return M.setAttribute("x1",i.rect[2]-i.lineCoordinates[0]),M.setAttribute("y1",i.rect[3]-i.lineCoordinates[1]),M.setAttribute("x2",i.rect[2]-i.lineCoordinates[2]),M.setAttribute("y2",i.rect[3]-i.lineCoordinates[3]),M.setAttribute("stroke-width",i.borderStyle.width||1),M.setAttribute("stroke","transparent"),M.setAttribute("fill","transparent"),P.append(M),this.container.append(P),this._createPopup(M,i),this.container}}class E extends p{constructor(i){var g,P,M;const u=!!(i.data.hasPopup||((g=i.data.titleObj)==null?void 0:g.str)||((P=i.data.contentsObj)==null?void 0:P.str)||((M=i.data.richText)==null?void 0:M.str));super(i,{isRenderable:u,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const i=this.data,{width:u,height:g}=F(i.rect),P=this.svgFactory.create(u,g,!0),M=i.borderStyle.width,U=this.svgFactory.createElement("svg:rect");return U.setAttribute("x",M/2),U.setAttribute("y",M/2),U.setAttribute("width",u-M),U.setAttribute("height",g-M),U.setAttribute("stroke-width",M||1),U.setAttribute("stroke","transparent"),U.setAttribute("fill","transparent"),P.append(U),this.container.append(P),this._createPopup(U,i),this.container}}class T extends p{constructor(i){var g,P,M;const u=!!(i.data.hasPopup||((g=i.data.titleObj)==null?void 0:g.str)||((P=i.data.contentsObj)==null?void 0:P.str)||((M=i.data.richText)==null?void 0:M.str));super(i,{isRenderable:u,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const i=this.data,{width:u,height:g}=F(i.rect),P=this.svgFactory.create(u,g,!0),M=i.borderStyle.width,U=this.svgFactory.createElement("svg:ellipse");return U.setAttribute("cx",u/2),U.setAttribute("cy",g/2),U.setAttribute("rx",u/2-M/2),U.setAttribute("ry",g/2-M/2),U.setAttribute("stroke-width",M||1),U.setAttribute("stroke","transparent"),U.setAttribute("fill","transparent"),P.append(U),this.container.append(P),this._createPopup(U,i),this.container}}class Q extends p{constructor(i){var g,P,M;const u=!!(i.data.hasPopup||((g=i.data.titleObj)==null?void 0:g.str)||((P=i.data.contentsObj)==null?void 0:P.str)||((M=i.data.richText)==null?void 0:M.str));super(i,{isRenderable:u,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const i=this.data,{width:u,height:g}=F(i.rect),P=this.svgFactory.create(u,g,!0);let M=[];for(const Z of i.vertices){const lt=Z.x-i.rect[0],st=i.rect[3]-Z.y;M.push(lt+","+st)}M=M.join(" ");const U=this.svgFactory.createElement(this.svgElementName);return U.setAttribute("points",M),U.setAttribute("stroke-width",i.borderStyle.width||1),U.setAttribute("stroke","transparent"),U.setAttribute("fill","transparent"),P.append(U),this.container.append(P),this._createPopup(U,i),this.container}}class ct extends Q{constructor(i){super(i),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class rt extends p{constructor(i){var g,P,M;const u=!!(i.data.hasPopup||((g=i.data.titleObj)==null?void 0:g.str)||((P=i.data.contentsObj)==null?void 0:P.str)||((M=i.data.richText)==null?void 0:M.str));super(i,{isRenderable:u,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class V extends p{constructor(i){var g,P,M;const u=!!(i.data.hasPopup||((g=i.data.titleObj)==null?void 0:g.str)||((P=i.data.contentsObj)==null?void 0:P.str)||((M=i.data.richText)==null?void 0:M.str));super(i,{isRenderable:u,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const i=this.data,{width:u,height:g}=F(i.rect),P=this.svgFactory.create(u,g,!0);for(const M of i.inkLists){let U=[];for(const lt of M){const st=lt.x-i.rect[0],gt=i.rect[3]-lt.y;U.push(`${st},${gt}`)}U=U.join(" ");const Z=this.svgFactory.createElement(this.svgElementName);Z.setAttribute("points",U),Z.setAttribute("stroke-width",i.borderStyle.width||1),Z.setAttribute("stroke","transparent"),Z.setAttribute("fill","transparent"),this._createPopup(Z,i),P.append(Z)}return this.container.append(P),this.container}}class W extends p{constructor(i){var g,P,M;const u=!!(i.data.hasPopup||((g=i.data.titleObj)==null?void 0:g.str)||((P=i.data.contentsObj)==null?void 0:P.str)||((M=i.data.richText)==null?void 0:M.str));super(i,{isRenderable:u,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class $ extends p{constructor(i){var g,P,M;const u=!!(i.data.hasPopup||((g=i.data.titleObj)==null?void 0:g.str)||((P=i.data.contentsObj)==null?void 0:P.str)||((M=i.data.richText)==null?void 0:M.str));super(i,{isRenderable:u,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class tt extends p{constructor(i){var g,P,M;const u=!!(i.data.hasPopup||((g=i.data.titleObj)==null?void 0:g.str)||((P=i.data.contentsObj)==null?void 0:P.str)||((M=i.data.richText)==null?void 0:M.str));super(i,{isRenderable:u,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class nt extends p{constructor(i){var g,P,M;const u=!!(i.data.hasPopup||((g=i.data.titleObj)==null?void 0:g.str)||((P=i.data.contentsObj)==null?void 0:P.str)||((M=i.data.richText)==null?void 0:M.str));super(i,{isRenderable:u,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class ft extends p{constructor(i){var g,P,M;const u=!!(i.data.hasPopup||((g=i.data.titleObj)==null?void 0:g.str)||((P=i.data.contentsObj)==null?void 0:P.str)||((M=i.data.richText)==null?void 0:M.str));super(i,{isRenderable:u,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class bt extends p{constructor(i){var P;super(i,{isRenderable:!0});const{filename:u,content:g}=this.data.file;this.filename=(0,x.getFilenameFromUrl)(u),this.content=g,(P=this.linkService.eventBus)==null||P.dispatch("fileattachmentannotation",{source:this,filename:u,content:g})}render(){var u,g;this.container.className="fileAttachmentAnnotation";const i=document.createElement("div");return i.className="popupTriggerArea",i.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(((u=this.data.titleObj)==null?void 0:u.str)||((g=this.data.contentsObj)==null?void 0:g.str)||this.data.richText)&&this._createPopup(i,this.data),this.container.append(i),this.container}_download(){var i;(i=this.downloadManager)==null||i.openOrDownloadData(this.container,this.content,this.filename)}}const K=class{static render(i){var Z,lt;const{annotations:u,div:g,viewport:P,accessibilityManager:M}=i;ht(this,N,ve).call(this,g,P);let U=0;for(const st of u){if(st.annotationType!==m.AnnotationType.POPUP){const{width:B,height:pt}=F(st.rect);if(B<=0||pt<=0)continue}const gt=A.create({data:st,layer:g,page:i.page,viewport:P,linkService:i.linkService,downloadManager:i.downloadManager,imageResourcesPath:i.imageResourcesPath||"",renderForms:i.renderForms!==!1,svgFactory:new x.DOMSVGFactory,annotationStorage:i.annotationStorage||new X.AnnotationStorage,enableScripting:i.enableScripting,hasJSActions:i.hasJSActions,fieldObjects:i.fieldObjects,mouseState:i.mouseState||{isDown:!1}});if(gt.isRenderable){const B=gt.render();if(st.hidden&&(B.style.visibility="hidden"),Array.isArray(B))for(const pt of B)pt.style.zIndex=U++,ht(Z=K,w,ye).call(Z,pt,st.id,g,M);else B.style.zIndex=U++,gt instanceof s?g.prepend(B):ht(lt=K,w,ye).call(lt,B,st.id,g,M)}}ht(this,Y,Se).call(this,g,i.annotationCanvasMap)}static update(i){const{annotationCanvasMap:u,div:g,viewport:P}=i;ht(this,N,ve).call(this,g,P),ht(this,Y,Se).call(this,g,u),g.hidden=!1}};let I=K;w=new WeakSet,ye=function(i,u,g,P){const M=i.firstChild||i;M.id=`${x.AnnotationPrefix}${u}`,g.append(i),P==null||P.moveElementInDOM(g,i,M,!1)},N=new WeakSet,ve=function(i,{width:u,height:g,rotation:P}){const{style:M}=i,U=P%180!==0,Z=Math.floor(u)+"px",lt=Math.floor(g)+"px";M.width=U?lt:Z,M.height=U?Z:lt,i.setAttribute("data-main-rotation",P)},Y=new WeakSet,Se=function(i,u){if(!!u){for(const[g,P]of u){const M=i.querySelector(`[data-annotation-id="${g}"]`);if(!M)continue;const{firstChild:U}=M;U?U.nodeName==="CANVAS"?U.replaceWith(P):U.before(P):M.append(P)}u.clear()}},it(I,w),it(I,N),it(I,Y),f.AnnotationLayer=I},(ot,f)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.ColorConverters=void 0;function J(x){return Math.floor(Math.max(0,Math.min(1,x))*255).toString(16).padStart(2,"0")}class m{static CMYK_G([X,z,G,j]){return["G",1-Math.min(1,.3*X+.59*G+.11*z+j)]}static G_CMYK([X]){return["CMYK",0,0,0,1-X]}static G_RGB([X]){return["RGB",X,X,X]}static G_HTML([X]){const z=J(X);return`#${z}${z}${z}`}static RGB_G([X,z,G]){return["G",.3*X+.59*z+.11*G]}static RGB_HTML([X,z,G]){const j=J(X),v=J(z),y=J(G);return`#${j}${v}${y}`}static T_HTML(){return"#00000000"}static CMYK_RGB([X,z,G,j]){return["RGB",1-Math.min(1,X+j),1-Math.min(1,G+j),1-Math.min(1,z+j)]}static CMYK_HTML(X){const z=this.CMYK_RGB(X).slice(1);return this.RGB_HTML(z)}static RGB_CMYK([X,z,G]){const j=1-X,v=1-z,y=1-G,F=Math.min(j,v,y);return["CMYK",j,v,y,F]}}f.ColorConverters=m},(ot,f,J)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.XfaLayer=void 0;var m=J(19);class x{static setupStorage(z,G,j,v,y){const F=v.getValue(G,{value:null});switch(j.name){case"textarea":if(F.value!==null&&(z.textContent=F.value),y==="print")break;z.addEventListener("input",A=>{v.setValue(G,{value:A.target.value})});break;case"input":if(j.attributes.type==="radio"||j.attributes.type==="checkbox"){if(F.value===j.attributes.xfaOn?z.setAttribute("checked",!0):F.value===j.attributes.xfaOff&&z.removeAttribute("checked"),y==="print")break;z.addEventListener("change",A=>{v.setValue(G,{value:A.target.checked?A.target.getAttribute("xfaOn"):A.target.getAttribute("xfaOff")})})}else{if(F.value!==null&&z.setAttribute("value",F.value),y==="print")break;z.addEventListener("input",A=>{v.setValue(G,{value:A.target.value})})}break;case"select":if(F.value!==null)for(const A of j.children)A.attributes.value===F.value&&(A.attributes.selected=!0);z.addEventListener("input",A=>{const p=A.target.options,c=p.selectedIndex===-1?"":p[p.selectedIndex].value;v.setValue(G,{value:c})});break}}static setAttributes({html:z,element:G,storage:j=null,intent:v,linkService:y}){const{attributes:F}=G,A=z instanceof HTMLAnchorElement;F.type==="radio"&&(F.name=`${F.name}-${v}`);for(const[p,c]of Object.entries(F))if(c!=null)switch(p){case"class":c.length&&z.setAttribute(p,c.join(" "));break;case"dataId":break;case"id":z.setAttribute("data-element-id",c);break;case"style":Object.assign(z.style,c);break;case"textContent":z.textContent=c;break;default:(!A||p!=="href"&&p!=="newWindow")&&z.setAttribute(p,c)}A&&y.addLinkAttributes(z,F.href,F.newWindow),j&&F.dataId&&this.setupStorage(z,F.dataId,G,j)}static render(z){var h;const G=z.annotationStorage,j=z.linkService,v=z.xfaHtml,y=z.intent||"display",F=document.createElement(v.name);v.attributes&&this.setAttributes({html:F,element:v,intent:y,linkService:j});const A=[[v,-1,F]],p=z.div;if(p.append(F),z.viewport){const n=`matrix(${z.viewport.transform.join(",")})`;p.style.transform=n}y!=="richText"&&p.setAttribute("class","xfaLayer xfaFont");const c=[];for(;A.length>0;){const[n,e,o]=A.at(-1);if(e+1===n.children.length){A.pop();continue}const r=n.children[++A.at(-1)[1]];if(r===null)continue;const{name:l}=r;if(l==="#text"){const s=document.createTextNode(r.value);c.push(s),o.append(s);continue}let t;if((h=r==null?void 0:r.attributes)!=null&&h.xmlns?t=document.createElementNS(r.attributes.xmlns,l):t=document.createElement(l),o.append(t),r.attributes&&this.setAttributes({html:t,element:r,storage:G,intent:y,linkService:j}),r.children&&r.children.length>0)A.push([r,-1,t]);else if(r.value){const s=document.createTextNode(r.value);m.XfaText.shouldBuildText(l)&&c.push(s),t.append(s)}}for(const n of p.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))n.setAttribute("readOnly",!0);return{textDivs:c}}static update(z){const G=`matrix(${z.viewport.transform.join(",")})`;z.div.style.transform=G,z.div.hidden=!1}}f.XfaLayer=x},(ot,f,J)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.TextLayerRenderTask=void 0,f.renderTextLayer=A;var m=J(1);const x=1e5,X=30,z=.8,G=new Map;function j(p,c){const h=G.get(p);if(h)return h;c.save(),c.font=`${X}px ${p}`;const n=c.measureText("");let e=n.fontBoundingBoxAscent,o=Math.abs(n.fontBoundingBoxDescent);if(e){c.restore();const l=e/(e+o);return G.set(p,l),l}c.strokeStyle="red",c.clearRect(0,0,X,X),c.strokeText("g",0,0);let r=c.getImageData(0,0,X,X).data;o=0;for(let l=r.length-1-3;l>=0;l-=4)if(r[l]>0){o=Math.ceil(l/4/X);break}c.clearRect(0,0,X,X),c.strokeText("A",0,X),r=c.getImageData(0,0,X,X).data,e=0;for(let l=0,t=r.length;l<t;l+=4)if(r[l]>0){e=X-Math.floor(l/4/X);break}if(c.restore(),e){const l=e/(e+o);return G.set(p,l),l}return G.set(p,z),z}function v(p,c,h,n){const e=document.createElement("span"),o={angle:0,canvasWidth:0,hasText:c.str!=="",hasEOL:c.hasEOL,fontSize:0};p._textDivs.push(e);const r=m.Util.transform(p._viewport.transform,c.transform);let l=Math.atan2(r[1],r[0]);const t=h[c.fontName];t.vertical&&(l+=Math.PI/2);const s=Math.hypot(r[2],r[3]),_=s*j(t.fontFamily,n);let C,D;l===0?(C=r[4],D=r[5]-_):(C=r[4]+_*Math.sin(l),D=r[5]-_*Math.cos(l)),e.style.left=`${C}px`,e.style.top=`${D}px`,e.style.fontSize=`${s}px`,e.style.fontFamily=t.fontFamily,o.fontSize=s,e.setAttribute("role","presentation"),e.textContent=c.str,e.dir=c.dir,p._fontInspectorEnabled&&(e.dataset.fontName=c.fontName),l!==0&&(o.angle=l*(180/Math.PI));let E=!1;if(c.str.length>1)E=!0;else if(c.str!==" "&&c.transform[0]!==c.transform[3]){const T=Math.abs(c.transform[0]),Q=Math.abs(c.transform[3]);T!==Q&&Math.max(T,Q)/Math.min(T,Q)>1.5&&(E=!0)}E&&(t.vertical?o.canvasWidth=c.height*p._viewport.scale:o.canvasWidth=c.width*p._viewport.scale),p._textDivProperties.set(e,o),p._textContentStream&&p._layoutText(e)}function y(p){if(p._canceled)return;const c=p._textDivs,h=p._capability;if(c.length>x){p._renderingDone=!0,h.resolve();return}if(!p._textContentStream)for(const e of c)p._layoutText(e);p._renderingDone=!0,h.resolve()}class F{constructor({textContent:c,textContentStream:h,container:n,viewport:e,textDivs:o,textContentItemsStr:r}){var l;this._textContent=c,this._textContentStream=h,this._container=n,this._document=n.ownerDocument,this._viewport=e,this._textDivs=o||[],this._textContentItemsStr=r||[],this._fontInspectorEnabled=!!((l=globalThis.FontInspector)!=null&&l.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,m.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._devicePixelRatio=globalThis.devicePixelRatio||1,this._capability.promise.finally(()=>{this._textDivProperties=null,this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new m.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(c,h){for(const n of c){if(n.str===void 0){if(n.type==="beginMarkedContentProps"||n.type==="beginMarkedContent"){const e=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),n.id!==null&&this._container.setAttribute("id",`${n.id}`),e.append(this._container)}else n.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(n.str),v(this,n,h,this._layoutTextCtx)}}_layoutText(c){const h=this._textDivProperties.get(c);let n="";if(h.canvasWidth!==0&&h.hasText){const{fontFamily:e}=c.style,{fontSize:o}=h;(o!==this._layoutTextLastFontSize||e!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${o*this._devicePixelRatio}px ${e}`,this._layoutTextLastFontSize=o,this._layoutTextLastFontFamily=e);const{width:r}=this._layoutTextCtx.measureText(c.textContent);r>0&&(n=`scaleX(${this._devicePixelRatio*h.canvasWidth/r})`)}if(h.angle!==0&&(n=`rotate(${h.angle}deg) ${n}`),n.length>0&&(c.style.transform=n),h.hasText&&this._container.append(c),h.hasEOL){const e=document.createElement("br");e.setAttribute("role","presentation"),this._container.append(e)}}_render(c=0){const h=(0,m.createPromiseCapability)();let n=Object.create(null);const e=this._document.createElement("canvas");if(e.height=e.width=X,this._layoutTextCtx=e.getContext("2d",{alpha:!1}),this._textContent){const o=this._textContent.items,r=this._textContent.styles;this._processItems(o,r),h.resolve()}else if(this._textContentStream){const o=()=>{this._reader.read().then(({value:r,done:l})=>{if(l){h.resolve();return}Object.assign(n,r.styles),this._processItems(r.items,n),o()},h.reject)};this._reader=this._textContentStream.getReader(),o()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');h.promise.then(()=>{n=null,c?this._renderTimer=setTimeout(()=>{y(this),this._renderTimer=null},c):y(this)},this._capability.reject)}}f.TextLayerRenderTask=F;function A(p){const c=new F({textContent:p.textContent,textContentStream:p.textContentStream,container:p.container,viewport:p.viewport,textDivs:p.textDivs,textContentItemsStr:p.textContentItemsStr});return c._render(p.timeout),c}},(ot,f,J)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.SVGGraphics=void 0;var m=J(6),x=J(1),X=J(12);let z=class{constructor(){(0,x.unreachable)("Not implemented: SVGGraphics")}};f.SVGGraphics=z;{let h=function(t){let s=[];const _=[];for(const C of t){if(C.fn==="save"){s.push({fnId:92,fn:"group",items:[]}),_.push(s),s=s.at(-1).items;continue}C.fn==="restore"?s=_.pop():s.push(C)}return s},n=function(t){if(Number.isInteger(t))return t.toString();const s=t.toFixed(10);let _=s.length-1;if(s[_]!=="0")return s;do _--;while(s[_]==="0");return s.substring(0,s[_]==="."?_:_+1)},e=function(t){if(t[4]===0&&t[5]===0){if(t[1]===0&&t[2]===0)return t[0]===1&&t[3]===1?"":`scale(${n(t[0])} ${n(t[3])})`;if(t[0]===t[3]&&t[1]===-t[2]){const s=Math.acos(t[0])*180/Math.PI;return`rotate(${n(s)})`}}else if(t[0]===1&&t[1]===0&&t[2]===0&&t[3]===1)return`translate(${n(t[4])} ${n(t[5])})`;return`matrix(${n(t[0])} ${n(t[1])} ${n(t[2])} ${n(t[3])} ${n(t[4])} ${n(t[5])})`};const G={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},j="http://www.w3.org/XML/1998/namespace",v="http://www.w3.org/1999/xlink",y=["butt","round","square"],F=["miter","round","bevel"],A=function(t,s="",_=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!_)return URL.createObjectURL(new Blob([t],{type:s}));const C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let D=`data:${s};base64,`;for(let E=0,T=t.length;E<T;E+=3){const Q=t[E]&255,ct=t[E+1]&255,rt=t[E+2]&255,V=Q>>2,W=(Q&3)<<4|ct>>4,$=E+1<T?(ct&15)<<2|rt>>6:64,tt=E+2<T?rt&63:64;D+=C[V]+C[W]+C[$]+C[tt]}return D},p=function(){const t=new Uint8Array([137,80,78,71,13,10,26,10]),s=12,_=new Int32Array(256);for(let rt=0;rt<256;rt++){let V=rt;for(let W=0;W<8;W++)V&1?V=3988292384^V>>1&2147483647:V=V>>1&2147483647;_[rt]=V}function C(rt,V,W){let $=-1;for(let tt=V;tt<W;tt++){const nt=($^rt[tt])&255,ft=_[nt];$=$>>>8^ft}return $^-1}function D(rt,V,W,$){let tt=$;const nt=V.length;W[tt]=nt>>24&255,W[tt+1]=nt>>16&255,W[tt+2]=nt>>8&255,W[tt+3]=nt&255,tt+=4,W[tt]=rt.charCodeAt(0)&255,W[tt+1]=rt.charCodeAt(1)&255,W[tt+2]=rt.charCodeAt(2)&255,W[tt+3]=rt.charCodeAt(3)&255,tt+=4,W.set(V,tt),tt+=V.length;const ft=C(W,$+4,tt);W[tt]=ft>>24&255,W[tt+1]=ft>>16&255,W[tt+2]=ft>>8&255,W[tt+3]=ft&255}function E(rt,V,W){let $=1,tt=0;for(let nt=V;nt<W;++nt)$=($+(rt[nt]&255))%65521,tt=(tt+$)%65521;return tt<<16|$}function T(rt){if(!X.isNodeJS)return Q(rt);try{let V;parseInt(process.versions.node)>=8?V=rt:V=Buffer.from(rt);const W=require$$5.deflateSync(V,{level:9});return W instanceof Uint8Array?W:new Uint8Array(W)}catch(V){(0,x.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+V)}return Q(rt)}function Q(rt){let V=rt.length;const W=65535,$=Math.ceil(V/W),tt=new Uint8Array(2+V+$*5+4);let nt=0;tt[nt++]=120,tt[nt++]=156;let ft=0;for(;V>W;)tt[nt++]=0,tt[nt++]=255,tt[nt++]=255,tt[nt++]=0,tt[nt++]=0,tt.set(rt.subarray(ft,ft+W),nt),nt+=W,ft+=W,V-=W;tt[nt++]=1,tt[nt++]=V&255,tt[nt++]=V>>8&255,tt[nt++]=~V&65535&255,tt[nt++]=(~V&65535)>>8&255,tt.set(rt.subarray(ft),nt),nt+=rt.length-ft;const bt=E(rt,0,rt.length);return tt[nt++]=bt>>24&255,tt[nt++]=bt>>16&255,tt[nt++]=bt>>8&255,tt[nt++]=bt&255,tt}function ct(rt,V,W,$){const tt=rt.width,nt=rt.height;let ft,bt,I;const d=rt.data;switch(V){case x.ImageKind.GRAYSCALE_1BPP:bt=0,ft=1,I=tt+7>>3;break;case x.ImageKind.RGB_24BPP:bt=2,ft=8,I=tt*3;break;case x.ImageKind.RGBA_32BPP:bt=6,ft=8,I=tt*4;break;default:throw new Error("invalid format")}const a=new Uint8Array((1+I)*nt);let b=0,w=0;for(let K=0;K<nt;++K)a[b++]=0,a.set(d.subarray(w,w+I),b),w+=I,b+=I;if(V===x.ImageKind.GRAYSCALE_1BPP&&$){b=0;for(let K=0;K<nt;K++){b++;for(let et=0;et<I;et++)a[b++]^=255}}const L=new Uint8Array([tt>>24&255,tt>>16&255,tt>>8&255,tt&255,nt>>24&255,nt>>16&255,nt>>8&255,nt&255,ft,bt,0,0,0]),N=T(a),H=t.length+s*3+L.length+N.length,Y=new Uint8Array(H);let at=0;return Y.set(t,at),at+=t.length,D("IHDR",L,Y,at),at+=s+L.length,D("IDATA",N,Y,at),at+=s+N.length,D("IEND",new Uint8Array(0),Y,at),A(Y,"image/png",W)}return function(V,W,$){const tt=V.kind===void 0?x.ImageKind.GRAYSCALE_1BPP:V.kind;return ct(V,tt,W,$)}}();class c{constructor(){this.fontSizeScale=1,this.fontWeight=G.fontWeight,this.fontSize=0,this.textMatrix=x.IDENTITY_MATRIX,this.fontMatrix=x.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=x.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=G.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(s,_){this.x=s,this.y=_}}let o=0,r=0,l=0;f.SVGGraphics=z=class{constructor(t,s,_=!1){(0,m.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new m.DOMSVGFactory,this.current=new c,this.transformMatrix=x.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=t,this.objs=s,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!_,this._operatorIdMapping=[];for(const C in x.OPS)this._operatorIdMapping[x.OPS[C]]=C}getObject(t,s=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):s}save(){this.transformStack.push(this.transformMatrix);const t=this.current;this.extraStack.push(t),this.current=t.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(t){this.save(),this.executeOpTree(t),this.restore()}loadDependencies(t){const s=t.fnArray,_=t.argsArray;for(let C=0,D=s.length;C<D;C++)if(s[C]===x.OPS.dependency)for(const E of _[C]){const T=E.startsWith("g_")?this.commonObjs:this.objs,Q=new Promise(ct=>{T.get(E,ct)});this.current.dependencies.push(Q)}return Promise.all(this.current.dependencies)}transform(t,s,_,C,D,E){const T=[t,s,_,C,D,E];this.transformMatrix=x.Util.transform(this.transformMatrix,T),this.tgrp=null}getSVG(t,s){this.viewport=s;const _=this._initialize(s);return this.loadDependencies(t).then(()=>(this.transformMatrix=x.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(t)),_))}convertOpList(t){const s=this._operatorIdMapping,_=t.argsArray,C=t.fnArray,D=[];for(let E=0,T=C.length;E<T;E++){const Q=C[E];D.push({fnId:Q,fn:s[Q],args:_[E]})}return h(D)}executeOpTree(t){for(const s of t){const _=s.fn,C=s.fnId,D=s.args;switch(C|0){case x.OPS.beginText:this.beginText();break;case x.OPS.dependency:break;case x.OPS.setLeading:this.setLeading(D);break;case x.OPS.setLeadingMoveText:this.setLeadingMoveText(D[0],D[1]);break;case x.OPS.setFont:this.setFont(D);break;case x.OPS.showText:this.showText(D[0]);break;case x.OPS.showSpacedText:this.showText(D[0]);break;case x.OPS.endText:this.endText();break;case x.OPS.moveText:this.moveText(D[0],D[1]);break;case x.OPS.setCharSpacing:this.setCharSpacing(D[0]);break;case x.OPS.setWordSpacing:this.setWordSpacing(D[0]);break;case x.OPS.setHScale:this.setHScale(D[0]);break;case x.OPS.setTextMatrix:this.setTextMatrix(D[0],D[1],D[2],D[3],D[4],D[5]);break;case x.OPS.setTextRise:this.setTextRise(D[0]);break;case x.OPS.setTextRenderingMode:this.setTextRenderingMode(D[0]);break;case x.OPS.setLineWidth:this.setLineWidth(D[0]);break;case x.OPS.setLineJoin:this.setLineJoin(D[0]);break;case x.OPS.setLineCap:this.setLineCap(D[0]);break;case x.OPS.setMiterLimit:this.setMiterLimit(D[0]);break;case x.OPS.setFillRGBColor:this.setFillRGBColor(D[0],D[1],D[2]);break;case x.OPS.setStrokeRGBColor:this.setStrokeRGBColor(D[0],D[1],D[2]);break;case x.OPS.setStrokeColorN:this.setStrokeColorN(D);break;case x.OPS.setFillColorN:this.setFillColorN(D);break;case x.OPS.shadingFill:this.shadingFill(D[0]);break;case x.OPS.setDash:this.setDash(D[0],D[1]);break;case x.OPS.setRenderingIntent:this.setRenderingIntent(D[0]);break;case x.OPS.setFlatness:this.setFlatness(D[0]);break;case x.OPS.setGState:this.setGState(D[0]);break;case x.OPS.fill:this.fill();break;case x.OPS.eoFill:this.eoFill();break;case x.OPS.stroke:this.stroke();break;case x.OPS.fillStroke:this.fillStroke();break;case x.OPS.eoFillStroke:this.eoFillStroke();break;case x.OPS.clip:this.clip("nonzero");break;case x.OPS.eoClip:this.clip("evenodd");break;case x.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case x.OPS.paintImageXObject:this.paintImageXObject(D[0]);break;case x.OPS.paintInlineImageXObject:this.paintInlineImageXObject(D[0]);break;case x.OPS.paintImageMaskXObject:this.paintImageMaskXObject(D[0]);break;case x.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(D[0],D[1]);break;case x.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case x.OPS.closePath:this.closePath();break;case x.OPS.closeStroke:this.closeStroke();break;case x.OPS.closeFillStroke:this.closeFillStroke();break;case x.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case x.OPS.nextLine:this.nextLine();break;case x.OPS.transform:this.transform(D[0],D[1],D[2],D[3],D[4],D[5]);break;case x.OPS.constructPath:this.constructPath(D[0],D[1]);break;case x.OPS.endPath:this.endPath();break;case 92:this.group(s.items);break;default:(0,x.warn)(`Unimplemented operator ${_}`);break}}}setWordSpacing(t){this.current.wordSpacing=t}setCharSpacing(t){this.current.charSpacing=t}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(t,s,_,C,D,E){const T=this.current;T.textMatrix=T.lineMatrix=[t,s,_,C,D,E],T.textMatrixScale=Math.hypot(t,s),T.x=T.lineX=0,T.y=T.lineY=0,T.xcoords=[],T.ycoords=[],T.tspan=this.svgFactory.createElement("svg:tspan"),T.tspan.setAttributeNS(null,"font-family",T.fontFamily),T.tspan.setAttributeNS(null,"font-size",`${n(T.fontSize)}px`),T.tspan.setAttributeNS(null,"y",n(-T.y)),T.txtElement=this.svgFactory.createElement("svg:text"),T.txtElement.append(T.tspan)}beginText(){const t=this.current;t.x=t.lineX=0,t.y=t.lineY=0,t.textMatrix=x.IDENTITY_MATRIX,t.lineMatrix=x.IDENTITY_MATRIX,t.textMatrixScale=1,t.tspan=this.svgFactory.createElement("svg:tspan"),t.txtElement=this.svgFactory.createElement("svg:text"),t.txtgrp=this.svgFactory.createElement("svg:g"),t.xcoords=[],t.ycoords=[]}moveText(t,s){const _=this.current;_.x=_.lineX+=t,_.y=_.lineY+=s,_.xcoords=[],_.ycoords=[],_.tspan=this.svgFactory.createElement("svg:tspan"),_.tspan.setAttributeNS(null,"font-family",_.fontFamily),_.tspan.setAttributeNS(null,"font-size",`${n(_.fontSize)}px`),_.tspan.setAttributeNS(null,"y",n(-_.y))}showText(t){const s=this.current,_=s.font,C=s.fontSize;if(C===0)return;const D=s.fontSizeScale,E=s.charSpacing,T=s.wordSpacing,Q=s.fontDirection,ct=s.textHScale*Q,rt=_.vertical,V=rt?1:-1,W=_.defaultVMetrics,$=C*s.fontMatrix[0];let tt=0;for(const bt of t){if(bt===null){tt+=Q*T;continue}else if(typeof bt=="number"){tt+=V*bt*C/1e3;continue}const I=(bt.isSpace?T:0)+E,d=bt.fontChar;let a,b,w=bt.width;if(rt){let N;const H=bt.vmetric||W;N=bt.vmetric?H[1]:w*.5,N=-N*$;const Y=H[2]*$;w=H?-H[0]:w,a=N/D,b=(tt+Y)/D}else a=tt/D,b=0;(bt.isInFont||_.missingFile)&&(s.xcoords.push(s.x+a),rt&&s.ycoords.push(-s.y+b),s.tspan.textContent+=d);let L;rt?L=w*$-I*Q:L=w*$+I*Q,tt+=L}s.tspan.setAttributeNS(null,"x",s.xcoords.map(n).join(" ")),rt?s.tspan.setAttributeNS(null,"y",s.ycoords.map(n).join(" ")):s.tspan.setAttributeNS(null,"y",n(-s.y)),rt?s.y-=tt:s.x+=tt*ct,s.tspan.setAttributeNS(null,"font-family",s.fontFamily),s.tspan.setAttributeNS(null,"font-size",`${n(s.fontSize)}px`),s.fontStyle!==G.fontStyle&&s.tspan.setAttributeNS(null,"font-style",s.fontStyle),s.fontWeight!==G.fontWeight&&s.tspan.setAttributeNS(null,"font-weight",s.fontWeight);const nt=s.textRenderingMode&x.TextRenderingMode.FILL_STROKE_MASK;if(nt===x.TextRenderingMode.FILL||nt===x.TextRenderingMode.FILL_STROKE?(s.fillColor!==G.fillColor&&s.tspan.setAttributeNS(null,"fill",s.fillColor),s.fillAlpha<1&&s.tspan.setAttributeNS(null,"fill-opacity",s.fillAlpha)):s.textRenderingMode===x.TextRenderingMode.ADD_TO_PATH?s.tspan.setAttributeNS(null,"fill","transparent"):s.tspan.setAttributeNS(null,"fill","none"),nt===x.TextRenderingMode.STROKE||nt===x.TextRenderingMode.FILL_STROKE){const bt=1/(s.textMatrixScale||1);this._setStrokeAttributes(s.tspan,bt)}let ft=s.textMatrix;s.textRise!==0&&(ft=ft.slice(),ft[5]+=s.textRise),s.txtElement.setAttributeNS(null,"transform",`${e(ft)} scale(${n(ct)}, -1)`),s.txtElement.setAttributeNS(j,"xml:space","preserve"),s.txtElement.append(s.tspan),s.txtgrp.append(s.txtElement),this._ensureTransformGroup().append(s.txtElement)}setLeadingMoveText(t,s){this.setLeading(-s),this.moveText(t,s)}addFontStyle(t){if(!t.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const s=A(t.data,t.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${t.loadedName}"; src: url(${s}); }
`}setFont(t){const s=this.current,_=this.commonObjs.get(t[0]);let C=t[1];s.font=_,this.embedFonts&&!_.missingFile&&!this.embeddedFonts[_.loadedName]&&(this.addFontStyle(_),this.embeddedFonts[_.loadedName]=_),s.fontMatrix=_.fontMatrix||x.FONT_IDENTITY_MATRIX;let D="normal";_.black?D="900":_.bold&&(D="bold");const E=_.italic?"italic":"normal";C<0?(C=-C,s.fontDirection=-1):s.fontDirection=1,s.fontSize=C,s.fontFamily=_.loadedName,s.fontWeight=D,s.fontStyle=E,s.tspan=this.svgFactory.createElement("svg:tspan"),s.tspan.setAttributeNS(null,"y",n(-s.y)),s.xcoords=[],s.ycoords=[]}endText(){var s;const t=this.current;t.textRenderingMode&x.TextRenderingMode.ADD_TO_PATH_FLAG&&((s=t.txtElement)==null?void 0:s.hasChildNodes())&&(t.element=t.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(t){t>0&&(this.current.lineWidth=t)}setLineCap(t){this.current.lineCap=y[t]}setLineJoin(t){this.current.lineJoin=F[t]}setMiterLimit(t){this.current.miterLimit=t}setStrokeAlpha(t){this.current.strokeAlpha=t}setStrokeRGBColor(t,s,_){this.current.strokeColor=x.Util.makeHexColor(t,s,_)}setFillAlpha(t){this.current.fillAlpha=t}setFillRGBColor(t,s,_){this.current.fillColor=x.Util.makeHexColor(t,s,_),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(t){this.current.strokeColor=this._makeColorN_Pattern(t)}setFillColorN(t){this.current.fillColor=this._makeColorN_Pattern(t)}shadingFill(t){const s=this.viewport.width,_=this.viewport.height,C=x.Util.inverseTransform(this.transformMatrix),D=x.Util.applyTransform([0,0],C),E=x.Util.applyTransform([0,_],C),T=x.Util.applyTransform([s,0],C),Q=x.Util.applyTransform([s,_],C),ct=Math.min(D[0],E[0],T[0],Q[0]),rt=Math.min(D[1],E[1],T[1],Q[1]),V=Math.max(D[0],E[0],T[0],Q[0]),W=Math.max(D[1],E[1],T[1],Q[1]),$=this.svgFactory.createElement("svg:rect");$.setAttributeNS(null,"x",ct),$.setAttributeNS(null,"y",rt),$.setAttributeNS(null,"width",V-ct),$.setAttributeNS(null,"height",W-rt),$.setAttributeNS(null,"fill",this._makeShadingPattern(t)),this.current.fillAlpha<1&&$.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append($)}_makeColorN_Pattern(t){return t[0]==="TilingPattern"?this._makeTilingPattern(t):this._makeShadingPattern(t)}_makeTilingPattern(t){const s=t[1],_=t[2],C=t[3]||x.IDENTITY_MATRIX,[D,E,T,Q]=t[4],ct=t[5],rt=t[6],V=t[7],W=`shading${l++}`,[$,tt,nt,ft]=x.Util.normalizeRect([...x.Util.applyTransform([D,E],C),...x.Util.applyTransform([T,Q],C)]),[bt,I]=x.Util.singularValueDecompose2dScale(C),d=ct*bt,a=rt*I,b=this.svgFactory.createElement("svg:pattern");b.setAttributeNS(null,"id",W),b.setAttributeNS(null,"patternUnits","userSpaceOnUse"),b.setAttributeNS(null,"width",d),b.setAttributeNS(null,"height",a),b.setAttributeNS(null,"x",`${$}`),b.setAttributeNS(null,"y",`${tt}`);const w=this.svg,L=this.transformMatrix,N=this.current.fillColor,H=this.current.strokeColor,Y=this.svgFactory.create(nt-$,ft-tt);if(this.svg=Y,this.transformMatrix=C,V===2){const at=x.Util.makeHexColor(...s);this.current.fillColor=at,this.current.strokeColor=at}return this.executeOpTree(this.convertOpList(_)),this.svg=w,this.transformMatrix=L,this.current.fillColor=N,this.current.strokeColor=H,b.append(Y.childNodes[0]),this.defs.append(b),`url(#${W})`}_makeShadingPattern(t){switch(typeof t=="string"&&(t=this.objs.get(t)),t[0]){case"RadialAxial":const s=`shading${l++}`,_=t[3];let C;switch(t[1]){case"axial":const D=t[4],E=t[5];C=this.svgFactory.createElement("svg:linearGradient"),C.setAttributeNS(null,"id",s),C.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),C.setAttributeNS(null,"x1",D[0]),C.setAttributeNS(null,"y1",D[1]),C.setAttributeNS(null,"x2",E[0]),C.setAttributeNS(null,"y2",E[1]);break;case"radial":const T=t[4],Q=t[5],ct=t[6],rt=t[7];C=this.svgFactory.createElement("svg:radialGradient"),C.setAttributeNS(null,"id",s),C.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),C.setAttributeNS(null,"cx",Q[0]),C.setAttributeNS(null,"cy",Q[1]),C.setAttributeNS(null,"r",rt),C.setAttributeNS(null,"fx",T[0]),C.setAttributeNS(null,"fy",T[1]),C.setAttributeNS(null,"fr",ct);break;default:throw new Error(`Unknown RadialAxial type: ${t[1]}`)}for(const D of _){const E=this.svgFactory.createElement("svg:stop");E.setAttributeNS(null,"offset",D[0]),E.setAttributeNS(null,"stop-color",D[1]),C.append(E)}return this.defs.append(C),`url(#${s})`;case"Mesh":return(0,x.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${t[0]}`)}}setDash(t,s){this.current.dashArray=t,this.current.dashPhase=s}constructPath(t,s){const _=this.current;let C=_.x,D=_.y,E=[],T=0;for(const Q of t)switch(Q|0){case x.OPS.rectangle:C=s[T++],D=s[T++];const ct=s[T++],rt=s[T++],V=C+ct,W=D+rt;E.push("M",n(C),n(D),"L",n(V),n(D),"L",n(V),n(W),"L",n(C),n(W),"Z");break;case x.OPS.moveTo:C=s[T++],D=s[T++],E.push("M",n(C),n(D));break;case x.OPS.lineTo:C=s[T++],D=s[T++],E.push("L",n(C),n(D));break;case x.OPS.curveTo:C=s[T+4],D=s[T+5],E.push("C",n(s[T]),n(s[T+1]),n(s[T+2]),n(s[T+3]),n(C),n(D)),T+=6;break;case x.OPS.curveTo2:E.push("C",n(C),n(D),n(s[T]),n(s[T+1]),n(s[T+2]),n(s[T+3])),C=s[T+2],D=s[T+3],T+=4;break;case x.OPS.curveTo3:C=s[T+2],D=s[T+3],E.push("C",n(s[T]),n(s[T+1]),n(C),n(D),n(C),n(D)),T+=4;break;case x.OPS.closePath:E.push("Z");break}E=E.join(" "),_.path&&t.length>0&&t[0]!==x.OPS.rectangle&&t[0]!==x.OPS.moveTo?E=_.path.getAttributeNS(null,"d")+E:(_.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(_.path)),_.path.setAttributeNS(null,"d",E),_.path.setAttributeNS(null,"fill","none"),_.element=_.path,_.setCurrentPoint(C,D)}endPath(){const t=this.current;if(t.path=null,!this.pendingClip)return;if(!t.element){this.pendingClip=null;return}const s=`clippath${o++}`,_=this.svgFactory.createElement("svg:clipPath");_.setAttributeNS(null,"id",s),_.setAttributeNS(null,"transform",e(this.transformMatrix));const C=t.element.cloneNode(!0);if(this.pendingClip==="evenodd"?C.setAttributeNS(null,"clip-rule","evenodd"):C.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,_.append(C),this.defs.append(_),t.activeClipUrl){t.clipGroup=null;for(const D of this.extraStack)D.clipGroup=null;_.setAttributeNS(null,"clip-path",t.activeClipUrl)}t.activeClipUrl=`url(#${s})`,this.tgrp=null}clip(t){this.pendingClip=t}closePath(){const t=this.current;if(t.path){const s=`${t.path.getAttributeNS(null,"d")}Z`;t.path.setAttributeNS(null,"d",s)}}setLeading(t){this.current.leading=-t}setTextRise(t){this.current.textRise=t}setTextRenderingMode(t){this.current.textRenderingMode=t}setHScale(t){this.current.textHScale=t/100}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[s,_]of t)switch(s){case"LW":this.setLineWidth(_);break;case"LC":this.setLineCap(_);break;case"LJ":this.setLineJoin(_);break;case"ML":this.setMiterLimit(_);break;case"D":this.setDash(_[0],_[1]);break;case"RI":this.setRenderingIntent(_);break;case"FL":this.setFlatness(_);break;case"Font":this.setFont(_);break;case"CA":this.setStrokeAlpha(_);break;case"ca":this.setFillAlpha(_);break;default:(0,x.warn)(`Unimplemented graphic state operator ${s}`);break}}fill(){const t=this.current;t.element&&(t.element.setAttributeNS(null,"fill",t.fillColor),t.element.setAttributeNS(null,"fill-opacity",t.fillAlpha),this.endPath())}stroke(){const t=this.current;t.element&&(this._setStrokeAttributes(t.element),t.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(t,s=1){const _=this.current;let C=_.dashArray;s!==1&&C.length>0&&(C=C.map(function(D){return s*D})),t.setAttributeNS(null,"stroke",_.strokeColor),t.setAttributeNS(null,"stroke-opacity",_.strokeAlpha),t.setAttributeNS(null,"stroke-miterlimit",n(_.miterLimit)),t.setAttributeNS(null,"stroke-linecap",_.lineCap),t.setAttributeNS(null,"stroke-linejoin",_.lineJoin),t.setAttributeNS(null,"stroke-width",n(s*_.lineWidth)+"px"),t.setAttributeNS(null,"stroke-dasharray",C.map(n).join(" ")),t.setAttributeNS(null,"stroke-dashoffset",n(s*_.dashPhase)+"px")}eoFill(){var t;(t=this.current.element)==null||t.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var t;(t=this.current.element)==null||t.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const t=this.svgFactory.createElement("svg:rect");t.setAttributeNS(null,"x","0"),t.setAttributeNS(null,"y","0"),t.setAttributeNS(null,"width","1px"),t.setAttributeNS(null,"height","1px"),t.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(t)}paintImageXObject(t){const s=this.getObject(t);if(!s){(0,x.warn)(`Dependent image with object ID ${t} is not ready yet`);return}this.paintInlineImageXObject(s)}paintInlineImageXObject(t,s){const _=t.width,C=t.height,D=p(t,this.forceDataSchema,!!s),E=this.svgFactory.createElement("svg:rect");E.setAttributeNS(null,"x","0"),E.setAttributeNS(null,"y","0"),E.setAttributeNS(null,"width",n(_)),E.setAttributeNS(null,"height",n(C)),this.current.element=E,this.clip("nonzero");const T=this.svgFactory.createElement("svg:image");T.setAttributeNS(v,"xlink:href",D),T.setAttributeNS(null,"x","0"),T.setAttributeNS(null,"y",n(-C)),T.setAttributeNS(null,"width",n(_)+"px"),T.setAttributeNS(null,"height",n(C)+"px"),T.setAttributeNS(null,"transform",`scale(${n(1/_)} ${n(-1/C)})`),s?s.append(T):this._ensureTransformGroup().append(T)}paintImageMaskXObject(t){const s=this.getObject(t.data,t);if(s.bitmap){(0,x.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const _=this.current,C=s.width,D=s.height,E=_.fillColor;_.maskId=`mask${r++}`;const T=this.svgFactory.createElement("svg:mask");T.setAttributeNS(null,"id",_.maskId);const Q=this.svgFactory.createElement("svg:rect");Q.setAttributeNS(null,"x","0"),Q.setAttributeNS(null,"y","0"),Q.setAttributeNS(null,"width",n(C)),Q.setAttributeNS(null,"height",n(D)),Q.setAttributeNS(null,"fill",E),Q.setAttributeNS(null,"mask",`url(#${_.maskId})`),this.defs.append(T),this._ensureTransformGroup().append(Q),this.paintInlineImageXObject(s,T)}paintFormXObjectBegin(t,s){if(Array.isArray(t)&&t.length===6&&this.transform(t[0],t[1],t[2],t[3],t[4],t[5]),s){const _=s[2]-s[0],C=s[3]-s[1],D=this.svgFactory.createElement("svg:rect");D.setAttributeNS(null,"x",s[0]),D.setAttributeNS(null,"y",s[1]),D.setAttributeNS(null,"width",n(_)),D.setAttributeNS(null,"height",n(C)),this.current.element=D,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(t){const s=this.svgFactory.create(t.width,t.height),_=this.svgFactory.createElement("svg:defs");s.append(_),this.defs=_;const C=this.svgFactory.createElement("svg:g");return C.setAttributeNS(null,"transform",e(t.transform)),s.append(C),this.svg=C,s}_ensureClipGroup(){if(!this.current.clipGroup){const t=this.svgFactory.createElement("svg:g");t.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(t),this.current.clipGroup=t}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",e(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}},(ot,f,J)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.PDFNodeStream=void 0;var m=J(1),x=J(32);const X=require$$5,z=require$$5,G=require$$5,j=require$$5,v=/^file:\/\/\/[a-zA-Z]:\//;function y(r){const l=j.parse(r);return l.protocol==="file:"||l.host?l:/^[a-z]:[/\\]/i.test(r)?j.parse(`file:///${r}`):(l.host||(l.protocol="file:"),l)}class F{constructor(l){this.source=l,this.url=y(l.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&l.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var l;return((l=this._fullRequestReader)==null?void 0:l._loaded)??0}getFullReader(){return(0,m.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new e(this):new h(this),this._fullRequestReader}getRangeReader(l,t){if(t<=this._progressiveDataLength)return null;const s=this.isFsUrl?new o(this,l,t):new n(this,l,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(l){var t;(t=this._fullRequestReader)==null||t.cancel(l);for(const s of this._rangeRequestReaders.slice(0))s.cancel(l)}}f.PDFNodeStream=F;class A{constructor(l){this._url=l.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=l.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=(0,m.createPromiseCapability)(),this._headersCapability=(0,m.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const l=this._readableStream.read();return l===null?(this._readCapability=(0,m.createPromiseCapability)(),this.read()):(this._loaded+=l.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(l).buffer,done:!1})}cancel(l){if(!this._readableStream){this._error(l);return}this._readableStream.destroy(l)}_error(l){this._storedError=l,this._readCapability.resolve()}_setReadableStream(l){this._readableStream=l,l.on("readable",()=>{this._readCapability.resolve()}),l.on("end",()=>{l.destroy(),this._done=!0,this._readCapability.resolve()}),l.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new m.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class p{constructor(l){this._url=l.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,m.createPromiseCapability)();const t=l.source;this._isStreamingSupported=!t.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const l=this._readableStream.read();return l===null?(this._readCapability=(0,m.createPromiseCapability)(),this.read()):(this._loaded+=l.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:new Uint8Array(l).buffer,done:!1})}cancel(l){if(!this._readableStream){this._error(l);return}this._readableStream.destroy(l)}_error(l){this._storedError=l,this._readCapability.resolve()}_setReadableStream(l){this._readableStream=l,l.on("readable",()=>{this._readCapability.resolve()}),l.on("end",()=>{l.destroy(),this._done=!0,this._readCapability.resolve()}),l.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function c(r,l){return{protocol:r.protocol,auth:r.auth,host:r.hostname,port:r.port,path:r.path,method:"GET",headers:l}}class h extends A{constructor(l){super(l);const t=s=>{if(s.statusCode===404){const E=new m.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=E,this._headersCapability.reject(E);return}this._headersCapability.resolve(),this._setReadableStream(s);const _=E=>this._readableStream.headers[E.toLowerCase()],{allowRangeRequests:C,suggestedLength:D}=(0,x.validateRangeRequestCapabilities)({getResponseHeader:_,isHttp:l.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=C,this._contentLength=D||this._contentLength,this._filename=(0,x.extractFilenameFromHeader)(_)};this._request=null,this._url.protocol==="http:"?this._request=z.request(c(this._url,l.httpHeaders),t):this._request=G.request(c(this._url,l.httpHeaders),t),this._request.on("error",s=>{this._storedError=s,this._headersCapability.reject(s)}),this._request.end()}}class n extends p{constructor(l,t,s){super(l),this._httpHeaders={};for(const C in l.httpHeaders){const D=l.httpHeaders[C];typeof D>"u"||(this._httpHeaders[C]=D)}this._httpHeaders.Range=`bytes=${t}-${s-1}`;const _=C=>{if(C.statusCode===404){const D=new m.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=D;return}this._setReadableStream(C)};this._request=null,this._url.protocol==="http:"?this._request=z.request(c(this._url,this._httpHeaders),_):this._request=G.request(c(this._url,this._httpHeaders),_),this._request.on("error",C=>{this._storedError=C}),this._request.end()}}class e extends A{constructor(l){super(l);let t=decodeURIComponent(this._url.path);v.test(this._url.href)&&(t=t.replace(/^\//,"")),X.lstat(t,(s,_)=>{if(s){s.code==="ENOENT"&&(s=new m.MissingPDFException(`Missing PDF "${t}".`)),this._storedError=s,this._headersCapability.reject(s);return}this._contentLength=_.size,this._setReadableStream(X.createReadStream(t)),this._headersCapability.resolve()})}}class o extends p{constructor(l,t,s){super(l);let _=decodeURIComponent(this._url.path);v.test(this._url.href)&&(_=_.replace(/^\//,"")),this._setReadableStream(X.createReadStream(_,{start:t,end:s-1}))}}},(ot,f,J)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.createResponseStatusError=j,f.extractFilenameFromHeader=G,f.validateRangeRequestCapabilities=z,f.validateResponseStatus=v;var m=J(1),x=J(33),X=J(6);function z({getResponseHeader:y,isHttp:F,rangeChunkSize:A,disableRange:p}){const c={allowRangeRequests:!1,suggestedLength:void 0},h=parseInt(y("Content-Length"),10);return!Number.isInteger(h)||(c.suggestedLength=h,h<=2*A)||p||!F||y("Accept-Ranges")!=="bytes"||(y("Content-Encoding")||"identity")!=="identity"||(c.allowRangeRequests=!0),c}function G(y){const F=y("Content-Disposition");if(F){let A=(0,x.getFilenameFromContentDispositionHeader)(F);if(A.includes("%"))try{A=decodeURIComponent(A)}catch{}if((0,X.isPdfFile)(A))return A}return null}function j(y,F){return y===404||y===0&&F.startsWith("file:")?new m.MissingPDFException('Missing PDF "'+F+'".'):new m.UnexpectedResponseException(`Unexpected server response (${y}) while retrieving PDF "${F}".`,y)}function v(y){return y===200||y===206}},(ot,f,J)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.getFilenameFromContentDispositionHeader=x;var m=J(1);function x(X){let z=!0,G=j("filename\\*","i").exec(X);if(G){G=G[1];let h=A(G);return h=unescape(h),h=p(h),h=c(h),y(h)}if(G=F(X),G){const h=c(G);return y(h)}if(G=j("filename","i").exec(X),G){G=G[1];let h=A(G);return h=c(h),y(h)}function j(h,n){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',n)}function v(h,n){if(h){if(!/^[\x00-\xFF]+$/.test(n))return n;try{const e=new TextDecoder(h,{fatal:!0}),o=(0,m.stringToBytes)(n);n=e.decode(o),z=!1}catch{}}return n}function y(h){return z&&/[\x80-\xff]/.test(h)&&(h=v("utf-8",h),z&&(h=v("iso-8859-1",h))),h}function F(h){const n=[];let e;const o=j("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(e=o.exec(h))!==null;){let[,l,t,s]=e;if(l=parseInt(l,10),l in n){if(l===0)break;continue}n[l]=[t,s]}const r=[];for(let l=0;l<n.length&&l in n;++l){let[t,s]=n[l];s=A(s),t&&(s=unescape(s),l===0&&(s=p(s))),r.push(s)}return r.join("")}function A(h){if(h.startsWith('"')){const n=h.slice(1).split('\\"');for(let e=0;e<n.length;++e){const o=n[e].indexOf('"');o!==-1&&(n[e]=n[e].slice(0,o),n.length=e+1),n[e]=n[e].replace(/\\(.)/g,"$1")}h=n.join('"')}return h}function p(h){const n=h.indexOf("'");if(n===-1)return h;const e=h.slice(0,n),r=h.slice(n+1).replace(/^[^']*'/,"");return v(e,r)}function c(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(n,e,o,r){if(o==="q"||o==="Q")return r=r.replace(/_/g," "),r=r.replace(/=([0-9a-fA-F]{2})/g,function(l,t){return String.fromCharCode(parseInt(t,16))}),v(e,r);try{r=atob(r)}catch{}return v(e,r)})}return""}},(ot,f,J)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.PDFNetworkStream=void 0;var m=J(1),x=J(32);const X=200,z=206;function G(A){const p=A.response;return typeof p!="string"?p:(0,m.stringToBytes)(p).buffer}class j{constructor(p,c={}){this.url=p,this.isHttp=/^https?:/i.test(p),this.httpHeaders=this.isHttp&&c.httpHeaders||Object.create(null),this.withCredentials=c.withCredentials||!1,this.getXhr=c.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(p,c,h){const n={begin:p,end:c};for(const e in h)n[e]=h[e];return this.request(n)}requestFull(p){return this.request(p)}request(p){const c=this.getXhr(),h=this.currXhrId++,n=this.pendingRequests[h]={xhr:c};c.open("GET",this.url),c.withCredentials=this.withCredentials;for(const e in this.httpHeaders){const o=this.httpHeaders[e];typeof o>"u"||c.setRequestHeader(e,o)}return this.isHttp&&"begin"in p&&"end"in p?(c.setRequestHeader("Range",`bytes=${p.begin}-${p.end-1}`),n.expectedStatus=z):n.expectedStatus=X,c.responseType="arraybuffer",p.onError&&(c.onerror=function(e){p.onError(c.status)}),c.onreadystatechange=this.onStateChange.bind(this,h),c.onprogress=this.onProgress.bind(this,h),n.onHeadersReceived=p.onHeadersReceived,n.onDone=p.onDone,n.onError=p.onError,n.onProgress=p.onProgress,c.send(null),h}onProgress(p,c){var n;const h=this.pendingRequests[p];!h||(n=h.onProgress)==null||n.call(h,c)}onStateChange(p,c){var l,t,s;const h=this.pendingRequests[p];if(!h)return;const n=h.xhr;if(n.readyState>=2&&h.onHeadersReceived&&(h.onHeadersReceived(),delete h.onHeadersReceived),n.readyState!==4||!(p in this.pendingRequests))return;if(delete this.pendingRequests[p],n.status===0&&this.isHttp){(l=h.onError)==null||l.call(h,n.status);return}const e=n.status||X;if(!(e===X&&h.expectedStatus===z)&&e!==h.expectedStatus){(t=h.onError)==null||t.call(h,n.status);return}const r=G(n);if(e===z){const _=n.getResponseHeader("Content-Range"),C=/bytes (\d+)-(\d+)\/(\d+)/.exec(_);h.onDone({begin:parseInt(C[1],10),chunk:r})}else r?h.onDone({begin:0,chunk:r}):(s=h.onError)==null||s.call(h,n.status)}getRequestXhr(p){return this.pendingRequests[p].xhr}isPendingRequest(p){return p in this.pendingRequests}abortRequest(p){const c=this.pendingRequests[p].xhr;delete this.pendingRequests[p],c.abort()}}class v{constructor(p){this._source=p,this._manager=new j(p.url,{httpHeaders:p.httpHeaders,withCredentials:p.withCredentials}),this._rangeChunkSize=p.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(p){const c=this._rangeRequestReaders.indexOf(p);c>=0&&this._rangeRequestReaders.splice(c,1)}getFullReader(){return(0,m.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new y(this._manager,this._source),this._fullRequestReader}getRangeReader(p,c){const h=new F(this._manager,p,c);return h.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(h),h}cancelAllRequests(p){var c;(c=this._fullRequestReader)==null||c.cancel(p);for(const h of this._rangeRequestReaders.slice(0))h.cancel(p)}}f.PDFNetworkStream=v;class y{constructor(p,c){this._manager=p;const h={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=c.url,this._fullRequestId=p.requestFull(h),this._headersReceivedCapability=(0,m.createPromiseCapability)(),this._disableRange=c.disableRange||!1,this._contentLength=c.length,this._rangeChunkSize=c.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const p=this._fullRequestId,c=this._manager.getRequestXhr(p),h=o=>c.getResponseHeader(o),{allowRangeRequests:n,suggestedLength:e}=(0,x.validateRangeRequestCapabilities)({getResponseHeader:h,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});n&&(this._isRangeSupported=!0),this._contentLength=e||this._contentLength,this._filename=(0,x.extractFilenameFromHeader)(h),this._isRangeSupported&&this._manager.abortRequest(p),this._headersReceivedCapability.resolve()}_onDone(p){if(p&&(this._requests.length>0?this._requests.shift().resolve({value:p.chunk,done:!1}):this._cachedChunks.push(p.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const c of this._requests)c.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(p){this._storedError=(0,x.createResponseStatusError)(p,this._url),this._headersReceivedCapability.reject(this._storedError);for(const c of this._requests)c.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(p){var c;(c=this.onProgress)==null||c.call(this,{loaded:p.loaded,total:p.lengthComputable?p.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const p=(0,m.createPromiseCapability)();return this._requests.push(p),p.promise}cancel(p){this._done=!0,this._headersReceivedCapability.reject(p);for(const c of this._requests)c.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class F{constructor(p,c,h){this._manager=p;const n={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=p.url,this._requestId=p.requestRange(c,h,n),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var p;(p=this.onClosed)==null||p.call(this,this)}_onDone(p){const c=p.chunk;this._requests.length>0?this._requests.shift().resolve({value:c,done:!1}):this._queuedChunk=c,this._done=!0;for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(p){this._storedError=(0,x.createResponseStatusError)(p,this._url);for(const c of this._requests)c.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(p){var c;this.isStreamingSupported||(c=this.onProgress)==null||c.call(this,{loaded:p.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const c=this._queuedChunk;return this._queuedChunk=null,{value:c,done:!1}}if(this._done)return{value:void 0,done:!0};const p=(0,m.createPromiseCapability)();return this._requests.push(p),p.promise}cancel(p){this._done=!0;for(const c of this._requests)c.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(ot,f,J)=>{Object.defineProperty(f,"__esModule",{value:!0}),f.PDFFetchStream=void 0;var m=J(1),x=J(32);function X(y,F,A){return{method:"GET",headers:y,signal:A.signal,mode:"cors",credentials:F?"include":"same-origin",redirect:"follow"}}function z(y){const F=new Headers;for(const A in y){const p=y[A];typeof p>"u"||F.append(A,p)}return F}class G{constructor(F){this.source=F,this.isHttp=/^https?:/i.test(F.url),this.httpHeaders=this.isHttp&&F.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var F;return((F=this._fullRequestReader)==null?void 0:F._loaded)??0}getFullReader(){return(0,m.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new j(this),this._fullRequestReader}getRangeReader(F,A){if(A<=this._progressiveDataLength)return null;const p=new v(this,F,A);return this._rangeRequestReaders.push(p),p}cancelAllRequests(F){var A;(A=this._fullRequestReader)==null||A.cancel(F);for(const p of this._rangeRequestReaders.slice(0))p.cancel(F)}}f.PDFFetchStream=G;class j{constructor(F){this._stream=F,this._reader=null,this._loaded=0,this._filename=null;const A=F.source;this._withCredentials=A.withCredentials||!1,this._contentLength=A.length,this._headersCapability=(0,m.createPromiseCapability)(),this._disableRange=A.disableRange||!1,this._rangeChunkSize=A.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!A.disableStream,this._isRangeSupported=!A.disableRange,this._headers=z(this._stream.httpHeaders);const p=A.url;fetch(p,X(this._headers,this._withCredentials,this._abortController)).then(c=>{if(!(0,x.validateResponseStatus)(c.status))throw(0,x.createResponseStatusError)(c.status,p);this._reader=c.body.getReader(),this._headersCapability.resolve();const h=o=>c.headers.get(o),{allowRangeRequests:n,suggestedLength:e}=(0,x.validateRangeRequestCapabilities)({getResponseHeader:h,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=n,this._contentLength=e||this._contentLength,this._filename=(0,x.extractFilenameFromHeader)(h),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new m.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var c;await this._headersCapability.promise;const{value:F,done:A}=await this._reader.read();return A?{value:F,done:A}:(this._loaded+=F.byteLength,(c=this.onProgress)==null||c.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(F).buffer,done:!1})}cancel(F){var A;(A=this._reader)==null||A.cancel(F),this._abortController.abort()}}class v{constructor(F,A,p){this._stream=F,this._reader=null,this._loaded=0;const c=F.source;this._withCredentials=c.withCredentials||!1,this._readCapability=(0,m.createPromiseCapability)(),this._isStreamingSupported=!c.disableStream,this._abortController=new AbortController,this._headers=z(this._stream.httpHeaders),this._headers.append("Range",`bytes=${A}-${p-1}`);const h=c.url;fetch(h,X(this._headers,this._withCredentials,this._abortController)).then(n=>{if(!(0,x.validateResponseStatus)(n.status))throw(0,x.createResponseStatusError)(n.status,h);this._readCapability.resolve(),this._reader=n.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var c;await this._readCapability.promise;const{value:F,done:A}=await this._reader.read();return A?{value:F,done:A}:(this._loaded+=F.byteLength,(c=this.onProgress)==null||c.call(this,{loaded:this._loaded}),{value:new Uint8Array(F).buffer,done:!1})}cancel(F){var A;(A=this._reader)==null||A.cancel(F),this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(ot){var f=__webpack_module_cache__[ot];if(f!==void 0)return f.exports;var J=__webpack_module_cache__[ot]={exports:{}};return __webpack_modules__[ot](J,J.exports,__w_pdfjs_require__),J.exports}var __webpack_exports__={};return(()=>{var ot=__webpack_exports__;Object.defineProperty(ot,"__esModule",{value:!0}),Object.defineProperty(ot,"AnnotationEditorLayer",{enumerable:!0,get:function(){return x.AnnotationEditorLayer}}),Object.defineProperty(ot,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return f.AnnotationEditorParamsType}}),Object.defineProperty(ot,"AnnotationEditorType",{enumerable:!0,get:function(){return f.AnnotationEditorType}}),Object.defineProperty(ot,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return X.AnnotationEditorUIManager}}),Object.defineProperty(ot,"AnnotationLayer",{enumerable:!0,get:function(){return z.AnnotationLayer}}),Object.defineProperty(ot,"AnnotationMode",{enumerable:!0,get:function(){return f.AnnotationMode}}),Object.defineProperty(ot,"CMapCompressionType",{enumerable:!0,get:function(){return f.CMapCompressionType}}),Object.defineProperty(ot,"GlobalWorkerOptions",{enumerable:!0,get:function(){return G.GlobalWorkerOptions}}),Object.defineProperty(ot,"InvalidPDFException",{enumerable:!0,get:function(){return f.InvalidPDFException}}),Object.defineProperty(ot,"MissingPDFException",{enumerable:!0,get:function(){return f.MissingPDFException}}),Object.defineProperty(ot,"OPS",{enumerable:!0,get:function(){return f.OPS}}),Object.defineProperty(ot,"PDFDataRangeTransport",{enumerable:!0,get:function(){return J.PDFDataRangeTransport}}),Object.defineProperty(ot,"PDFDateString",{enumerable:!0,get:function(){return m.PDFDateString}}),Object.defineProperty(ot,"PDFWorker",{enumerable:!0,get:function(){return J.PDFWorker}}),Object.defineProperty(ot,"PasswordResponses",{enumerable:!0,get:function(){return f.PasswordResponses}}),Object.defineProperty(ot,"PermissionFlag",{enumerable:!0,get:function(){return f.PermissionFlag}}),Object.defineProperty(ot,"PixelsPerInch",{enumerable:!0,get:function(){return m.PixelsPerInch}}),Object.defineProperty(ot,"RenderingCancelledException",{enumerable:!0,get:function(){return m.RenderingCancelledException}}),Object.defineProperty(ot,"SVGGraphics",{enumerable:!0,get:function(){return y.SVGGraphics}}),Object.defineProperty(ot,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return f.UNSUPPORTED_FEATURES}}),Object.defineProperty(ot,"UnexpectedResponseException",{enumerable:!0,get:function(){return f.UnexpectedResponseException}}),Object.defineProperty(ot,"Util",{enumerable:!0,get:function(){return f.Util}}),Object.defineProperty(ot,"VerbosityLevel",{enumerable:!0,get:function(){return f.VerbosityLevel}}),Object.defineProperty(ot,"XfaLayer",{enumerable:!0,get:function(){return F.XfaLayer}}),Object.defineProperty(ot,"build",{enumerable:!0,get:function(){return J.build}}),Object.defineProperty(ot,"createPromiseCapability",{enumerable:!0,get:function(){return f.createPromiseCapability}}),Object.defineProperty(ot,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return f.createValidAbsoluteUrl}}),Object.defineProperty(ot,"getDocument",{enumerable:!0,get:function(){return J.getDocument}}),Object.defineProperty(ot,"getFilenameFromUrl",{enumerable:!0,get:function(){return m.getFilenameFromUrl}}),Object.defineProperty(ot,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return m.getPdfFilenameFromUrl}}),Object.defineProperty(ot,"getXfaPageViewport",{enumerable:!0,get:function(){return m.getXfaPageViewport}}),Object.defineProperty(ot,"isPdfFile",{enumerable:!0,get:function(){return m.isPdfFile}}),Object.defineProperty(ot,"loadScript",{enumerable:!0,get:function(){return m.loadScript}}),Object.defineProperty(ot,"renderTextLayer",{enumerable:!0,get:function(){return v.renderTextLayer}}),Object.defineProperty(ot,"shadow",{enumerable:!0,get:function(){return f.shadow}}),Object.defineProperty(ot,"version",{enumerable:!0,get:function(){return J.version}});var f=__w_pdfjs_require__(1),J=__w_pdfjs_require__(2),m=__w_pdfjs_require__(6),x=__w_pdfjs_require__(21),X=__w_pdfjs_require__(5),z=__w_pdfjs_require__(26),G=__w_pdfjs_require__(14),j=__w_pdfjs_require__(12),v=__w_pdfjs_require__(29),y=__w_pdfjs_require__(30),F=__w_pdfjs_require__(28);if(j.isNodeJS){const{PDFNodeStream:A}=__w_pdfjs_require__(31);(0,J.setPDFNetworkStreamFactory)(p=>new A(p))}else{const{PDFNetworkStream:A}=__w_pdfjs_require__(34),{PDFFetchStream:p}=__w_pdfjs_require__(35);(0,J.setPDFNetworkStreamFactory)(c=>(0,m.isValidFetchUrl)(c.url)?new p(c):new A(c))}})(),__webpack_exports__})())})(pdf);export{pdf as p};
